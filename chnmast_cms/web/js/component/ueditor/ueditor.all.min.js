(function(){function Aa(j,g,c){var b;g=g.toLowerCase();return(b=j.__allListeners||c&&(j.__allListeners={}))&&(b[g]||c&&(b[g]=[]))}function ta(j,g,c,b,a,e){b=b&&j[g];var k;for(!b&&(b=j[c]);!b&&(k=(k||j).parentNode);){if(k.tagName=="BODY"||e&&!e(k))return null;b=k[c]}if(b&&a&&!a(b))return ta(b,g,c,false,a);return b}UEDITOR_CONFIG=window.UEDITOR_CONFIG||{};var B=window.baidu||{};window.baidu=B;window.UE=B.editor=window.UE||{};UE.plugins={};UE.commands={};UE.instants={};UE.I18N={};UE._customizeUI={};
UE.version="1.4.3";var ea=UE.dom={},y=UE.browser=function(){var j=navigator.userAgent.toLowerCase(),g=window.opera,c={ie:/(msie\s|trident.*rv:)([\w.]+)/.test(j),opera:!!g&&g.version,webkit:j.indexOf(" applewebkit/")>-1,mac:j.indexOf("macintosh")>-1,quirks:document.compatMode=="BackCompat"};c.gecko=navigator.product=="Gecko"&&!c.webkit&&!c.opera&&!c.ie;var b=0;if(c.ie){b=j.match(/(?:msie\s([\w.]+))/);var a=j.match(/(?:trident.*rv:([\w.]+))/);b=b&&a&&b[1]&&a[1]?Math.max(b[1]*1,a[1]*1):b&&b[1]?b[1]*
1:a&&a[1]?a[1]*1:0;c.ie11Compat=document.documentMode==11;c.ie9Compat=document.documentMode==9;c.ie8=!!document.documentMode;c.ie8Compat=document.documentMode==8;c.ie7Compat=b==7&&!document.documentMode||document.documentMode==7;c.ie6Compat=b<7||c.quirks;c.ie9above=b>8;c.ie9below=b<9;c.ie11above=b>10;c.ie11below=b<11}if(c.gecko)if(a=j.match(/rv:([\d\.]+)/)){a=a[1].split(".");b=a[0]*1E4+(a[1]||0)*100+(a[2]||0)*1}if(/chrome\/(\d+\.\d)/i.test(j))c.chrome=+RegExp.$1;if(/(\d+\.\d)?(?:\.\d)?\s+safari\/?(\d+\.\d+)?/i.test(j)&&
!/chrome/i.test(j))c.safari=+(RegExp.$1||RegExp.$2);if(c.opera)b=parseFloat(g.version());if(c.webkit)b=parseFloat(j.match(/ applewebkit\/(\d+)/)[1]);c.version=b;c.isCompatible=!c.mobile&&(c.ie&&b>=6||c.gecko&&b>=10801||c.opera&&b>=9.5||c.air&&b>=1||c.webkit&&b>=522||false);return c}(),fa=y.ie,Pa=y.opera,v=UE.utils={each:function(j,g,c){if(j!=null)if(j.length===+j.length)for(var b=0,a=j.length;b<a;b++){if(g.call(c,j[b],b,j)===false)return false}else for(b in j)if(j.hasOwnProperty(b))if(g.call(c,j[b],
b,j)===false)return false},makeInstance:function(j){var g=new Function;g.prototype=j;j=new g;g.prototype=null;return j},extend:function(j,g,c){if(g)for(var b in g)if(!c||!j.hasOwnProperty(b))j[b]=g[b];return j},extend2:function(j){for(var g=arguments,c=1;c<g.length;c++){var b=g[c];for(var a in b)j.hasOwnProperty(a)||(j[a]=b[a])}return j},inherits:function(j,g){var c=j.prototype;g=v.makeInstance(g.prototype);v.extend(g,c,true);j.prototype=g;return g.constructor=j},bind:function(j,g){return function(){return j.apply(g,
arguments)}},defer:function(j,g,c){var b;return function(){c&&clearTimeout(b);b=setTimeout(j,g)}},indexOf:function(j,g,c){var b=-1;c=this.isNumber(c)?c:0;this.each(j,function(a,e){if(e>=c&&a===g){b=e;return false}});return b},removeItem:function(j,g){for(var c=0,b=j.length;c<b;c++)if(j[c]===g){j.splice(c,1);c--}},trim:function(j){return j.replace(/(^[ \t\n\r]+)|([ \t\n\r]+$)/g,"")},listToMap:function(j){if(!j)return{};j=v.isArray(j)?j:j.split(",");for(var g=0,c,b={};c=j[g++];)b[c.toUpperCase()]=b[c]=
1;return b},unhtml:function(j,g){return j?j.replace(g||/[&<">'](?:(amp|lt|quot|gt|#39|nbsp|#\d+);)?/g,function(c,b){return b?c:{"<":"&lt;","&":"&amp;",'"':"&quot;",">":"&gt;","'":"&#39;"}[c]}):""},html:function(j){return j?j.replace(/&((g|l|quo)t|amp|#39|nbsp);/g,function(g){return{"&lt;":"<","&amp;":"&","&quot;":'"',"&gt;":">","&#39;":"'","&nbsp;":" "}[g]}):""},cssStyleToDomStyle:function(){var j=document.createElement("div").style,g={"float":j.cssFloat!=undefined?"cssFloat":j.styleFloat!=undefined?
"styleFloat":"float"};return function(c){return g[c]||(g[c]=c.toLowerCase().replace(/-./g,function(b){return b.charAt(1).toUpperCase()}))}}(),loadFile:function(){function j(c,b){try{for(var a=0,e;e=g[a++];)if(e.doc===c&&e.url==(b.src||b.href))return e}catch(k){return null}}var g=[];return function(c,b,a){var e=j(c,b);if(e)if(e.ready)a&&a();else e.funs.push(a);else{g.push({doc:c,url:b.src||b.href,funs:[a]});if(c.body){if(!(b.id&&c.getElementById(b.id))){var k=c.createElement(b.tag);delete b.tag;for(f in b)k.setAttribute(f,
b[f]);k.onload=k.onreadystatechange=function(){if(!this.readyState||/loaded|complete/.test(this.readyState)){e=j(c,b);if(e.funs.length>0){e.ready=1;for(var d;d=e.funs.pop();)d()}k.onload=k.onreadystatechange=null}};k.onerror=function(){throw Error("The load "+(b.href||b.src)+" fails,check the url settings of file ueditor.config.js ");};c.getElementsByTagName("head")[0].appendChild(k)}}else{a=[];for(var f in b)f!="tag"&&a.push(f+'="'+b[f]+'"');c.write("<"+b.tag+" "+a.join(" ")+" ></"+b.tag+">")}}}}(),
isEmptyObject:function(j){if(j==null)return true;if(this.isArray(j)||this.isString(j))return j.length===0;for(var g in j)if(j.hasOwnProperty(g))return false;return true},fixColor:function(j,g){if(/color/i.test(j)&&/rgba?/.test(g)){j=g.split(",");if(j.length>3)return"";g="#";for(var c=0,b;b=j[c++];){b=parseInt(b.replace(/[^\d]/gi,""),10).toString(16);g+=b.length==1?"0"+b:b}g=g.toUpperCase()}return g},optCss:function(j){function g(a,e){if(!a)return"";var k=a.top,f=a.bottom,d=a.left,m=a.right,h="";if(!k||
!d||!f||!m)for(var n in a)h+=";"+e+"-"+n+":"+a[n]+";";else h+=";"+e+":"+(k==f&&f==d&&d==m?k:k==f&&d==m?k+" "+d:d==m?k+" "+d+" "+f:k+" "+m+" "+f+" "+d)+";";return h}var c,b;j=j.replace(/(padding|margin|border)\-([^:]+):([^;]+);?/gi,function(a,e,k,f){if(f.split(" ").length==1)switch(e){case "padding":!c&&(c={});c[k]=f;return"";case "margin":!b&&(b={});b[k]=f;return"";case "border":return f=="initial"?"":a}return a});j+=g(c,"padding")+g(b,"margin");return j.replace(/^[ \n\r\t;]*|[ \n\r\t]*$/,"").replace(/;([ \n\r\t]+)|\1;/g,
";").replace(/(&((l|g)t|quot|#39))?;{2,}/g,function(a,e){return e?e+";;":";"})},clone:function(j,g){var c;g=g||{};for(var b in j)if(j.hasOwnProperty(b)){c=j[b];if(typeof c=="object"){g[b]=v.isArray(c)?[]:{};v.clone(j[b],g[b])}else g[b]=c}return g},transUnitToPx:function(j){if(!/(pt|cm)/.test(j))return j;var g;j.replace(/([\d.]+)(\w+)/,function(c,b,a){j=b;g=a});switch(g){case "cm":j=parseFloat(j)*25;break;case "pt":j=Math.round(parseFloat(j)*96/72)}return j+(j?"px":"")},domReady:function(){function j(c){for(c.isReady=
true;c=g.pop();c());}var g=[];return function(c,b){b=b||window;var a=b.document;c&&g.push(c);if(a.readyState==="complete")j(a);else{a.isReady&&j(a);if(y.ie&&y.version!=11){(function(){if(!a.isReady){try{a.documentElement.doScroll("left")}catch(e){setTimeout(arguments.callee,0);return}j(a)}})();b.attachEvent("onload",function(){j(a)})}else{a.addEventListener("DOMContentLoaded",function(){a.removeEventListener("DOMContentLoaded",arguments.callee,false);j(a)},false);b.addEventListener("load",function(){j(a)},
false)}}}}(),cssRule:y.ie&&y.version!=11?function(j,g,c){var b,a;if(g===undefined||g&&g.nodeType&&g.nodeType==9){c=g&&g.nodeType&&g.nodeType==9?g:c||document;b=c.indexList||(c.indexList={});a=b[j];if(a!==undefined)return c.styleSheets[a].cssText}else{c=c||document;b=c.indexList||(c.indexList={});a=b[j];if(g===""){if(a!==undefined){c.styleSheets[a].cssText="";delete b[j];return true}return false}if(a!==undefined)sheetStyle=c.styleSheets[a];else{sheetStyle=c.createStyleSheet("",a=c.styleSheets.length);
b[j]=a}sheetStyle.cssText=g}}:function(j,g,c){var b;if(g===undefined||g&&g.nodeType&&g.nodeType==9){c=g&&g.nodeType&&g.nodeType==9?g:c||document;return(b=c.getElementById(j))?b.innerHTML:undefined}c=c||document;b=c.getElementById(j);if(g===""){if(b){b.parentNode.removeChild(b);return true}return false}if(b)b.innerHTML=g;else{b=c.createElement("style");b.id=j;b.innerHTML=g;c.getElementsByTagName("head")[0].appendChild(b)}},sort:function(j,g){g=g||function(f,d){return f.localeCompare(d)};for(var c=
0,b=j.length;c<b;c++)for(var a=c,e=j.length;a<e;a++)if(g(j[c],j[a])>0){var k=j[c];j[c]=j[a];j[a]=k}return j},serializeParam:function(j){var g=[];for(var c in j)if(!(c=="method"||c=="timeout"||c=="async"))if((typeof j[c]).toLowerCase()=="function"||(typeof j[c]).toLowerCase()=="object"){if(v.isArray(j[c]))for(var b=0;b<j[c].length;b++)g.push(encodeURIComponent(c)+"[]="+encodeURIComponent(j[c][b]))}else g.push(encodeURIComponent(c)+"="+encodeURIComponent(j[c]));return g.join("&")},formatUrl:function(j){j=
j.replace(/&&/g,"&");j=j.replace(/\?&/g,"?");j=j.replace(/&$/g,"");j=j.replace(/&#/g,"#");return j=j.replace(/&+/g,"&")},isCrossDomainUrl:function(j){var g=document.createElement("a");g.href=j;if(y.ie)g.href=g.href;return!(g.protocol==location.protocol&&g.hostname==location.hostname&&(g.port==location.port||g.port=="80"&&location.port==""||g.port==""&&location.port=="80"))},clearEmptyAttrs:function(j){for(var g in j)j[g]===""&&delete j[g];return j},str2json:function(j){if(!v.isString(j))return null;
return window.JSON?JSON.parse(j):(new Function("return "+v.trim(j||"")))()},json2str:function(){if(window.JSON)return JSON.stringify;else{var j={"\u0008":"\\b","\t":"\\t","\n":"\\n","\u000c":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function g(e){if(/["\\\x00-\x1f]/.test(e))e=e.replace(/["\\\x00-\x1f]/g,function(k){var f=j[k];if(f)return f;f=k.charCodeAt();return"\\u00"+Math.floor(f/16).toString(16)+(f%16).toString(16)});return'"'+e+'"'}function c(e){var k=["["],f=e.length,d,m,h;for(m=0;m<f;m++){h=
e[m];switch(typeof h){case "undefined":case "function":case "unknown":break;default:d&&k.push(",");k.push(v.json2str(h));d=1}}k.push("]");return k.join("")}function b(e){return e<10?"0"+e:e}function a(e){return'"'+e.getFullYear()+"-"+b(e.getMonth()+1)+"-"+b(e.getDate())+"T"+b(e.getHours())+":"+b(e.getMinutes())+":"+b(e.getSeconds())+'"'}return function(e){switch(typeof e){case "undefined":return"undefined";case "number":return isFinite(e)?String(e):"null";case "string":return g(e);case "boolean":return String(e);
default:if(e===null)return"null";else if(v.isArray(e))return c(e);else if(v.isDate(e))return a(e);else{var k=["{"],f=v.json2str,d,m;for(var h in e)if(Object.prototype.hasOwnProperty.call(e,h)){m=e[h];switch(typeof m){case "undefined":case "unknown":case "function":break;default:d&&k.push(",");d=1;k.push(f(h)+":"+f(m))}}k.push("}");return k.join("")}}}}}()};v.each(["String","Function","Array","Number","RegExp","Object","Date"],function(j){UE.utils["is"+j]=function(g){return Object.prototype.toString.apply(g)==
"[object "+j+"]"}});var Ba=UE.EventBase=function(){};Ba.prototype={addListener:function(j,g){j=v.trim(j).split(/\s+/);for(var c=0,b;b=j[c++];)Aa(this,b,true).push(g)},on:function(j,g){return this.addListener(j,g)},off:function(j,g){return this.removeListener(j,g)},trigger:function(){return this.fireEvent.apply(this,arguments)},removeListener:function(j,g){j=v.trim(j).split(/\s+/);for(var c=0,b;b=j[c++];)v.removeItem(Aa(this,b)||[],g)},fireEvent:function(){var j=arguments[0];j=v.trim(j).split(" ");
for(var g=0,c;c=j[g++];){var b=Aa(this,c),a,e,k;if(b)for(k=b.length;k--;)if(b[k]){e=b[k].apply(this,arguments);if(e===true)return e;if(e!==undefined)a=e}if(e=this["on"+c.toLowerCase()])a=e.apply(this,arguments)}return a}};var K=ea.dtd=function(){function j(I){for(var S in I)I[S.toUpperCase()]=I[S];return I}var g=v.extend2,c=j({isindex:1,fieldset:1}),b=j({input:1,button:1,select:1,textarea:1,label:1}),a=g(j({a:1}),b),e=g({iframe:1},a),k=j({hr:1,ul:1,menu:1,div:1,blockquote:1,noscript:1,table:1,center:1,
address:1,dir:1,pre:1,h5:1,dl:1,h4:1,noframes:1,h6:1,ol:1,h1:1,h3:1,h2:1}),f=j({ins:1,del:1,script:1,style:1}),d=g(j({b:1,acronym:1,bdo:1,"var":1,"#":1,abbr:1,code:1,br:1,i:1,cite:1,kbd:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,dfn:1,span:1}),f),m=g(j({sub:1,img:1,embed:1,object:1,sup:1,basefont:1,map:1,applet:1,font:1,big:1,small:1}),d),h=g(j({p:1}),m);b=g(j({iframe:1}),m,b);m=j({img:1,embed:1,noscript:1,br:1,kbd:1,center:1,button:1,basefont:1,h5:1,h4:1,samp:1,h6:1,ol:1,h1:1,h3:1,h2:1,form:1,
font:1,"#":1,select:1,menu:1,ins:1,abbr:1,label:1,code:1,table:1,script:1,cite:1,input:1,iframe:1,strong:1,textarea:1,noframes:1,big:1,small:1,span:1,hr:1,sub:1,bdo:1,"var":1,div:1,object:1,sup:1,strike:1,dir:1,map:1,dl:1,applet:1,del:1,isindex:1,fieldset:1,ul:1,b:1,acronym:1,a:1,blockquote:1,i:1,u:1,s:1,tt:1,address:1,q:1,pre:1,p:1,em:1,dfn:1});var n=g(j({a:0}),b),q=j({tr:1}),o=j({"#":1}),p=g(j({param:1}),m),r=g(j({form:1}),c,e,k,h),s=j({li:1,ol:1,ul:1}),t=j({style:1,script:1}),u=j({base:1,link:1,
meta:1,title:1});t=g(u,t);var w=j({head:1,body:1}),D=j({html:1}),z=j({address:1,blockquote:1,center:1,dir:1,div:1,dl:1,fieldset:1,form:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,hr:1,isindex:1,menu:1,noframes:1,ol:1,p:1,pre:1,table:1,ul:1}),F=j({area:1,base:1,basefont:1,br:1,col:1,command:1,dialog:1,embed:1,hr:1,img:1,input:1,isindex:1,keygen:1,link:1,meta:1,param:1,source:1,track:1,wbr:1});return j({$nonBodyContent:g(D,w,u),$block:z,$inline:n,$inlineWithA:g(j({a:1}),n),$body:g(j({script:1,style:1}),z),$cdata:j({script:1,
style:1}),$empty:F,$nonChild:j({iframe:1,textarea:1}),$listItem:j({dd:1,dt:1,li:1}),$list:j({ul:1,ol:1,dl:1}),$isNotEmpty:j({table:1,ul:1,ol:1,dl:1,iframe:1,area:1,base:1,col:1,hr:1,img:1,embed:1,input:1,link:1,meta:1,param:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1}),$removeEmpty:j({a:1,abbr:1,acronym:1,address:1,b:1,bdo:1,big:1,cite:1,code:1,del:1,dfn:1,em:1,font:1,i:1,ins:1,label:1,kbd:1,q:1,s:1,samp:1,small:1,span:1,strike:1,strong:1,sub:1,sup:1,tt:1,u:1,"var":1}),$removeEmptyBlock:j({p:1,div:1}),$tableContent:j({caption:1,
col:1,colgroup:1,tbody:1,td:1,tfoot:1,th:1,thead:1,tr:1,table:1}),$notTransContent:j({pre:1,script:1,style:1,textarea:1}),html:w,head:t,style:o,script:o,body:r,base:{},link:{},meta:{},title:o,col:{},tr:j({td:1,th:1}),img:{},embed:{},colgroup:j({thead:1,col:1,tbody:1,tr:1,tfoot:1}),noscript:r,td:r,br:{},th:r,center:r,kbd:n,button:g(h,k),basefont:{},h5:n,h4:n,samp:n,h6:n,ol:s,h1:n,h3:n,option:o,h2:n,form:g(c,e,k,h),select:j({optgroup:1,option:1}),font:n,ins:n,menu:s,abbr:n,label:n,table:j({thead:1,
col:1,tbody:1,tr:1,colgroup:1,caption:1,tfoot:1}),code:n,tfoot:q,cite:n,li:r,input:{},iframe:r,strong:n,textarea:o,noframes:r,big:n,small:n,span:j({"#":1,br:1,b:1,strong:1,u:1,i:1,em:1,sub:1,sup:1,strike:1,span:1}),hr:n,dt:n,sub:n,optgroup:j({option:1}),param:{},bdo:n,"var":n,div:r,object:p,sup:n,dd:r,strike:n,area:{},dir:s,map:g(j({area:1,form:1,p:1}),c,f,k),applet:p,dl:j({dt:1,dd:1}),del:n,isindex:{},fieldset:g(j({legend:1}),m),thead:q,ul:s,acronym:n,b:n,a:g(j({a:1}),b),blockquote:g(j({td:1,tr:1,
tbody:1,li:1}),r),caption:n,i:n,u:n,tbody:q,s:n,address:g(e,h),tt:n,legend:n,q:n,pre:g(d,a),p:g(j({a:1}),n),em:n,dfn:n})}(),Ia=fa&&y.version<9?{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder"}:{tabindex:"tabIndex",readonly:"readOnly"},Qa=v.listToMap(["-webkit-box","-moz-box","block","list-item","table","table-row-group",
"table-header-group","table-footer-group","table-row","table-column-group","table-column","table-cell","table-caption"]),l=ea.domUtils={NODE_ELEMENT:1,NODE_DOCUMENT:9,NODE_TEXT:3,NODE_COMMENT:8,NODE_DOCUMENT_FRAGMENT:11,POSITION_IDENTICAL:0,POSITION_DISCONNECTED:1,POSITION_FOLLOWING:2,POSITION_PRECEDING:4,POSITION_IS_CONTAINED:8,POSITION_CONTAINS:16,fillChar:fa&&y.version=="6"?"\ufeff":"\u200b",keys:{8:1,46:1,16:1,17:1,18:1,37:1,38:1,39:1,40:1,13:1},getPosition:function(j,g){if(j===g)return 0;var c,
b=[j],a=[g];for(c=j;c=c.parentNode;){if(c===g)return 10;b.push(c)}for(c=g;c=c.parentNode;){if(c===j)return 20;a.push(c)}b.reverse();a.reverse();if(b[0]!==a[0])return 1;for(g=-1;g++,b[g]===a[g];);j=b[g];for(g=a[g];j=j.nextSibling;)if(j===g)return 4;return 2},getNodeIndex:function(j,g){j=j;for(var c=0;j=j.previousSibling;)if(g&&j.nodeType==3)j.nodeType!=j.nextSibling.nodeType&&c++;else c++;return c},inDoc:function(j,g){return l.getPosition(j,g)==10},findParent:function(j,g,c){if(j&&!l.isBody(j))for(j=
c?j:j.parentNode;j;){if(!g||g(j)||l.isBody(j))return g&&!g(j)&&l.isBody(j)?null:j;j=j.parentNode}return null},findParentByTagName:function(j,g,c,b){g=v.listToMap(v.isArray(g)?g:[g]);return l.findParent(j,function(a){return g[a.tagName]&&!(b&&b(a))},c)},findParents:function(j,g,c,b){for(g=g&&(c&&c(j)||!c)?[j]:[];j=l.findParent(j,c);)g.push(j);return b?g:g.reverse()},insertAfter:function(j,g){return j.nextSibling?j.parentNode.insertBefore(g,j.nextSibling):j.parentNode.appendChild(g)},remove:function(j,
g){var c=j.parentNode;if(c){if(g&&j.hasChildNodes())for(;g=j.firstChild;)c.insertBefore(g,j);c.removeChild(j)}return j},getNextDomNode:function(j,g,c,b){return ta(j,"firstChild","nextSibling",g,c,b)},getPreDomNode:function(j,g,c,b){return ta(j,"lastChild","previousSibling",g,c,b)},isBookmarkNode:function(j){return j.nodeType==1&&j.id&&/^_baidu_bookmark_/i.test(j.id)},getWindow:function(j){j=j.ownerDocument||j;return j.defaultView||j.parentWindow},getCommonAncestor:function(j,g){if(j===g)return j;
for(var c=[j],b=[g],a=j,e=-1;a=a.parentNode;){if(a===g)return a;c.push(a)}for(a=g;a=a.parentNode;){if(a===j)return a;b.push(a)}c.reverse();for(b.reverse();e++,c[e]===b[e];);return e==0?null:c[e-1]},clearEmptySibling:function(j,g,c){function b(a,e){for(var k;a&&!l.isBookmarkNode(a)&&(l.isEmptyInlineElement(a)||!(new RegExp("[^\t\n\r"+l.fillChar+"]")).test(a.nodeValue));){k=a[e];l.remove(a);a=k}}!g&&b(j.nextSibling,"nextSibling");!c&&b(j.previousSibling,"previousSibling")},split:function(j,g){var c=
j.ownerDocument;if(y.ie&&g==j.nodeValue.length){c=c.createTextNode("");return l.insertAfter(j,c)}j=j.splitText(g);if(y.ie8){c=c.createTextNode("");l.insertAfter(j,c);l.remove(c)}return j},isWhitespace:function(j){return!(new RegExp("[^ \t\n\r"+l.fillChar+"]")).test(j.nodeValue)},getXY:function(j){for(var g=0,c=0;j.offsetParent;){c+=j.offsetTop;g+=j.offsetLeft;j=j.offsetParent}return{x:g,y:c}},on:function(j,g,c){var b=v.isArray(g)?g:v.trim(g).split(/\s+/),a=b.length;if(a)for(;a--;){g=b[a];if(j.addEventListener)j.addEventListener(g,
c,false);else{if(!c._d)c._d={els:[]};var e=g+c.toString(),k=v.indexOf(c._d.els,j);if(!c._d[e]||k==-1){k==-1&&c._d.els.push(j);c._d[e]||(c._d[e]=function(f){return c.call(f.srcElement,f||window.event)});j.attachEvent("on"+g,c._d[e])}}}j=null},un:function(j,g,c){var b=v.isArray(g)?g:v.trim(g).split(/\s+/),a=b.length;if(a)for(;a--;){g=b[a];if(j.removeEventListener)j.removeEventListener(g,c,false);else{var e=g+c.toString();try{j.detachEvent("on"+g,c._d?c._d[e]:c)}catch(k){}if(c._d&&c._d[e]){g=v.indexOf(c._d.els,
j);g!=-1&&c._d.els.splice(g,1);c._d.els.length==0&&delete c._d[e]}}}},isSameElement:function(j,g){if(j.tagName!=g.tagName)return false;var c=j.attributes,b=g.attributes;if(!fa&&c.length!=b.length)return false;for(var a,e,k=0,f=0,d=0;a=c[d++];){if(a.nodeName=="style"){a.specified&&k++;if(l.isSameStyle(j,g))continue;else return false}if(fa)if(a.specified){k++;e=b.getNamedItem(a.nodeName)}else continue;else e=g.attributes[a.nodeName];if(!e.specified||a.nodeValue!=e.nodeValue)return false}if(fa){for(d=
0;e=b[d++];)e.specified&&f++;if(k!=f)return false}return true},isSameStyle:function(j,g){var c=j.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":"),b=g.style.cssText.replace(/( ?; ?)/g,";").replace(/( ?: ?)/g,":");if(y.opera){c=j.style;b=g.style;if(c.length!=b.length)return false;for(var a in c)if(!/^(\d+|csstext)$/i.test(a))if(c[a]!=b[a])return false;return true}if(!c||!b)return c==b;c=c.split(";");b=b.split(";");if(c.length!=b.length)return false;for(j=0;g=c[j++];)if(v.indexOf(b,g)==
-1)return false;return true},isBlockElm:function(j){return j.nodeType==1&&(K.$block[j.tagName]||Qa[l.getComputedStyle(j,"display")])&&!K.$nonChild[j.tagName]},isBody:function(j){return j&&j.nodeType==1&&j.tagName.toLowerCase()=="body"},breakParent:function(j,g){var c,b=j,a=j,e,k;do{b=b.parentNode;if(e){c=b.cloneNode(false);c.appendChild(e);e=c;c=b.cloneNode(false);c.appendChild(k);k=c}else{e=b.cloneNode(false);k=e.cloneNode(false)}for(;c=a.previousSibling;)e.insertBefore(c,e.firstChild);for(;c=a.nextSibling;)k.appendChild(c);
a=b}while(g!==b);c=g.parentNode;c.insertBefore(e,g);c.insertBefore(k,g);c.insertBefore(j,k);l.remove(g);return j},isEmptyInlineElement:function(j){if(j.nodeType!=1||!K.$removeEmpty[j.tagName])return 0;for(j=j.firstChild;j;){if(l.isBookmarkNode(j))return 0;if(j.nodeType==1&&!l.isEmptyInlineElement(j)||j.nodeType==3&&!l.isWhitespace(j))return 0;j=j.nextSibling}return 1},trimWhiteTextNode:function(j){function g(c){for(var b;(b=j[c])&&b.nodeType==3&&l.isWhitespace(b);)j.removeChild(b)}g("firstChild");
g("lastChild")},mergeChild:function(j,g,c){g=l.getElementsByTagName(j,j.tagName.toLowerCase());for(var b=0,a;a=g[b++];)if(!(!a.parentNode||l.isBookmarkNode(a)))if(a.tagName.toLowerCase()=="span"){if(j===a.parentNode){l.trimWhiteTextNode(j);if(j.childNodes.length==1){j.style.cssText=a.style.cssText+";"+j.style.cssText;l.remove(a,true);continue}}a.style.cssText=j.style.cssText+";"+a.style.cssText;if(c){var e=c.style;if(e){e=e.split(";");for(var k=0,f;f=e[k++];)a.style[v.cssStyleToDomStyle(f.split(":")[0])]=
f.split(":")[1]}}l.isSameStyle(a,j)&&l.remove(a,true)}else l.isSameElement(j,a)&&l.remove(a,true)},getElementsByTagName:function(j,g,c){if(c&&v.isString(c)){var b=c;c=function(m){return l.hasClass(m,b)}}g=v.trim(g).replace(/[ ]{2,}/g," ").split(" ");for(var a=[],e=0,k;k=g[e++];){k=j.getElementsByTagName(k);for(var f=0,d;d=k[f++];)if(!c||c(d))a.push(d)}return a},mergeToParent:function(j){for(var g=j.parentNode;g&&K.$removeEmpty[g.tagName];){if(g.tagName==j.tagName||g.tagName=="A"){l.trimWhiteTextNode(g);
if(g.tagName=="SPAN"&&!l.isSameStyle(g,j)||g.tagName=="A"&&j.tagName=="SPAN")if(g.childNodes.length>1||g!==j.parentNode){j.style.cssText=g.style.cssText+";"+j.style.cssText;g=g.parentNode;continue}else{g.style.cssText+=";"+j.style.cssText;if(g.tagName=="A")g.style.textDecoration="underline"}if(g.tagName!="A"){g===j.parentNode&&l.remove(j,true);break}}g=g.parentNode}},mergeSibling:function(j,g,c){function b(a,e,k){var f;if((f=k[a])&&!l.isBookmarkNode(f)&&f.nodeType==1&&l.isSameElement(k,f)){for(;f.firstChild;)e==
"firstChild"?k.insertBefore(f.lastChild,k.firstChild):k.appendChild(f.firstChild);l.remove(f)}}!g&&b("previousSibling","firstChild",j);!c&&b("nextSibling","lastChild",j)},unSelectable:fa&&y.ie9below||y.opera?function(j){j.onselectstart=function(){return false};j.onclick=j.onkeyup=j.onkeydown=function(){return false};j.unselectable="on";j.setAttribute("unselectable","on");for(var g=0,c;c=j.all[g++];)switch(c.tagName.toLowerCase()){case "iframe":case "textarea":case "input":case "select":break;default:c.unselectable=
"on";j.setAttribute("unselectable","on")}}:function(j){j.style.MozUserSelect=j.style.webkitUserSelect=j.style.msUserSelect=j.style.KhtmlUserSelect="none"},removeAttributes:function(j,g){g=v.isArray(g)?g:v.trim(g).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b;b=g[c++];){b=Ia[b]||b;switch(b){case "className":j[b]="";break;case "style":j.style.cssText="";var a=j.getAttributeNode("style");!y.ie&&a&&j.removeAttributeNode(a)}j.removeAttribute(b)}},createElement:function(j,g,c){return l.setAttributes(j.createElement(g),
c)},setAttributes:function(j,g){for(var c in g)if(g.hasOwnProperty(c)){var b=g[c];switch(c){case "class":j.className=b;break;case "style":j.style.cssText=j.style.cssText+";"+b;break;case "innerHTML":j[c]=b;break;case "value":j.value=b;break;default:j.setAttribute(Ia[c]||c,b)}}return j},getComputedStyle:function(j,g){if("width height top left".indexOf(g)>-1)return j["offset"+g.replace(/^\w/,function(a){return a.toUpperCase()})]+"px";if(j.nodeType==3)j=j.parentNode;if(y.ie&&y.version<9&&g=="font-size"&&
!j.style.fontSize&&!K.$empty[j.tagName]&&!K.$nonChild[j.tagName]){g=j.ownerDocument.createElement("span");g.style.cssText="padding:0;border:0;font-family:simsun;";g.innerHTML=".";j.appendChild(g);var c=g.offsetHeight;j.removeChild(g);g=null;return c+"px"}try{c=l.getStyle(j,g)||(window.getComputedStyle?l.getWindow(j).getComputedStyle(j,"").getPropertyValue(g):(j.currentStyle||j.style)[v.cssStyleToDomStyle(g)])}catch(b){return""}return v.transUnitToPx(v.fixColor(g,c))},removeClasses:function(j,g){g=
v.isArray(g)?g:v.trim(g).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=j.className;b=g[c++];)a=a.replace(new RegExp("\\b"+b+"\\b"),"");if(a=v.trim(a).replace(/[ ]{2,}/g," "))j.className=a;else l.removeAttributes(j,["class"])},addClass:function(j,g){if(j){g=v.trim(g).replace(/[ ]{2,}/g," ").split(" ");for(var c=0,b,a=j.className;b=g[c++];)(new RegExp("\\b"+b+"\\b")).test(a)||(a+=" "+b);j.className=v.trim(a)}},hasClass:function(j,g){if(v.isRegExp(g))return g.test(j.className);g=v.trim(g).replace(/[ ]{2,}/g,
" ").split(" ");for(var c=0,b=j.className;j=g[c++];)if(!(new RegExp("\\b"+j+"\\b","i")).test(b))return false;return c-1==g.length},preventDefault:function(j){j.preventDefault?j.preventDefault():(j.returnValue=false)},removeStyle:function(j,g){if(y.ie){if(g=="color")g="(^|;)"+g;j.style.cssText=j.style.cssText.replace(new RegExp(g+"[^:]*:[^;]+;?","ig"),"")}else j.style.removeProperty?j.style.removeProperty(g):j.style.removeAttribute(v.cssStyleToDomStyle(g));j.style.cssText||l.removeAttributes(j,["style"])},
getStyle:function(j,g){j=j.style[v.cssStyleToDomStyle(g)];return v.fixColor(g,j)},setStyle:function(j,g,c){j.style[v.cssStyleToDomStyle(g)]=c;v.trim(j.style.cssText)||this.removeAttributes(j,"style")},setStyles:function(j,g){for(var c in g)g.hasOwnProperty(c)&&l.setStyle(j,c,g[c])},removeDirtyAttr:function(j){for(var g=0,c,b=j.getElementsByTagName("*");c=b[g++];)c.removeAttribute("_moz_dirty");j.removeAttribute("_moz_dirty")},getChildCount:function(j,g){var c=0;j=j.firstChild;for(g=g||function(){return 1};j;){g(j)&&
c++;j=j.nextSibling}return c},isEmptyNode:function(j){return!j.firstChild||l.getChildCount(j,function(g){return!l.isBr(g)&&!l.isBookmarkNode(g)&&!l.isWhitespace(g)})==0},clearSelectedArr:function(j){for(var g;g=j.pop();)l.removeAttributes(g,["class"])},scrollToView:function(j,g,c){var b=function(){var a=g.document,e=a.compatMode=="CSS1Compat";return{width:(e?a.documentElement.clientWidth:a.body.clientWidth)||0,height:(e?a.documentElement.clientHeight:a.body.clientHeight)||0}}().height;c=b*-1+c;c+=
j.offsetHeight||0;j=l.getXY(j);c+=j.y;j=function(a){if("pageXOffset"in a)return{x:a.pageXOffset||0,y:a.pageYOffset||0};else{a=a.document;return{x:a.documentElement.scrollLeft||a.body.scrollLeft||0,y:a.documentElement.scrollTop||a.body.scrollTop||0}}}(g).y;if(c>j||c<j-b)g.scrollTo(0,c+(c<0?-20:20))},isBr:function(j){return j.nodeType==1&&j.tagName=="BR"},isFillChar:function(j,g){if(j.nodeType!=3)return false;j=j.nodeValue;if(g)return(new RegExp("^"+l.fillChar)).test(j);return!j.replace(new RegExp(l.fillChar,
"g"),"").length},isStartInblock:function(j){j=j.cloneRange();var g=0,c=j.startContainer,b;if(c.nodeType==1&&c.childNodes[j.startOffset]){c=c.childNodes[j.startOffset];for(var a=c.previousSibling;a&&l.isFillChar(a);){c=a;a=a.previousSibling}}if(this.isFillChar(c,true)&&j.startOffset==1){j.setStartBefore(c);c=j.startContainer}for(;c&&l.isFillChar(c);){b=c;c=c.previousSibling}if(b){j.setStartBefore(b);c=j.startContainer}for(c.nodeType==1&&l.isEmptyNode(c)&&j.startOffset==1&&j.setStart(c,0).collapse(true);!j.startOffset;){c=
j.startContainer;if(l.isBlockElm(c)||l.isBody(c)){g=1;break}a=j.startContainer.previousSibling;var e;if(a){for(;a&&l.isFillChar(a);){e=a;a=a.previousSibling}e?j.setStartBefore(e):j.setStartBefore(j.startContainer)}else j.setStartBefore(j.startContainer)}return g&&!l.isBody(j.startContainer)?1:0},isEmptyBlock:function(j,g){if(j.nodeType!=1)return 0;g=g||new RegExp("[ \u00a0\t\r\n"+l.fillChar+"]","g");if(j[y.ie?"innerText":"textContent"].replace(g,"").length>0)return 0;for(var c in K.$isNotEmpty)if(j.getElementsByTagName(c).length)return 0;
return 1},setViewportOffset:function(j,g){var c=parseInt(j.style.left)|0,b=parseInt(j.style.top)|0,a=j.getBoundingClientRect(),e=g.left-a.left;g=g.top-a.top;if(e)j.style.left=c+e+"px";if(g)j.style.top=b+g+"px"},fillNode:function(j,g){j=y.ie?j.createTextNode(l.fillChar):j.createElement("br");g.innerHTML="";g.appendChild(j)},moveChild:function(j,g,c){for(;j.firstChild;)c&&g.firstChild?g.insertBefore(j.lastChild,g.firstChild):g.appendChild(j.firstChild)},hasNoAttributes:function(j){return y.ie?/^<\w+\s*?>/.test(j.outerHTML):
j.attributes.length==0},isCustomeNode:function(j){return j.nodeType==1&&j.getAttribute("_ue_custom_node_")},isTagNode:function(j,g){return j.nodeType==1&&(new RegExp("\\b"+j.tagName+"\\b","i")).test(g)},filterNodeList:function(j,g,c){var b=[];if(!v.isFunction(g)){var a=g;g=function(e){return v.indexOf(v.isArray(a)?a:a.split(" "),e.tagName.toLowerCase())!=-1}}v.each(j,function(e){g(e)&&b.push(e)});return b.length==0?null:b.length==1||!c?b[0]:b},isInNodeEndBoundary:function(j,g){var c=j.startContainer;
if(c.nodeType==3&&j.startOffset!=c.nodeValue.length)return 0;if(c.nodeType==1&&j.startOffset!=c.childNodes.length)return 0;for(;c!==g;){if(c.nextSibling)return 0;c=c.parentNode}return 1},isBoundaryNode:function(j,g){for(var c;!l.isBody(j);){c=j;j=j.parentNode;if(c!==j[g])return false}return true},fillHtml:y.ie11below?"&nbsp;":"<br/>"},pa=new RegExp(l.fillChar,"g");(function(){function j(h){h.collapsed=h.startContainer&&h.endContainer&&h.startContainer===h.endContainer&&h.startOffset==h.endOffset}
function g(h){return!h.collapsed&&h.startContainer.nodeType==1&&h.startContainer===h.endContainer&&h.endOffset-h.startOffset==1}function c(h,n,q,o){if(n.nodeType==1&&(K.$empty[n.tagName]||K.$nonChild[n.tagName])){q=l.getNodeIndex(n)+(h?0:1);n=n.parentNode}if(h){o.startContainer=n;o.startOffset=q;o.endContainer||o.collapse(true)}else{o.endContainer=n;o.endOffset=q;o.startContainer||o.collapse(false)}j(o);return o}function b(h,n){var q=h.startContainer,o=h.endContainer,p=h.startOffset,r=h.endOffset,
s=h.document,t=s.createDocumentFragment(),u,w;if(q.nodeType==1)q=q.childNodes[p]||(u=q.appendChild(s.createTextNode("")));if(o.nodeType==1)o=o.childNodes[r]||(w=o.appendChild(s.createTextNode("")));if(q===o&&q.nodeType==3){t.appendChild(s.createTextNode(q.substringData(p,r-p)));if(n){q.deleteData(p,r-p);h.collapse(true)}return t}for(var D,z,F=t,I=l.findParents(q,true),S=l.findParents(o,true),L=0;I[L]==S[L];)L++;for(var X=L,T;T=I[X];X++){D=T.nextSibling;if(T==q){if(!u)if(h.startContainer.nodeType==
3){F.appendChild(s.createTextNode(q.nodeValue.slice(p)));n&&q.deleteData(p,q.nodeValue.length-p)}else F.appendChild(!n?q.cloneNode(true):q)}else{z=T.cloneNode(false);F.appendChild(z)}for(;D;){if(D===o||D===S[X])break;T=D.nextSibling;F.appendChild(!n?D.cloneNode(true):D);D=T}F=z}F=t;if(!I[L]){F.appendChild(I[L-1].cloneNode(false));F=F.firstChild}for(X=L;p=S[X];X++){D=p.previousSibling;if(p==o){if(!w&&h.endContainer.nodeType==3){F.appendChild(s.createTextNode(o.substringData(0,r)));n&&o.deleteData(0,
r)}}else{z=p.cloneNode(false);F.appendChild(z)}if(X!=L||!I[L])for(;D;){if(D===q)break;p=D.previousSibling;F.insertBefore(!n?D.cloneNode(true):D,F.firstChild);D=p}F=z}if(n)h.setStartBefore(!S[L]?S[L-1]:!I[L]?I[L-1]:S[L]).collapse(true);u&&l.remove(u);w&&l.remove(w);return t}function a(h,n){try{if(d&&l.inDoc(d,h))if(d.nodeValue.replace(pa,"").length)d.nodeValue=d.nodeValue.replace(pa,"");else{var q=d.parentNode;for(l.remove(d);q&&l.isEmptyInlineElement(q)&&(y.safari?!(l.getPosition(q,n)&l.POSITION_CONTAINS):
!q.contains(n));){d=q.parentNode;l.remove(q);q=d}}}catch(o){}}function e(h,n){var q;for(h=h[n];h&&l.isFillChar(h);){q=h[n];l.remove(h);h=q}}var k=0,f=l.fillChar,d,m=ea.Range=function(h){var n=this;n.startContainer=n.startOffset=n.endContainer=n.endOffset=null;n.document=h;n.collapsed=true};m.prototype={cloneContents:function(){return this.collapsed?null:b(this,0)},deleteContents:function(){var h;this.collapsed||b(this,1);if(y.webkit){h=this.startContainer;if(h.nodeType==3&&!h.nodeValue.length){this.setStartBefore(h).collapse(true);
l.remove(h)}}return this},extractContents:function(){return this.collapsed?null:b(this,2)},setStart:function(h,n){return c(true,h,n,this)},setEnd:function(h,n){return c(false,h,n,this)},setStartAfter:function(h){return this.setStart(h.parentNode,l.getNodeIndex(h)+1)},setStartBefore:function(h){return this.setStart(h.parentNode,l.getNodeIndex(h))},setEndAfter:function(h){return this.setEnd(h.parentNode,l.getNodeIndex(h)+1)},setEndBefore:function(h){return this.setEnd(h.parentNode,l.getNodeIndex(h))},
setStartAtFirst:function(h){return this.setStart(h,0)},setStartAtLast:function(h){return this.setStart(h,h.nodeType==3?h.nodeValue.length:h.childNodes.length)},setEndAtFirst:function(h){return this.setEnd(h,0)},setEndAtLast:function(h){return this.setEnd(h,h.nodeType==3?h.nodeValue.length:h.childNodes.length)},selectNode:function(h){return this.setStartBefore(h).setEndAfter(h)},selectNodeContents:function(h){return this.setStart(h,0).setEndAtLast(h)},cloneRange:function(){var h=this;return(new m(h.document)).setStart(h.startContainer,
h.startOffset).setEnd(h.endContainer,h.endOffset)},collapse:function(h){var n=this;if(h){n.endContainer=n.startContainer;n.endOffset=n.startOffset}else{n.startContainer=n.endContainer;n.startOffset=n.endOffset}n.collapsed=true;return n},shrinkBoundary:function(h){function n(r){return r.nodeType==1&&!l.isBookmarkNode(r)&&!K.$empty[r.tagName]&&!K.$nonChild[r.tagName]}for(var q=this,o,p=q.collapsed;q.startContainer.nodeType==1&&(o=q.startContainer.childNodes[q.startOffset])&&n(o);)q.setStart(o,0);if(p)return q.collapse(true);
if(!h)for(;q.endContainer.nodeType==1&&q.endOffset>0&&(o=q.endContainer.childNodes[q.endOffset-1])&&n(o);)q.setEnd(o,o.childNodes.length);return q},getCommonAncestor:function(h,n){var q=this,o=q.startContainer,p=q.endContainer;if(o===p){if(h&&g(this)){o=o.childNodes[q.startOffset];if(o.nodeType==1)return o}return n&&o.nodeType==3?o.parentNode:o}return l.getCommonAncestor(o,p)},trimBoundary:function(h){this.txtToElmBoundary();var n=this.startContainer,q=this.startOffset,o=this.collapsed,p=this.endContainer;
if(n.nodeType==3){if(q==0)this.setStartBefore(n);else if(q>=n.nodeValue.length)this.setStartAfter(n);else{var r=l.split(n,q);if(n===p)this.setEnd(r,this.endOffset-q);else if(n.parentNode===p)this.endOffset+=1;this.setStartBefore(r)}if(o)return this.collapse(true)}if(!h){q=this.endOffset;p=this.endContainer;if(p.nodeType==3)if(q==0)this.setEndBefore(p);else{q<p.nodeValue.length&&l.split(p,q);this.setEndAfter(p)}}return this},txtToElmBoundary:function(h){function n(q,o){var p=q[o+"Container"],r=q[o+
"Offset"];if(p.nodeType==3)if(r)r>=p.nodeValue.length&&q["set"+o.replace(/(\w)/,function(s){return s.toUpperCase()})+"After"](p);else q["set"+o.replace(/(\w)/,function(s){return s.toUpperCase()})+"Before"](p)}if(h||!this.collapsed){n(this,"start");n(this,"end")}return this},insertNode:function(h){var n=h,q=1;if(h.nodeType==11){n=h.firstChild;q=h.childNodes.length}this.trimBoundary(true);var o=this.startContainer,p=o.childNodes[this.startOffset];p?o.insertBefore(h,p):o.appendChild(h);if(n.parentNode===
this.endContainer)this.endOffset+=q;return this.setStartBefore(n)},setCursor:function(h,n){return this.collapse(!h).select(n)},createBookmark:function(h,n){var q,o=this.document.createElement("span");o.style.cssText="display:none;line-height:0px;";o.appendChild(this.document.createTextNode("\u200d"));o.id="_baidu_bookmark_start_"+(n?"":k++);if(!this.collapsed){q=o.cloneNode(true);q.id="_baidu_bookmark_end_"+(n?"":k++)}this.insertNode(o);q&&this.collapse().insertNode(q).setEndBefore(q);this.setStartAfter(o);
return{start:h?o.id:o,end:q?h?q.id:q:null,id:h}},moveToBookmark:function(h){var n=h.id?this.document.getElementById(h.start):h.start;h=h.end&&h.id?this.document.getElementById(h.end):h.end;this.setStartBefore(n);l.remove(n);if(h){this.setEndBefore(h);l.remove(h)}else this.collapse(true);return this},enlarge:function(h,n){var q=l.isBody,o,p=this.document.createTextNode("");if(h){o=this.startContainer;if(o.nodeType==1)if(o.childNodes[this.startOffset])h=o=o.childNodes[this.startOffset];else{o.appendChild(p);
h=o=p}else h=o;for(;;){if(l.isBlockElm(o)){for(o=h;(h=o.previousSibling)&&!l.isBlockElm(h);)o=h;this.setStartBefore(o);break}h=o;o=o.parentNode}o=this.endContainer;if(o.nodeType==1){(h=o.childNodes[this.endOffset])?o.insertBefore(p,h):o.appendChild(p);h=o=p}else h=o;for(;;){if(l.isBlockElm(o)){for(o=h;(h=o.nextSibling)&&!l.isBlockElm(h);)o=h;this.setEndAfter(o);break}h=o;o=o.parentNode}p.parentNode===this.endContainer&&this.endOffset--;l.remove(p)}if(!this.collapsed){for(;this.startOffset==0;){if(n&&
n(this.startContainer))break;if(q(this.startContainer))break;this.setStartBefore(this.startContainer)}for(;this.endOffset==(this.endContainer.nodeType==1?this.endContainer.childNodes.length:this.endContainer.nodeValue.length);){if(n&&n(this.endContainer))break;if(q(this.endContainer))break;this.setEndAfter(this.endContainer)}}return this},enlargeToBlockElm:function(h){for(;!l.isBlockElm(this.startContainer);)this.setStartBefore(this.startContainer);if(!h)for(;!l.isBlockElm(this.endContainer);)this.setEndAfter(this.endContainer);
return this},adjustmentBoundary:function(){if(!this.collapsed){for(;!l.isBody(this.startContainer)&&this.startOffset==this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length&&this.startContainer[this.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)this.setStartAfter(this.startContainer);for(;!l.isBody(this.endContainer)&&!this.endOffset&&this.endContainer[this.endContainer.nodeType==3?"nodeValue":"childNodes"].length;)this.setEndBefore(this.endContainer)}return this},
applyInlineStyle:function(h,n,q){if(this.collapsed)return this;this.trimBoundary().enlarge(false,function(L){return L.nodeType==1&&l.isBlockElm(L)}).adjustmentBoundary();for(var o=this.createBookmark(),p=o.end,r=function(L){return L.nodeType==1?L.tagName.toLowerCase()!="br":!l.isWhitespace(L)},s=l.getNextDomNode(o.start,false,r),t,u,w=this.cloneRange();s&&l.getPosition(s,p)&l.POSITION_PRECEDING;)if(s.nodeType==3||K[h][s.tagName]){w.setStartBefore(s);for(t=s;t&&(t.nodeType==3||K[h][t.tagName])&&t!==
p;){u=t;t=l.getNextDomNode(t,t.nodeType==1,null,function(L){return K[h][L.tagName]})}s=w.setEndAfter(u).extractContents();var D;if(q&&q.length>0){var z;z=D=q[0].cloneNode(false);for(var F=1,I;I=q[F++];){D.appendChild(I.cloneNode(false));D=D.firstChild}D=D}else D=w.document.createElement(h);n&&l.setAttributes(D,n);D.appendChild(s);w.insertNode(q?z:D);var S;if(h=="span"&&n.style&&/text\-decoration/.test(n.style)&&(S=l.findParentByTagName(D,"a",true))){l.setAttributes(S,n);l.remove(D,true);D=S}else{l.mergeSibling(D);
l.clearEmptySibling(D)}l.mergeChild(D,n);s=l.getNextDomNode(D,false,r);l.mergeToParent(D);if(t===p)break}else s=l.getNextDomNode(s,true,r);return this.moveToBookmark(o)},removeInlineStyle:function(h){if(this.collapsed)return this;h=v.isArray(h)?h:[h];this.shrinkBoundary().adjustmentBoundary();for(var n=this.startContainer,q=this.endContainer;;){if(n.nodeType==1){if(v.indexOf(h,n.tagName.toLowerCase())>-1)break;if(n.tagName.toLowerCase()=="body"){n=null;break}}n=n.parentNode}for(;;){if(q.nodeType==
1){if(v.indexOf(h,q.tagName.toLowerCase())>-1)break;if(q.tagName.toLowerCase()=="body"){q=null;break}}q=q.parentNode}var o=this.createBookmark(),p,r;if(n){r=this.cloneRange().setEndBefore(o.start).setStartBefore(n);p=r.extractContents();r.insertNode(p);l.clearEmptySibling(n,true);n.parentNode.insertBefore(o.start,n)}if(q){r=this.cloneRange().setStartAfter(o.end).setEndAfter(q);p=r.extractContents();r.insertNode(p);l.clearEmptySibling(q,false,true);q.parentNode.insertBefore(o.end,q.nextSibling)}for(n=
l.getNextDomNode(o.start,false,function(s){return s.nodeType==1});n&&n!==o.end;){q=l.getNextDomNode(n,true,function(s){return s.nodeType==1});v.indexOf(h,n.tagName.toLowerCase())>-1&&l.remove(n,true);n=q}return this.moveToBookmark(o)},getClosedNode:function(){var h;if(!this.collapsed){var n=this.cloneRange().adjustmentBoundary().shrinkBoundary();if(g(n))if((n=n.startContainer.childNodes[n.startOffset])&&n.nodeType==1&&(K.$empty[n.tagName]||K.$nonChild[n.tagName]))h=n}return h},select:y.ie?function(h,
n){var q;this.collapsed||this.shrinkBoundary();var o=this.getClosedNode();if(o&&!n){try{q=this.document.body.createControlRange();q.addElement(o);q.select()}catch(p){}return this}n=this.createBookmark();o=n.start;q=this.document.body.createTextRange();q.moveToElementText(o);q.moveStart("character",1);if(this.collapsed){if(!h&&this.startContainer.nodeType!=3){h=this.document.createTextNode(f);var r=this.document.createElement("span");r.appendChild(this.document.createTextNode(f));o.parentNode.insertBefore(r,
o);o.parentNode.insertBefore(h,o);a(this.document,h);d=h;e(r,"previousSibling");e(o,"nextSibling");q.moveStart("character",-1);q.collapse(true)}}else{o=this.document.body.createTextRange();h=n.end;o.moveToElementText(h);q.setEndPoint("EndToEnd",o)}this.moveToBookmark(n);r&&l.remove(r);try{q.select()}catch(s){}return this}:function(h){function n(p){function r(s,t,u){if(s.nodeType==3&&s.nodeValue.length<t)p[u+"Offset"]=s.nodeValue.length}r(p.startContainer,p.startOffset,"start");r(p.endContainer,p.endOffset,
"end")}var q=l.getWindow(this.document),o=q.getSelection();y.gecko?this.document.body.focus():q.focus();if(o){o.removeAllRanges();if(this.collapsed&&!h){h=q=this.startContainer;if(q.nodeType==1)h=q.childNodes[this.startOffset];if(!(q.nodeType==3&&this.startOffset)&&(h?!h.previousSibling||h.previousSibling.nodeType!=3:!q.lastChild||q.lastChild.nodeType!=3)){h=this.document.createTextNode(f);this.insertNode(h);a(this.document,h);e(h,"previousSibling");e(h,"nextSibling");d=h;this.setStart(h,y.webkit?
1:0).collapse(true)}}q=this.document.createRange();if(this.collapsed&&y.opera&&this.startContainer.nodeType==1)if(h=this.startContainer.childNodes[this.startOffset]){for(;h&&l.isBlockElm(h);)if(h.nodeType==1&&h.childNodes[0])h=h.childNodes[0];else break;h&&this.setStartBefore(h).collapse(true)}else(h=this.startContainer.lastChild)&&l.isBr(h)&&this.setStartBefore(h).collapse(true);n(this);q.setStart(this.startContainer,this.startOffset);q.setEnd(this.endContainer,this.endOffset);o.addRange(q)}return this},
scrollToView:function(h,n){h=h?window:l.getWindow(this.document);var q=this,o=q.document.createElement("span");o.innerHTML="&nbsp;";q.cloneRange().insertNode(o);l.scrollToView(o,h,n);l.remove(o);return q},inFillChar:function(){var h=this.startContainer;if(this.collapsed&&h.nodeType==3&&h.nodeValue.replace(new RegExp("^"+l.fillChar),"").length+1==h.nodeValue.length)return true;return false},createAddress:function(h,n){function q(r){for(var s=r?p.startContainer:p.endContainer,t=l.findParents(s,true,
function(z){return!l.isBody(z)}),u=[],w=0,D;D=t[w++];)u.push(l.getNodeIndex(D,n));t=0;if(n)if(s.nodeType==3){for(s=s.previousSibling;s&&s.nodeType==3;){t+=s.nodeValue.replace(pa,"").length;s=s.previousSibling}t+=r?p.startOffset:p.endOffset}else if(s=s.childNodes[r?p.startOffset:p.endOffset])t=l.getNodeIndex(s,n);else{s=r?p.startContainer:p.endContainer;for(r=s.firstChild;r;)if(l.isFillChar(r))r=r.nextSibling;else{t++;if(r.nodeType==3)for(;r&&r.nodeType==3;)r=r.nextSibling;else r=r.nextSibling}}else t=
r?l.isFillChar(s)?0:p.startOffset:p.endOffset;if(t<0)t=0;u.push(t);return u}var o={},p=this;o.startAddress=q(true);if(!h)o.endAddress=p.collapsed?[].concat(o.startAddress):q();return o},moveToAddress:function(h,n){function q(p,r){for(var s=o.document.body,t,u,w=0,D,z=p.length;w<z;w++){D=p[w];t=s;s=s.childNodes[D];if(!s){u=D;break}}if(r)s?o.setStartBefore(s):o.setStart(t,u);else s?o.setEndBefore(s):o.setEnd(t,u)}var o=this;q(h.startAddress,true);!n&&h.endAddress&&q(h.endAddress);return o},equals:function(h){for(var n in this)if(this.hasOwnProperty(n))if(this[n]!==
h[n])return false;return true},traversal:function(h,n){if(this.collapsed)return this;for(var q=this.createBookmark(),o=q.end,p=l.getNextDomNode(q.start,false,n);p&&p!==o&&l.getPosition(p,o)&l.POSITION_PRECEDING;){var r=l.getNextDomNode(p,false,n);h(p);p=r}return this.moveToBookmark(q)}}})();(function(){function j(b,a){var e=l.getNodeIndex;b=b.duplicate();b.collapse(a);a=b.parentElement();if(!a.hasChildNodes())return{container:a,offset:0};for(var k=a.children,f,d=b.duplicate(),m=0,h=k.length-1,n=-1;m<=
h;){n=Math.floor((m+h)/2);f=k[n];d.moveToElementText(f);var q=d.compareEndPoints("StartToStart",b);if(q>0)h=n-1;else if(q<0)m=n+1;else return{container:a,offset:e(f)}}if(n==-1){d.moveToElementText(a);d.setEndPoint("StartToStart",b);b=d.text.replace(/(\r\n|\r)/g,"\n").length;k=a.childNodes;if(!b){f=k[k.length-1];return{container:f,offset:f.nodeValue.length}}for(e=k.length;b>0;)b-=k[--e].nodeValue.length;return{container:k[e],offset:-b}}d.collapse(q>0);d.setEndPoint(q>0?"StartToStart":"EndToStart",
b);b=d.text.replace(/(\r\n|\r)/g,"\n").length;if(!b)return K.$empty[f.tagName]||K.$nonChild[f.tagName]?{container:a,offset:e(f)+(q>0?0:1)}:{container:f,offset:q>0?0:f.childNodes.length};for(;b>0;)try{k=f;f=f[q>0?"previousSibling":"nextSibling"];b-=f.nodeValue.length}catch(o){return{container:a,offset:e(k)}}return{container:f,offset:q>0?-b:f.nodeValue.length+b}}function g(b,a){if(b.item)a.selectNode(b.item(0));else{var e=j(b,true);a.setStart(e.container,e.offset);if(b.compareEndPoints("StartToEnd",
b)!=0){e=j(b,false);a.setEnd(e.container,e.offset)}}return a}function c(b){var a;try{a=b.getNative().createRange()}catch(e){return null}var k=a.item?a.item(0):a.parentElement();if((k.ownerDocument||k)===b.document)return a;return null}(ea.Selection=function(b){var a=this;a.document=b;if(y.ie9below){b=l.getWindow(b).frameElement;l.on(b,"beforedeactivate",function(){a._bakIERange=a.getIERange()});l.on(b,"activate",function(){try{!c(a)&&a._bakIERange&&a._bakIERange.select()}catch(e){}a._bakIERange=null})}b=
b=null}).prototype={rangeInBody:function(b,a){b=y.ie9below||a?b.item?b.item():b.parentElement():b.startContainer;return b===this.document.body||l.inDoc(b,this.document)},getNative:function(){var b=this.document;try{return!b?null:y.ie9below?b.selection:l.getWindow(b).getSelection()}catch(a){return null}},getIERange:function(){var b=c(this);if(!b)if(this._bakIERange)return this._bakIERange;return b},cache:function(){this.clear();this._cachedRange=this.getRange();this._cachedStartElement=this.getStart();
this._cachedStartElementPath=this.getStartElementPath()},getStartElementPath:function(){if(this._cachedStartElementPath)return this._cachedStartElementPath;var b=this.getStart();if(b)return l.findParents(b,true,null,true);return[]},clear:function(){this._cachedStartElementPath=this._cachedRange=this._cachedStartElement=null},isFocus:function(){try{if(y.ie9below){var b=c(this);return!!(b&&this.rangeInBody(b))}else return!!this.getNative().rangeCount}catch(a){return false}},getRange:function(){function b(m){for(var h=
a.document.body.firstChild,n=m.collapsed;h&&h.firstChild;){m.setStart(h,0);h=h.firstChild}m.startContainer||m.setStart(a.document.body,0);n&&m.collapse(true)}var a=this;if(a._cachedRange!=null)return this._cachedRange;var e=new B.editor.dom.Range(a.document);if(y.ie9below){var k=a.getIERange();if(k)try{g(k,e)}catch(f){b(e)}else b(e)}else{var d=a.getNative();if(d&&d.rangeCount){k=d.getRangeAt(0);d=d.getRangeAt(d.rangeCount-1);e.setStart(k.startContainer,k.startOffset).setEnd(d.endContainer,d.endOffset);
e.collapsed&&l.isBody(e.startContainer)&&!e.startOffset&&b(e)}else{if(this._bakRange&&l.inDoc(this._bakRange.startContainer,this.document))return this._bakRange;b(e)}}return this._bakRange=e},getStart:function(){if(this._cachedStartElement)return this._cachedStartElement;var b=y.ie9below?this.getIERange():this.getRange(),a,e;if(y.ie9below){if(!b)return this.document.body.firstChild;if(b.item)return b.item(0);a=b.duplicate();a.text.length>0&&a.moveStart("character",1);a.collapse(1);a=a.parentElement();
for(e=b=b.parentElement();b=b.parentNode;)if(b==a){a=e;break}}else{b.shrinkBoundary();a=b.startContainer;if(a.nodeType==1&&a.hasChildNodes())a=a.childNodes[Math.min(a.childNodes.length-1,b.startOffset)];if(a.nodeType==3)return a.parentNode}return a},getText:function(){var b;if(this.isFocus()&&(b=this.getNative())){b=y.ie9below?b.createRange():b.getRangeAt(0);return y.ie9below?b.text:b.toString()}return""},clearRange:function(){this.getNative()[y.ie9below?"empty":"removeAllRanges"]()}}})();(function(){function j(k,
f){var d;if(f.textarea)if(v.isString(f.textarea))for(var m=0,h,n=l.getElementsByTagName(k,"textarea");h=n[m++];){if(h.id=="ueditor_textarea_"+f.options.textarea){d=h;break}}else d=f.textarea;if(!d){k.appendChild(d=l.createElement(document,"textarea",{name:f.options.textarea,id:"ueditor_textarea_"+f.options.textarea,style:"display:none"}));f.textarea=d}!d.getAttribute("name")&&d.setAttribute("name",f.options.textarea);d.value=f.hasContents()?f.options.allHtmlEnabled?f.getAllHtml():f.getContent(null,
null,true):""}function g(k){for(var f in k)return f}function c(k){k.langIsReady=true;k.fireEvent("langReady")}var b=0,a,e=UE.Editor=function(k){var f=k.ck_base_path;if(!f||f=="")f="http://www.ckplayer.com/ckplayer/6.5";UE.ckplay_path=f;var d=this;d.uid=b++;Ba.call(d);d.commands={};d.options=v.extend(v.clone(k||{}),UEDITOR_CONFIG,true);d.shortcutkeys={};d.inputRules=[];d.outputRules=[];d.setOpt(e.defaultOptions(d));d.loadServerConfig();if(v.isEmptyObject(UE.I18N))v.loadFile(document,{src:d.options.langPath+
d.options.lang+"/"+d.options.lang+".js",tag:"script",type:"text/javascript",defer:"defer"},function(){UE.plugin.load(d);c(d)});else{d.options.lang=g(UE.I18N);UE.plugin.load(d);c(d)}UE.instants["ueditorInstant"+d.uid]=d};e.prototype={registerCommand:function(k,f){this.commands[k]=f},ready:function(k){var f=this;if(k)f.isReady?k.apply(f):f.addListener("ready",k)},setOpt:function(k,f){var d={};if(v.isString(k))d[k]=f;else d=k;v.extend(this.options,d,true)},getOpt:function(k){return this.options[k]},
destroy:function(){var k=this;k.fireEvent("destroy");var f=k.container.parentNode,d=k.textarea;if(d)d.style.display="";else{d=document.createElement("textarea");f.parentNode.insertBefore(d,f)}d.style.width=k.iframe.offsetWidth+"px";d.style.height=k.iframe.offsetHeight+"px";d.value=k.getContent();d.id=k.key;f.innerHTML="";l.remove(f);f=k.key;for(var m in k)k.hasOwnProperty(m)&&delete this[m];UE.delEditor(f)},render:function(k){var f=this,d=f.options,m=function(h){return parseInt(l.getComputedStyle(k,
h))};if(v.isString(k))k=document.getElementById(k);if(k){d.minFrameWidth=d.initialFrameWidth?d.initialFrameWidth:(d.initialFrameWidth=k.offsetWidth);if(d.initialFrameHeight)d.minFrameHeight=d.initialFrameHeight;else d.initialFrameHeight=d.minFrameHeight=k.offsetHeight;k.style.width=/%$/.test(d.initialFrameWidth)?"100%":d.initialFrameWidth-m("padding-left")-m("padding-right")+"px";k.style.height=/%$/.test(d.initialFrameHeight)?"100%":d.initialFrameHeight-m("padding-top")-m("padding-bottom")+"px";k.style.zIndex=
d.zIndex;m=(fa&&y.version<9?"":"<!DOCTYPE html>")+"<html xmlns='http://www.w3.org/1999/xhtml' class='view' ><head><style type='text/css'>.view{padding:0;word-wrap:break-word;cursor:text;height:90%;}\nbody{margin:8px;font-family:Microsoft YaHei;font-size:16px;}p{margin:5px 0;}</style>"+(d.iframeCssUrl?"<link rel='stylesheet' type='text/css' href='"+v.unhtml(d.iframeCssUrl)+"'/>":"")+(d.initialStyle?"<style>"+d.initialStyle+"</style>":"")+"</head><body class='view' ></body><script type='text/javascript' "+
(fa?"defer='defer'":"")+" id='_initialScript'>setTimeout(function(){editor = window.parent.UE.instants['ueditorInstant"+f.uid+"'];editor._setup(document);},0);var _tmpScript = document.getElementById('_initialScript');_tmpScript.parentNode.removeChild(_tmpScript);<\/script></html>";k.appendChild(l.createElement(document,"iframe",{id:"ueditor_"+f.uid,width:"100%",height:"100%",frameborder:"0",src:"javascript:void(function(){document.open();"+(d.customDomain&&document.domain!=location.hostname?'document.domain="'+
document.domain+'";':"")+'document.write("'+m+'");document.close();}())'}));k.style.overflow="hidden";setTimeout(function(){if(/%$/.test(d.initialFrameWidth))d.minFrameWidth=d.initialFrameWidth=k.offsetWidth;if(/%$/.test(d.initialFrameHeight)){d.minFrameHeight=d.initialFrameHeight=k.offsetHeight;k.style.height=d.initialFrameHeight+"px"}})}},_setup:function(k){var f=this,d=f.options;if(fa){k.body.disabled=true;k.body.contentEditable=true;k.body.disabled=false}else k.body.contentEditable=true;k.body.spellcheck=
false;f.document=k;f.window=k.defaultView||k.parentWindow;f.iframe=f.window.frameElement;f.body=k.body;f.selection=new ea.Selection(k);var m;if(y.gecko&&(m=this.selection.getNative()))m.removeAllRanges();this._initEvents();for(var h=this.iframe.parentNode;!l.isBody(h);h=h.parentNode)if(h.tagName=="FORM"){f.form=h;f.options.autoSyncData?l.on(f.window,"blur",function(){j(h,f)}):l.on(h,"submit",function(){j(this,f)});break}if(d.initialContent)if(d.autoClearinitialContent){var n=f.execCommand;f.execCommand=
function(){f.fireEvent("firstBeforeExecCommand");return n.apply(f,arguments)};this._setDefaultContent(d.initialContent)}else this.setContent(d.initialContent,false,true);if(l.isEmptyNode(f.body))f.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";d.focus&&setTimeout(function(){f.focus(f.options.focusInEnd);!f.options.autoClearinitialContent&&f._selectionChange()},0);if(!f.container)f.container=this.iframe.parentNode;d.fullscreen&&f.ui&&f.ui.setFullScreen(true);try{f.document.execCommand("2D-position",
false,false)}catch(q){}try{f.document.execCommand("enableInlineTableEditing",false,false)}catch(o){}try{f.document.execCommand("enableObjectResizing",false,false)}catch(p){}f._bindshortcutKeys();f.isReady=1;f.fireEvent("ready");d.onready&&d.onready.call(f);y.ie9below||l.on(f.window,["blur","focus"],function(r){if(r.type=="blur"){f._bakRange=f.selection.getRange();try{f._bakNativeRange=f.selection.getNative().getRangeAt(0);f.selection.getNative().removeAllRanges()}catch(s){f._bakNativeRange=null}}else try{f._bakRange&&
f._bakRange.select()}catch(t){}});if(y.gecko&&y.version<=10902){f.body.contentEditable=false;setTimeout(function(){f.body.contentEditable=true},100);setInterval(function(){f.body.style.height=f.iframe.offsetHeight-20+"px"},100)}!d.isShow&&f.setHide();d.readonly&&f.setDisabled()},sync:function(k){var f=this;(k=k?document.getElementById(k):l.findParent(f.iframe.parentNode,function(d){return d.tagName=="FORM"},true))&&j(k,f)},setHeight:function(k,f){if(k!==parseInt(this.iframe.parentNode.style.height))this.iframe.parentNode.style.height=
k+"px";!f&&(this.options.minFrameHeight=this.options.initialFrameHeight=k);this.body.style.height=k+"px";!f&&this.trigger("setHeight")},addshortcutkey:function(k,f){var d={};if(f)d[k]=f;else d=k;v.extend(this.shortcutkeys,d)},_bindshortcutKeys:function(){var k=this,f=this.shortcutkeys;k.addListener("keydown",function(d,m){d=m.keyCode||m.which;for(var h in f)for(var n=f[h].split(","),q=0,o;o=n[q++];){o=o.split(":");var p=o[0];o=o[1];if(/^(ctrl)(\+shift)?\+(\d+)$/.test(p.toLowerCase())||/^(\d+)$/.test(p))if((RegExp.$1==
"ctrl"?m.ctrlKey||m.metaKey:0)&&(RegExp.$2!=""?m[RegExp.$2.slice(1)+"Key"]:1)&&d==RegExp.$3||d==RegExp.$1){k.queryCommandState(h,o)!=-1&&k.execCommand(h,o);l.preventDefault(m)}}})},getContent:function(k,f,d,m,h){d=this;if(k&&v.isFunction(k)){f=k;k=""}if(f?!f():!this.hasContents())return"";d.fireEvent("beforegetcontent");f=UE.htmlparser(d.body.innerHTML,m);d.filterOutputRule(f);d.fireEvent("aftergetcontent",k,f);return f.toHtml(h)},getAllHtml:function(){var k=this,f=[];k.fireEvent("getAllHtml",f);
if(y.ie&&y.version>8){var d="";v.each(k.document.styleSheets,function(m){d+=m.href?'<link rel="stylesheet" type="text/css" href="'+m.href+'" />':"<style>"+m.cssText+"</style>"});v.each(k.document.getElementsByTagName("script"),function(m){d+=m.outerHTML})}return"<html><head>"+(k.options.charset?'<meta http-equiv="Content-Type" content="text/html; charset='+k.options.charset+'"/>':"")+(d||k.document.getElementsByTagName("head")[0].innerHTML)+f.join("\n")+"</head><body "+(fa&&y.version<9?'class="view"':
"")+">"+k.getContent(null,null,true)+"</body></html>"},getPlainTxt:function(){var k=new RegExp(l.fillChar,"g"),f=this.body.innerHTML.replace(/[\n\r]/g,"");f=f.replace(/<(p|div)[^>]*>(<br\/?>|&nbsp;)<\/\1>/gi,"\n").replace(/<br\/?>/gi,"\n").replace(/<[^>/]+>/g,"").replace(/(\n)?<\/([^>]+)>/g,function(d,m,h){return K.$block[h]?"\n":m?m:""});return f.replace(k,"").replace(/\u00a0/g," ").replace(/&nbsp;/g," ")},getContentTxt:function(){return this.body[y.ie?"innerText":"textContent"].replace(new RegExp(l.fillChar,
"g"),"").replace(/\u00a0/g," ")},setContent:function(k,f,d){function m(o){return o.tagName=="DIV"&&o.getAttribute("cdata_tag")}var h=this;h.fireEvent("beforesetcontent",k);k=UE.htmlparser(k);h.filterInputRule(k);k=k.toHtml();h.body.innerHTML=(f?h.body.innerHTML:"")+k;if(h.options.enterTag=="p"){f=this.body.firstChild;if(!f||f.nodeType==1&&(K.$cdata[f.tagName]||m(f)||l.isCustomeNode(f))&&f===this.body.lastChild)this.body.innerHTML="<p>"+(y.ie?"&nbsp;":"<br/>")+"</p>"+this.body.innerHTML;else for(var n=
h.document.createElement("p");f;){for(;f&&(f.nodeType==3||f.nodeType==1&&K.p[f.tagName]&&!K.$cdata[f.tagName]);){k=f.nextSibling;n.appendChild(f);f=k}if(n.firstChild)if(f){f.parentNode.insertBefore(n,f);n=h.document.createElement("p")}else{h.body.appendChild(n);break}f=f.nextSibling}}h.fireEvent("aftersetcontent");h.fireEvent("contentchange");!d&&h._selectionChange();h._bakRange=h._bakIERange=h._bakNativeRange=null;var q;if(y.gecko&&(q=this.selection.getNative()))q.removeAllRanges();h.options.autoSyncData&&
h.form&&j(h.form,h)},focus:function(k){try{var f=this,d=f.selection.getRange();if(k){var m=f.body.lastChild;if(m&&m.nodeType==1&&!K.$empty[m.tagName]){l.isEmptyBlock(m)?d.setStartAtFirst(m):d.setStartAtLast(m);d.collapse(true)}d.setCursor(true)}else{if(!d.collapsed&&l.isBody(d.startContainer)&&d.startOffset==0)(m=f.body.firstChild)&&m.nodeType==1&&!K.$empty[m.tagName]&&d.setStartAtFirst(m).collapse(true);d.select(true)}this.fireEvent("focus selectionchange")}catch(h){}},isFocus:function(){return this.selection.isFocus()},
blur:function(){var k=this.selection.getNative();if(k.empty&&y.ie){var f=document.body.createTextRange();f.moveToElementText(document.body);f.collapse(true);f.select();k.empty()}else k.removeAllRanges()},_initEvents:function(){var k=this,f=k.document,d=k.window;k._proxyDomEvent=v.bind(k._proxyDomEvent,k);l.on(f,["click","contextmenu","mousedown","keydown","keyup","keypress","mouseup","mouseover","mouseout","selectstart"],k._proxyDomEvent);l.on(d,["focus","blur"],k._proxyDomEvent);l.on(k.body,"drop",
function(m){y.gecko&&m.stopPropagation&&m.stopPropagation();k.fireEvent("contentchange")});l.on(f,["mouseup","keydown"],function(m){m.type=="keydown"&&(m.ctrlKey||m.metaKey||m.shiftKey||m.altKey)||m.button!=2&&k._selectionChange(250,m)})},_proxyDomEvent:function(k){if(this.fireEvent("before"+k.type.replace(/^on/,"").toLowerCase())===false)return false;if(this.fireEvent(k.type.replace(/^on/,""),k)===false)return false;return this.fireEvent("after"+k.type.replace(/^on/,"").toLowerCase())},_selectionChange:function(k,
f){var d=this,m=false,h,n;if(y.ie&&y.version<9&&f&&f.type=="mouseup")if(!this.selection.getRange().collapsed){m=true;h=f.clientX;n=f.clientY}clearTimeout(a);a=setTimeout(function(){if(d.selection&&d.selection.getNative()){var q;if(m&&d.selection.getNative().type=="None"){q=d.document.body.createTextRange();try{q.moveToPoint(h,n)}catch(o){q=null}}var p;if(q){p=d.selection.getIERange;d.selection.getIERange=function(){return q}}d.selection.cache();if(p)d.selection.getIERange=p;if(d.selection._cachedRange&&
d.selection._cachedStartElement){d.fireEvent("beforeselectionchange");d.fireEvent("selectionchange",!!f);d.fireEvent("afterselectionchange");d.selection.clear()}}},k||50)},_callCmdFn:function(k,f){var d=f[0].toLowerCase(),m;m=(d=this.commands[d]||UE.commands[d])&&d[k];if((!d||!m)&&k=="queryCommandState")return 0;else if(m)return m.apply(this,f)},execCommand:function(k){k=k.toLowerCase();var f=this,d,m=f.commands[k]||UE.commands[k];if(!m||!m.execCommand)return null;if(!m.notNeedUndo&&!f.__hasEnterExecCommand){f.__hasEnterExecCommand=
true;if(f.queryCommandState.apply(f,arguments)!=-1){f.fireEvent("saveScene");f.fireEvent.apply(f,["beforeexeccommand",k].concat(arguments));d=this._callCmdFn("execCommand",arguments);f.fireEvent.apply(f,["afterexeccommand",k].concat(arguments));f.fireEvent("saveScene")}f.__hasEnterExecCommand=false}else{d=this._callCmdFn("execCommand",arguments);!f.__hasEnterExecCommand&&!m.ignoreContentChange&&!f._ignoreContentChange&&f.fireEvent("contentchange")}!f.__hasEnterExecCommand&&!m.ignoreContentChange&&
!f._ignoreContentChange&&f._selectionChange();return d},queryCommandState:function(){return this._callCmdFn("queryCommandState",arguments)},queryCommandValue:function(){return this._callCmdFn("queryCommandValue",arguments)},hasContents:function(k){if(k)for(var f=0,d;d=k[f++];)if(this.document.getElementsByTagName(d).length>0)return true;if(!l.isEmptyBlock(this.body))return true;k=["div"];for(f=0;d=k[f++];){d=l.getElementsByTagName(this.document,d);for(var m=0,h;h=d[m++];)if(l.isCustomeNode(h))return true}return false},
reset:function(){this.fireEvent("reset")},setEnabled:function(){var k=this,f;if(k.body.contentEditable=="false"){k.body.contentEditable=true;f=k.selection.getRange();try{f.moveToBookmark(k.lastBk);delete k.lastBk}catch(d){f.setStartAtFirst(k.body).collapse(true)}f.select(true);if(k.bkqueryCommandState){k.queryCommandState=k.bkqueryCommandState;delete k.bkqueryCommandState}if(k.bkqueryCommandValue){k.queryCommandValue=k.bkqueryCommandValue;delete k.bkqueryCommandValue}k.fireEvent("selectionchange")}},
enable:function(){return this.setEnabled()},setDisabled:function(k){var f=this;k=k?v.isArray(k)?k:[k]:[];if(f.body.contentEditable=="true"){if(!f.lastBk)f.lastBk=f.selection.getRange().createBookmark(true);f.body.contentEditable=false;f.bkqueryCommandState=f.queryCommandState;f.bkqueryCommandValue=f.queryCommandValue;f.queryCommandState=function(d){if(v.indexOf(k,d)!=-1)return f.bkqueryCommandState.apply(f,arguments);return-1};f.queryCommandValue=function(d){if(v.indexOf(k,d)!=-1)return f.bkqueryCommandValue.apply(f,
arguments);return null};f.fireEvent("selectionchange")}},disable:function(k){return this.setDisabled(k)},_setDefaultContent:function(){function k(){var f=this;if(f.document.getElementById("initContent")){f.body.innerHTML="<p>"+(fa?"":"<br/>")+"</p>";f.removeListener("firstBeforeExecCommand focus",k);setTimeout(function(){f.focus();f._selectionChange()},0)}}return function(f){var d=this;d.body.innerHTML='<p id="initContent">'+f+"</p>";d.addListener("firstBeforeExecCommand focus",k)}}(),setShow:function(){var k=
this,f=k.selection.getRange();if(k.container.style.display=="none"){try{f.moveToBookmark(k.lastBk);delete k.lastBk}catch(d){f.setStartAtFirst(k.body).collapse(true)}setTimeout(function(){f.select(true)},100);k.container.style.display=""}},show:function(){return this.setShow()},setHide:function(){var k=this;if(!k.lastBk)k.lastBk=k.selection.getRange().createBookmark(true);k.container.style.display="none"},hide:function(){return this.setHide()},getLang:function(k){var f=UE.I18N[this.options.lang];if(!f)throw Error("not import language file");
k=(k||"").split(".");for(var d=0,m;m=k[d++];){f=f[m];if(!f)break}return f},getContentLength:function(k,f){var d=this.getContent(false,false,true).length;if(k){f=(f||[]).concat(["hr","img","iframe"]);d=this.getContentTxt().replace(/[\t\r\n]+/g,"").length;k=0;for(var m;m=f[k++];)d+=this.document.getElementsByTagName(m).length}return d},addInputRule:function(k){this.inputRules.push(k)},filterInputRule:function(k){for(var f=0,d;d=this.inputRules[f++];)d.call(this,k)},addOutputRule:function(k){this.outputRules.push(k)},
filterOutputRule:function(k){for(var f=0,d;d=this.outputRules[f++];)d.call(this,k)},getActionUrl:function(k){k=this.getOpt(k)||k;var f=this.getOpt("imageUrl"),d=this.getOpt("serverUrl");if(!d&&f)d=f.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2");if(d){d=d+(d.indexOf("?")==-1?"?":"&")+"action="+(k||"");return v.formatUrl(d)}else return""}};v.inherits(e,Ba)})();UE.Editor.defaultOptions=function(j){j=j.options.UEDITOR_HOME_URL;return{isShow:true,initialContent:"",initialStyle:"",autoClearinitialContent:false,
iframeCssUrl:j+"themes/iframe.css",textarea:"editorValue",focus:false,focusInEnd:true,autoClearEmptyNode:true,fullscreen:false,readonly:false,zIndex:999,imagePopup:true,enterTag:"p",customDomain:false,lang:"zh-cn",langPath:j+"lang/",theme:"default",themePath:j+"themes/",allHtmlEnabled:false,scaleEnabled:false,tableNativeEditInFF:false,autoSyncData:true,fileNameFormat:"{time}{rand:6}"}};(function(){UE.Editor.prototype.loadServerConfig=function(){function j(c){console&&console.error(c)}var g=this;setTimeout(function(){try{g.options.imageUrl&&
g.setOpt("serverUrl",g.options.imageUrl.replace(/^(.*[\/]).+([\.].+)$/,"$1controller$2"));var c=g.getActionUrl("config"),b=v.isCrossDomainUrl(c);g._serverConfigLoaded=false;c&&UE.ajax.request(c,{method:"GET",dataType:b?"jsonp":"",onsuccess:function(e){try{var k=b?e:eval("("+e.responseText+")");v.extend(g.options,k);g.fireEvent("serverConfigLoaded");g._serverConfigLoaded=true}catch(f){j(g.getLang("loadconfigFormatError"))}},onerror:function(){j(g.getLang("loadconfigHttpError"))}})}catch(a){j(g.getLang("loadconfigError"))}})};
UE.Editor.prototype.isServerConfigLoaded=function(){return this._serverConfigLoaded||false};UE.Editor.prototype.afterConfigReady=function(j){if(j&&v.isFunction(j)){var g=this,c=function(){j.apply(g,arguments);g.removeListener("serverConfigLoaded",c)};g.isServerConfigLoaded()?j.call(g,"serverConfigLoaded"):g.addListener("serverConfigLoaded",c)}}})();UE.ajax=function(){function j(f){var d=[];for(var m in f)if(!(m=="method"||m=="timeout"||m=="async"||m=="dataType"||m=="callback"))if(!(f[m]==undefined||
f[m]==null))if((typeof f[m]).toLowerCase()=="function"||(typeof f[m]).toLowerCase()=="object"){if(v.isArray(f[m]))for(var h=0;h<f[m].length;h++)d.push(encodeURIComponent(m)+"[]="+encodeURIComponent(f[m][h]))}else d.push(encodeURIComponent(m)+"="+encodeURIComponent(f[m]));return d.join("&")}function g(f,d){var m=k(),h=false,n={method:"POST",timeout:5E3,async:true,data:{},onsuccess:function(){},onerror:function(){}};if(typeof f==="object"){d=f;f=d.url}if(m&&f){var q=d?v.extend(n,d):n;d=j(q);v.isEmptyObject(q.data)||
(d+=(d?"&":"")+j(q.data));var o=setTimeout(function(){if(m.readyState!=4){h=true;m.abort();clearTimeout(o)}},q.timeout);n=q.method.toUpperCase();f=f+(f.indexOf("?")==-1?"?":"&")+(n=="POST"?"":d+"&noCache="+ +new Date);m.open(n,f,q.async);m.onreadystatechange=function(){if(m.readyState==4)!h&&m.status==200?q.onsuccess(m):q.onerror(m)};if(n=="POST"){m.setRequestHeader("Content-Type","application/x-www-form-urlencoded");m.send(d)}else m.send(null)}}function c(f,d){function m(z,F,I){z.setAttribute("type",
"text/javascript");z.setAttribute("defer","defer");I&&z.setAttribute("charset",I);z.setAttribute("src",F);document.getElementsByTagName("head")[0].appendChild(z)}function h(z){return function(){try{if(z)o.onerror&&o.onerror();else try{clearTimeout(u);n.apply(window,arguments)}catch(F){}}catch(I){o.onerror&&o.onerror.call(window,I)}finally{o.oncomplete&&o.oncomplete.apply(window,arguments);q.parentNode&&q.parentNode.removeChild(q);window[s]=null;try{delete window[s]}catch(S){}}}}var n=d.onsuccess||
function(){},q=document.createElement("SCRIPT"),o=d||{},p=o.charset,r=o.jsonp||"callback",s,t=o.timeOut||0,u,w=new RegExp("(\\?|&)"+r+"=([^&]*)"),D;if(v.isFunction(n)){s="bd__editor__"+Math.floor(Math.random()*2147483648).toString(36);window[s]=h(0)}else if(v.isString(n))s=n;else if(D=w.exec(f))s=D[2];f=f.replace(w,"$1"+r+"="+s);if(f.search(w)<0)f+=(f.indexOf("?")<0?"?":"&")+r+"="+s;r=j(d);v.isEmptyObject(d.data)||(r+=(r?"&":"")+j(d.data));if(r)f=f.replace(/\?/,"?"+r+"&");q.onerror=h(1);if(t)u=setTimeout(h(1),
t);m(q,f,p)}var b="XMLHttpRequest()";try{new ActiveXObject("Msxml2.XMLHTTP");b="ActiveXObject('Msxml2.XMLHTTP')"}catch(a){try{new ActiveXObject("Microsoft.XMLHTTP");b="ActiveXObject('Microsoft.XMLHTTP')"}catch(e){}}var k=new Function("return new "+b);return{request:function(f,d){d&&d.dataType=="jsonp"?c(f,d):g(f,d)},getJSONP:function(f,d,m){c(f,{data:d,oncomplete:m})}}}();UE.filterWord=function(){function j(b){return/(class="?Mso|style="[^"]*\bmso\-|w:WordDocument|<(v|o):|lang=)/ig.test(b)}function g(b){return b=
b.replace(/[\d.]+\w+/g,function(a){return v.transUnitToPx(a)})}function c(b){return b.replace(/[\t\r\n]+/g," ").replace(/<!--[\s\S]*?--\>/ig,"").replace(/<v:shape [^>]*>[\s\S]*?.<\/v:shape>/gi,function(a){if(y.opera)return"";try{if(/Bitmap/i.test(a))return"";var e=a.match(/width:([ \d.]*p[tx])/i)[1],k=a.match(/height:([ \d.]*p[tx])/i)[1],f=a.match(/src=\s*"([^"]*)"/i)[1];return'<img width="'+g(e)+'" height="'+g(k)+'" src="'+f+'" />'}catch(d){return""}}).replace(/<\/?div[^>]*>/g,"").replace(/v:\w+=(["']?)[^'"]+\1/g,
"").replace(/<(!|script[^>]*>.*?<\/script(?=[>\s])|\/?(\?xml(:\w+)?|xml|meta|link|style|\w+:\w+)(?=[\s\/>]))[^>]*>/gi,"").replace(/<p [^>]*class="?MsoHeading"?[^>]*>(.*?)<\/p>/gi,"<p><strong>$1</strong></p>").replace(/\s+(class|lang|align)\s*=\s*(['"]?)([\w-]+)\2/ig,function(a,e,k,f){return e=="class"&&f=="MsoListParagraph"?a:""}).replace(/<(font|span)[^>]*>(\s*)<\/\1>/gi,function(a,e,k){return k.replace(/[\t\r\n ]+/g," ")}).replace(/(<[a-z][^>]*)\sstyle=(["'])([^\2]*?)\2/gi,function(a,e,k,f){a=[];
f=f.replace(/^\s+|\s+$/,"").replace(/&#39;/g,"'").replace(/&quot;/gi,"'").replace(/[\d.]+(cm|pt)/g,function(n){return v.transUnitToPx(n)}).split(/;\s*/g);k=0;for(var d;d=f[k];k++){var m,h=d.split(":");if(h.length==2){d=h[0].toLowerCase();m=h[1].toLowerCase();if(!(/^(background)\w*/.test(d)&&m.replace(/(initial|\s)/g,"").length==0||/^(margin)\w*/.test(d)&&/^0\w+$/.test(m))){switch(d){case "mso-padding-alt":case "mso-padding-top-alt":case "mso-padding-right-alt":case "mso-padding-bottom-alt":case "mso-padding-left-alt":case "mso-margin-alt":case "mso-margin-top-alt":case "mso-margin-right-alt":case "mso-margin-bottom-alt":case "mso-margin-left-alt":case "mso-height":case "mso-width":case "mso-vertical-align-alt":/<table/.test(e)||
(a[k]=d.replace(/^mso-|-alt$/g,"")+":"+g(m));continue;case "horiz-align":a[k]="text-align:"+m;continue;case "vert-align":a[k]="vertical-align:"+m;continue;case "font-color":case "mso-foreground":a[k]="color:"+m;continue;case "mso-background":case "mso-highlight":a[k]="background:"+m;continue;case "mso-default-height":a[k]="min-height:"+g(m);continue;case "mso-default-width":a[k]="min-width:"+g(m);continue;case "mso-padding-between-alt":a[k]="border-collapse:separate;border-spacing:"+g(m);continue;
case "text-line-through":if(m=="single"||m=="double")a[k]="text-decoration:line-through";continue;case "mso-zero-height":if(m=="yes")a[k]="display:none";continue;case "margin":if(!/[1-9]/.test(m))continue}/^(mso|column|font-emph|lang|layout|line-break|list-image|nav|panose|punct|row|ruby|sep|size|src|tab-|table-border|text-(?:decor|trans)|top-bar|version|vnd|word-break)/.test(d)||/text\-indent|padding|margin/.test(d)&&/\-[\d.]+/.test(m)||(a[k]=d+":"+h[1])}}}return e+(a.length?' style="'+a.join(";").replace(/;{2,}/g,
";")+'"':"")})}return function(b){return j(b)?c(b):b}}();(function(){function j(p,r,s){p.push(o);return r+(s?1:-1)}function g(p,r){for(var s=0;s<r;s++)p.push(q)}function c(p,r,s,t){switch(p.type){case "root":for(var u=0,w;w=p.children[u++];){if(s&&w.type=="element"&&!K.$inlineWithA[w.tagName]&&u>1){j(r,t,true);g(r,t)}c(w,r,s,t)}break;case "text":b(p,r);break;case "element":a(p,r,s,t);break;case "comment":e(p,r,s)}return r}function b(p,r){p.parentNode.tagName=="pre"?r.push(p.data):r.push(n[p.parentNode.tagName]?
v.html(p.data):p.data.replace(/[ ]{2}/g," &nbsp;"))}function a(p,r,s,t){var u="";if(p.attrs){u=[];var w=p.attrs;for(var D in w)u.push(D+(w[D]!==undefined?'="'+(h[D]?v.html(w[D]).replace(/["]/g,function(){return"&quot;"}):v.unhtml(w[D]))+'"':""));u=u.join(" ")}r.push("<"+p.tagName+(u?" "+u:"")+(K.$empty[p.tagName]?"/":"")+">");if(s&&!K.$inlineWithA[p.tagName]&&p.tagName!="pre")if(p.children&&p.children.length){t=j(r,t,true);g(r,t)}if(p.children&&p.children.length)for(u=0;w=p.children[u++];){if(s&&
w.type=="element"&&!K.$inlineWithA[w.tagName]&&u>1){j(r,t);g(r,t)}c(w,r,s,t)}if(!K.$empty[p.tagName]){if(s&&!K.$inlineWithA[p.tagName]&&p.tagName!="pre")if(p.children&&p.children.length){t=j(r,t);g(r,t)}r.push("</"+p.tagName+">")}}function e(p,r){r.push("<!--"+p.data+"--\>")}function k(p,r){var s;if(p.type=="element"&&p.getAttr("id")==r)return p;if(p.children&&p.children.length)for(var t=0;s=p.children[t++];)if(s=k(s,r))return s}function f(p,r,s){p.type=="element"&&p.tagName==r&&s.push(p);if(p.children&&
p.children.length)for(var t=0,u;u=p.children[t++];)f(u,r,s)}function d(p,r){if(p.children&&p.children.length)for(var s=0,t;t=p.children[s];){d(t,r);if(t.parentNode){t.children&&t.children.length&&r(t);t.parentNode&&s++}}else r(p)}var m=UE.uNode=function(p){this.type=p.type;this.data=p.data;this.tagName=p.tagName;this.parentNode=p.parentNode;this.attrs=p.attrs||{};this.children=p.children},h={href:1,src:1,_src:1,_href:1,cdata_data:1},n={style:1,script:1},q="    ",o="\n";m.createElement=function(p){return/[<>]/.test(p)?
UE.htmlparser(p).children[0]:new m({type:"element",children:[],tagName:p})};m.createText=function(p,r){return new UE.uNode({type:"text",data:r?p:v.unhtml(p||"")})};m.prototype={toHtml:function(p){var r=[];c(this,r,p,0);return r.join("")},innerHTML:function(p){if(this.type!="element"||K.$empty[this.tagName])return this;if(v.isString(p)){if(this.children)for(var r=0,s;s=this.children[r++];)s.parentNode=null;this.children=[];p=UE.htmlparser(p);for(r=0;s=p.children[r++];){this.children.push(s);s.parentNode=
this}return this}else{p=new UE.uNode({type:"root",children:this.children});return p.toHtml()}},innerText:function(p,r){if(this.type!="element"||K.$empty[this.tagName])return this;if(p){if(this.children)for(var s=0,t;t=this.children[s++];)t.parentNode=null;this.children=[];this.appendChild(m.createText(p,r));return this}else return this.toHtml().replace(/<[^>]+>/g,"")},getData:function(){if(this.type=="element")return"";return this.data},firstChild:function(){return this.children?this.children[0]:
null},lastChild:function(){return this.children?this.children[this.children.length-1]:null},previousSibling:function(){for(var p=this.parentNode,r=0,s;s=p.children[r];r++)if(s===this)return r==0?null:p.children[r-1]},nextSibling:function(){for(var p=this.parentNode,r=0,s;s=p.children[r++];)if(s===this)return p.children[r]},replaceChild:function(p,r){if(this.children){p.parentNode&&p.parentNode.removeChild(p);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s,1,p);r.parentNode=null;
p.parentNode=this;return p}}},appendChild:function(p){if(this.type=="root"||this.type=="element"&&!K.$empty[this.tagName]){if(!this.children)this.children=[];p.parentNode&&p.parentNode.removeChild(p);for(var r=0,s;s=this.children[r];r++)if(s===p){this.children.splice(r,1);break}this.children.push(p);p.parentNode=this;return p}},insertBefore:function(p,r){if(this.children){p.parentNode&&p.parentNode.removeChild(p);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s,0,p);p.parentNode=
this;return p}}},insertAfter:function(p,r){if(this.children){p.parentNode&&p.parentNode.removeChild(p);for(var s=0,t;t=this.children[s];s++)if(t===r){this.children.splice(s+1,0,p);p.parentNode=this;return p}}},removeChild:function(p,r){if(this.children)for(var s=0,t;t=this.children[s];s++)if(t===p){this.children.splice(s,1);t.parentNode=null;if(r&&t.children&&t.children.length)for(p=0;r=t.children[p];p++){this.children.splice(s+p,0,r);r.parentNode=this}return t}},getAttr:function(p){return this.attrs&&
this.attrs[p.toLowerCase()]},setAttr:function(p,r){if(p){if(!this.attrs)this.attrs={};if(v.isObject(p))for(var s in p)if(p[s])this.attrs[s.toLowerCase()]=p[s];else delete this.attrs[s];else if(r)this.attrs[p.toLowerCase()]=r;else delete this.attrs[p]}else delete this.attrs},getIndex:function(){for(var p=this.parentNode,r=0,s;s=p.children[r];r++)if(s===this)return r;return-1},getNodeById:function(p){var r;if(this.children&&this.children.length)for(var s=0;r=this.children[s++];)if(r=k(r,p))return r},
getNodesByTagName:function(p){p=v.trim(p).replace(/[ ]{2,}/g," ").split(" ");var r=[],s=this;v.each(p,function(t){if(s.children&&s.children.length)for(var u=0,w;w=s.children[u++];)f(w,t,r)});return r},getStyle:function(p){var r=this.getAttr("style");if(!r)return"";if((p=r.match(new RegExp("(^|;)\\s*"+p+":([^;]+)","i")))&&p[0])return p[2];return""},setStyle:function(p,r){function s(w,D){t=t.replace(new RegExp("(^|;)\\s*"+w+":([^;]+;?)","gi"),"$1");if(D)t=w+":"+v.unhtml(D)+";"+t}var t=this.getAttr("style");
t||(t="");if(v.isObject(p))for(var u in p)s(u,p[u]);else s(p,r);this.setAttr("style",v.trim(t))},traversal:function(p){this.children&&this.children.length&&d(this,p);return this}}})();UE.htmlparser=function(j,g){function c(u,w){if(n[u.tagName]){var D=m.createElement(n[u.tagName]);u.appendChild(D);D.appendChild(m.createText(w))}else u.appendChild(m.createText(w))}function b(u,w,D){var z;if(z=h[w]){for(var F=u,I;F.type!="root";){if(v.isArray(z)?v.indexOf(z,F.tagName)!=-1:z==F.tagName){u=F;I=true;break}F=
F.parentNode}I||(u=b(u,v.isArray(z)?z[0]:z))}z=new m({parentNode:u,type:"element",tagName:w.toLowerCase(),children:K.$empty[w]?null:[]});if(D){for(F={};I=k.exec(D);)F[I[1].toLowerCase()]=d[I[1].toLowerCase()]?I[2]||I[3]||I[4]:v.unhtml(I[2]||I[3]||I[4]);z.attrs=F}u.children.push(z);return K.$empty[w]?u:z}function a(u,w){u.children.push(new m({type:"comment",data:w,parentNode:u}))}var e=/<(?:(?:\/([^>]+)>)|(?:!--([\S|\s]*?)--\>)|(?:([^\s\/<>]+)\s*((?:(?:"[^"]*")|(?:'[^']*')|[^"'<>])*)\/?>))/g,k=/([\w\-:.]+)(?:(?:\s*=\s*(?:(?:"([^"]*)")|(?:'([^']*)')|([^\s>]+)))|(?=\s|$))/g,
f={b:1,code:1,i:1,u:1,strike:1,s:1,tt:1,strong:1,q:1,samp:1,em:1,span:1,sub:1,img:1,sup:1,font:1,big:1,small:1,iframe:1,a:1,br:1,pre:1};j=j.replace(new RegExp(l.fillChar,"g"),"");g||(j=j.replace(new RegExp("[\\r\\t\\n"+(g?"":" ")+"]*</?(\\w+)\\s*(?:[^>]*)>[\\r\\t\\n"+(g?"":" ")+"]*","g"),function(u,w){if(w&&f[w.toLowerCase()])return u.replace(/(^[\n\r]+)|([\n\r]+$)/g,"");return u.replace(new RegExp("^[\\r\\n"+(g?"":" ")+"]+"),"").replace(new RegExp("[\\r\\n"+(g?"":" ")+"]+$"),"")}));for(var d={href:1,
src:1},m=UE.uNode,h={td:"tr",tr:["tbody","thead","tfoot"],tbody:"table",th:"tr",thead:"table",tfoot:"table",caption:"table",li:["ul","ol"],dt:"dl",dd:"dl",option:"select"},n={ol:"li",ul:"li"},q,o=0,p=0,r=new m({type:"root",children:[]}),s=r;q=e.exec(j);){o=q.index;try{o>p&&c(s,j.slice(p,o));if(q[3])if(K.$cdata[s.tagName])c(s,q[0]);else s=b(s,q[3].toLowerCase(),q[4]);else if(q[1]){if(s.type!="root")if(K.$cdata[s.tagName]&&!K.$cdata[q[1]])c(s,q[0]);else{for(o=s;s.type=="element"&&s.tagName!=q[1].toLowerCase();){s=
s.parentNode;if(s.type=="root"){s=o;throw"break";}}s=s.parentNode}}else q[2]&&a(s,q[2])}catch(t){}p=e.lastIndex}p<j.length&&c(s,j.slice(p));return r};UE.filterNode=function(){function j(g,c){switch(g.type){case "text":break;case "element":var b;if(b=c[g.tagName])if(b==="-")g.parentNode.removeChild(g);else if(v.isFunction(b)){var a=g.parentNode,e=g.getIndex();b(g);if(g.parentNode){if(g.children)for(b=0;e=g.children[b];){j(e,c);e.parentNode&&b++}}else for(b=e;e=a.children[b];){j(e,c);e.parentNode&&
b++}}else{if((b=b.$)&&g.attrs){e={};var k;for(a in b){k=g.getAttr(a);if(a=="style"&&v.isArray(b[a])){var f=[];v.each(b[a],function(d){var m;if(m=g.getStyle(d))f.push(d+":"+m)});k=f.join(";")}if(k)e[a]=k}g.attrs=e}if(g.children)for(b=0;e=g.children[b];){j(e,c);e.parentNode&&b++}}else if(K.$cdata[g.tagName])g.parentNode.removeChild(g);else{a=g.parentNode;e=g.getIndex();g.parentNode.removeChild(g,true);for(b=e;e=a.children[b];){j(e,c);e.parentNode&&b++}}break;case "comment":g.parentNode.removeChild(g)}}
return function(g,c){if(v.isEmptyObject(c))return g;var b;if(b=c["-"])v.each(b.split(" "),function(e){c[e]="-"});b=0;for(var a;a=g.children[b];){j(a,c);a.parentNode&&b++}return g}}();UE.plugin=function(){var j={};return{register:function(g,c,b,a){if(b&&v.isFunction(b)){a=b;b=null}j[g]={optionName:b||g,execFn:c,afterDisabled:a}},load:function(g){v.each(j,function(c){var b=c.execFn.call(g);if(g.options[c.optionName]!==false)b&&v.each(b,function(a,e){switch(e.toLowerCase()){case "shortcutkey":g.addshortcutkey(a);
break;case "bindevents":v.each(a,function(k,f){g.addListener(f,k)});break;case "bindmultievents":v.each(v.isArray(a)?a:[a],function(k){var f=v.trim(k.type).split(/\s+/);v.each(f,function(d){g.addListener(d,k.handler)})});break;case "commands":v.each(a,function(k,f){g.commands[f]=k});break;case "outputrule":g.addOutputRule(a);break;case "inputrule":g.addInputRule(a);break;case "defaultoptions":g.setOpt(a)}});else c.afterDisabled&&c.afterDisabled.call(g)});v.each(UE.plugins,function(c){c.call(g)})},
run:function(g,c){(g=j[g])&&g.exeFn.call(c)}}}();var Ca=UE.keymap={Backspace:8,Tab:9,Enter:13,Shift:16,Control:17,Alt:18,CapsLock:20,Esc:27,Spacebar:32,PageUp:33,PageDown:34,End:35,Home:36,Left:37,Up:38,Right:39,Down:40,Insert:45,Del:46,NumLock:144,Cmd:91,"=":187,"-":189,b:66,i:73,z:90,y:89,v:86,x:88,s:83,n:78},qa=UE.LocalStorage=function(){function j(){var b=document.createElement("div");b.style.display="none";if(!b.addBehavior)return null;b.addBehavior("#default#userdata");return{getItem:function(a){var e=
null;try{document.body.appendChild(b);b.load(c);e=b.getAttribute(a);document.body.removeChild(b)}catch(k){}return e},setItem:function(a,e){document.body.appendChild(b);b.setAttribute(a,e);b.save(c);document.body.removeChild(b)},removeItem:function(a){document.body.appendChild(b);b.removeAttribute(a);b.save(c);document.body.removeChild(b)}}}var g=window.localStorage||j()||null,c="localStorage";return{saveLocalData:function(b,a){if(g&&a){g.setItem(b,a);return true}return false},getLocalData:function(b){if(g)return g.getItem(b);
return null},removeItem:function(b){g&&g.removeItem(b)}}}();(function(){UE.Editor.prototype.setPreferences=function(j,g){var c={};if(v.isString(j))c[j]=g;else c=j;if((j=qa.getLocalData("ueditor_preference"))&&(j=v.str2json(j)))v.extend(j,c);else j=c;j&&qa.saveLocalData("ueditor_preference",v.json2str(j))};UE.Editor.prototype.getPreferences=function(j){var g=qa.getLocalData("ueditor_preference");if(g&&(g=v.str2json(g)))return j?g[j]:g;return null};UE.Editor.prototype.removePreferences=function(j){var g=
qa.getLocalData("ueditor_preference");if(g&&(g=v.str2json(g))){g[j]=undefined;delete g[j]}g&&qa.saveLocalData("ueditor_preference",v.json2str(g))}})();UE.plugins.defaultfilter=function(){var j=this;j.setOpt({allowDivTransToP:true,disabledTableInTable:true});j.addInputRule(function(g){function c(e){for(;e&&e.type=="element";){if(e.tagName=="td")return true;e=e.parentNode}return false}var b=this.options.allowDivTransToP,a;g.traversal(function(e){if(e.type=="element")if(!K.$cdata[e.tagName]&&j.options.autoClearEmptyNode&&
K.$inline[e.tagName]&&!K.$empty[e.tagName]&&(!e.attrs||v.isEmptyObject(e.attrs)))if(e.firstChild()){if(e.tagName=="span"&&(!e.attrs||v.isEmptyObject(e.attrs)))e.parentNode.removeChild(e,true)}else e.parentNode.removeChild(e);else switch(e.tagName){case "style":case "script":e.setAttr({cdata_tag:e.tagName,cdata_data:e.innerHTML()||"",_ue_custom_node_:"true"});e.tagName="div";e.innerHTML("");break;case "a":if(a=e.getAttr("href"))e.setAttr("_href",a);break;case "img":if(a=e.getAttr("src"))if(/^data:/.test(a)){e.parentNode.removeChild(e);
break}e.setAttr("_src",e.getAttr("src"));break;case "span":if(y.webkit&&(a=e.getStyle("white-space")))if(/nowrap|normal/.test(a)){e.setStyle("white-space","");j.options.autoClearEmptyNode&&v.isEmptyObject(e.attrs)&&e.parentNode.removeChild(e,true)}(a=e.getAttr("id"))&&/^_baidu_bookmark_/i.test(a)&&e.parentNode.removeChild(e);break;case "p":if(a=e.getAttr("align")){e.setAttr("align");e.setStyle("text-align",a)}v.each(e.children,function(d){if(d.type=="element"&&d.tagName=="p"){var m=d.nextSibling();
e.parentNode.insertAfter(d,e);for(d=d;m;){var h=m.nextSibling();e.parentNode.insertAfter(m,d);d=m;m=h}return false}});e.firstChild()||e.innerHTML(y.ie?"&nbsp;":"<br/>");break;case "div":if(e.getAttr("cdata_tag"))break;if((a=e.getAttr("class"))&&/^line number\d+/.test(a))break;if(!b)break;for(var k,f=UE.uNode.createElement("p");k=e.firstChild();)if(k.type=="text"||!UE.dom.dtd.$block[k.tagName])f.appendChild(k);else if(f.firstChild()){e.parentNode.insertBefore(f,e);f=UE.uNode.createElement("p")}else e.parentNode.insertBefore(k,
e);f.firstChild()&&e.parentNode.insertBefore(f,e);e.parentNode.removeChild(e);break;case "dl":e.tagName="ul";break;case "dt":case "dd":e.tagName="li";break;case "li":k=e.getAttr("class");if(!k||!/list\-/.test(k))e.setAttr();k=e.getNodesByTagName("ol ul");UE.utils.each(k,function(d){e.parentNode.insertAfter(d,e)});break;case "td":case "th":case "caption":if(!e.children||!e.children.length)e.appendChild(y.ie11below?UE.uNode.createText(" "):UE.uNode.createElement("br"));break;case "table":if(j.options.disabledTableInTable&&
c(e)){e.parentNode.insertBefore(UE.uNode.createText(e.innerText()),e);e.parentNode.removeChild(e)}}})});j.addOutputRule(function(g){var c;g.traversal(function(b){if(b.type=="element")if(j.options.autoClearEmptyNode&&K.$inline[b.tagName]&&!K.$empty[b.tagName]&&(!b.attrs||v.isEmptyObject(b.attrs)))if(b.firstChild()){if(b.tagName=="span"&&(!b.attrs||v.isEmptyObject(b.attrs)))b.parentNode.removeChild(b,true)}else b.parentNode.removeChild(b);else switch(b.tagName){case "div":if(c=b.getAttr("cdata_tag")){b.tagName=
c;b.appendChild(UE.uNode.createText(b.getAttr("cdata_data")));b.setAttr({cdata_tag:"",cdata_data:"",_ue_custom_node_:""})}break;case "a":if(c=b.getAttr("_href"))b.setAttr({href:v.html(c),_href:""});break;case "span":(c=b.getAttr("id"))&&/^_baidu_bookmark_/i.test(c)&&b.parentNode.removeChild(b);break;case "img":if(c=b.getAttr("_src"))b.setAttr({src:b.getAttr("_src"),_src:""})}})})};UE.commands.inserthtml={execCommand:function(j,g,c){var b=this,a;if(g)if(b.fireEvent("beforeinserthtml",g)!==true){a=
b.selection.getRange();j=a.document.createElement("div");j.style.display="inline";if(!c){c=UE.htmlparser(g);b.options.filterRules&&UE.filterNode(c,b.options.filterRules);b.filterInputRule(c);g=c.toHtml()}j.innerHTML=v.trim(g);if(!a.collapsed){c=a.startContainer;l.isFillChar(c)&&a.setStartBefore(c);c=a.endContainer;l.isFillChar(c)&&a.setEndAfter(c);a.txtToElmBoundary();if(a.endContainer&&a.endContainer.nodeType==1)(c=a.endContainer.childNodes[a.endOffset])&&l.isBr(c)&&a.setEndAfter(c);if(a.startOffset==
0){c=a.startContainer;if(l.isBoundaryNode(c,"firstChild")){c=a.endContainer;if(a.endOffset==(c.nodeType==3?c.nodeValue.length:c.childNodes.length)&&l.isBoundaryNode(c,"lastChild")){b.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";a.setStart(b.body.firstChild,0).collapse(true)}}}!a.collapsed&&a.deleteContents();if(a.startContainer.nodeType==1){c=a.startContainer.childNodes[a.startOffset];var e;if(c&&l.isBlockElm(c)&&(e=c.previousSibling)&&l.isBlockElm(e)){for(a.setEnd(e,e.childNodes.length).collapse();c.firstChild;)e.appendChild(c.firstChild);
l.remove(c)}}}var k,f,d=0,m;if(a.inFillChar()){c=a.startContainer;if(l.isFillChar(c)){a.setStartBefore(c).collapse(true);l.remove(c)}else if(l.isFillChar(c,true)){c.nodeValue=c.nodeValue.replace(pa,"");a.startOffset--;a.collapsed&&a.collapse(true)}}var h=l.findParentByTagName(a.startContainer,"li",true);if(h){for(var n;c=j.firstChild;){for(;c&&(c.nodeType==3||!l.isBlockElm(c)||c.tagName=="HR");){n=c.nextSibling;a.insertNode(c).collapse();k=c;c=n}if(c)if(/^(ol|ul)$/i.test(c.tagName)){for(;c.firstChild;){k=
c.firstChild;l.insertAfter(h,c.firstChild);h=h.nextSibling}l.remove(c)}else{n=c.nextSibling;e=b.document.createElement("li");l.insertAfter(h,e);e.appendChild(c);k=c;c=n;h=e}}h=l.findParentByTagName(a.startContainer,"li",true);l.isEmptyBlock(h)&&l.remove(h);k&&a.setStartAfter(k).collapse(true).select(true)}else{for(;c=j.firstChild;){if(d){for(k=b.document.createElement("p");c&&(c.nodeType==3||!K.$block[c.tagName]);){m=c.nextSibling;k.appendChild(c);c=m}if(k.firstChild)c=k}a.insertNode(c);m=c.nextSibling;
if(!d&&c.nodeType==l.NODE_ELEMENT&&l.isBlockElm(c))if((k=l.findParent(c,function(p){return l.isBlockElm(p)}))&&k.tagName.toLowerCase()!="body"&&!(K[k.tagName][c.nodeName]&&c.parentNode===k)){if(K[k.tagName][c.nodeName])for(f=c.parentNode;f!==k;){e=f;f=f.parentNode}else e=k;l.breakParent(c,e||f);e=c.previousSibling;l.trimWhiteTextNode(e);e.childNodes.length||l.remove(e);if(!y.ie&&(n=c.nextSibling)&&l.isBlockElm(n)&&n.lastChild&&!l.isBr(n.lastChild))n.appendChild(b.document.createElement("br"));d=1}n=
c.nextSibling;if(!j.firstChild&&n&&l.isBlockElm(n)){a.setStart(n,0).collapse(true);break}a.setEndAfter(c).collapse()}c=a.startContainer;m&&l.isBr(m)&&l.remove(m);if(l.isBlockElm(c)&&l.isEmptyNode(c))if(m=c.nextSibling){l.remove(c);m.nodeType==1&&K.$block[m.tagName]&&a.setStart(m,0).collapse(true).shrinkBoundary()}else try{c.innerHTML=y.ie?l.fillChar:"<br/>"}catch(q){a.setStartBefore(c);l.remove(c)}try{a.select(true)}catch(o){}}setTimeout(function(){a=b.selection.getRange();a.scrollToView(b.autoHeightEnabled,
b.autoHeightEnabled?l.getXY(b.iframe).y:0);b.fireEvent("afterinserthtml",g)},200)}}};UE.plugins.autotypeset=function(){function j(q,o){if(!q||q.nodeType==3)return 0;if(l.isBr(q))return 1;if(q&&q.parentNode&&h[q.tagName.toLowerCase()]){if(n&&n.contains(q)||q.getAttribute("pagebreak"))return 0;return o?!l.isEmptyBlock(q):l.isEmptyBlock(q,new RegExp("[\\s"+l.fillChar+"]","g"))}}function g(q){if(!q.style.cssText){l.removeAttributes(q,["style"]);q.tagName.toLowerCase()=="span"&&l.hasNoAttributes(q)&&l.remove(q,
true)}}function c(q,o){var p=this;if(o){if(!f.pasteFilter)return;q=p.document.createElement("div");q.innerHTML=o.html}else q=p.document.body;for(var r=l.getElementsByTagName(q,"*"),s=0,t;t=r[s++];)if(p.fireEvent("excludeNodeinautotype",t)!==true){if(f.clearFontSize&&t.style.fontSize){l.removeStyle(t,"font-size");g(t)}if(f.clearFontFamily&&t.style.fontFamily){l.removeStyle(t,"font-family");g(t)}if(j(t)){if(f.mergeEmptyline)for(var u=t.nextSibling,w,D=l.isBr(t);j(u);){w=u;u=w.nextSibling;if(D&&(!u||
u&&!l.isBr(u)))break;l.remove(w)}if(f.removeEmptyline&&l.inDoc(t,q)&&!m[t.parentNode.tagName.toLowerCase()]){if(l.isBr(t))if((u=t.nextSibling)&&!l.isBr(u))continue;l.remove(t);continue}}if(j(t,true)&&t.tagName!="SPAN"){if(f.indent)t.style.textIndent=f.indentValue;if(f.textAlign)t.style.textAlign=f.textAlign}if(f.removeClass&&t.className&&!d[t.className.toLowerCase()]){if(n&&n.contains(t))continue;l.removeAttributes(t,["class"])}if(f.imageBlockLine&&t.tagName.toLowerCase()=="img"&&!t.getAttribute("emotion"))if(o){D=
t;switch(f.imageBlockLine){case "left":case "right":case "none":u=D.parentNode;for(var z;K.$inline[u.tagName]||u.tagName=="A";)u=u.parentNode;w=u;if(w.tagName=="P"&&l.getStyle(w,"text-align")=="center")if(!l.isBody(w)&&l.getChildCount(w,function(F){return!l.isBr(F)&&!l.isWhitespace(F)})==1){z=w.previousSibling;u=w.nextSibling;if(z&&u&&z.nodeType==1&&u.nodeType==1&&z.tagName==u.tagName&&l.isBlockElm(z)){for(z.appendChild(w.firstChild);u.firstChild;)z.appendChild(u.firstChild);l.remove(w);l.remove(u)}else l.setStyle(w,
"text-align","")}l.setStyle(D,"float",f.imageBlockLine);break;case "center":if(p.queryCommandValue("imagefloat")!="center"){u=D.parentNode;l.setStyle(D,"float","none");for(w=D;u&&l.getChildCount(u,function(F){return!l.isBr(F)&&!l.isWhitespace(F)})==1&&(K.$inline[u.tagName]||u.tagName=="A");){w=u;u=u.parentNode}u=p.document.createElement("p");l.setAttributes(u,{style:"text-align:center"});w.parentNode.insertBefore(u,w);u.appendChild(w);l.setStyle(w,"float","")}}}else{p.selection.getRange().selectNode(t).select();
p.execCommand("imagefloat",f.imageBlockLine)}f.removeEmptyNode&&f.removeTagNames[t.tagName.toLowerCase()]&&l.hasNoAttributes(t)&&l.isEmptyBlock(t)&&l.remove(t)}if(f.tobdc){p=UE.htmlparser(q.innerHTML);p.traversal(function(F){if(F.type=="text")F.data=a(F.data)});q.innerHTML=p.toHtml()}if(f.bdc2sb){p=UE.htmlparser(q.innerHTML);p.traversal(function(F){if(F.type=="text")F.data=b(F.data)});q.innerHTML=p.toHtml()}if(o)o.html=q.innerHTML}function b(q){for(var o="",p=0;p<q.length;p++){var r=q.charCodeAt(p);
o+=r>=65281&&r<=65373?String.fromCharCode(q.charCodeAt(p)-65248):r==12288?String.fromCharCode(q.charCodeAt(p)-12288+32):q.charAt(p)}return o}function a(q){q=v.html(q);for(var o="",p=0;p<q.length;p++)o+=q.charCodeAt(p)==32?String.fromCharCode(12288):q.charCodeAt(p)<127?String.fromCharCode(q.charCodeAt(p)+65248):q.charAt(p);return o}function e(){var q=k.getPreferences("autotypeset");v.extend(k.options.autotypeset,q)}this.setOpt({autotypeset:{mergeEmptyline:true,removeClass:true,removeEmptyline:false,
textAlign:"left",imageBlockLine:"center",pasteFilter:false,clearFontSize:false,clearFontFamily:false,removeEmptyNode:false,removeTagNames:v.extend({div:1},K.$removeEmpty),indent:false,indentValue:"2em",bdc2sb:false,tobdc:false}});var k=this,f=k.options.autotypeset,d={selectTdClass:1,pagebreak:1,anchorclass:1},m={li:1},h={div:1,p:1,blockquote:1,center:1,h1:1,h2:1,h3:1,h4:1,h5:1,h6:1,span:1},n;if(f){e();f.pasteFilter&&k.addListener("beforepaste",c);k.commands.autotypeset={execCommand:function(){k.removeListener("beforepaste",
c);f.pasteFilter&&k.addListener("beforepaste",c);c.call(k)}}}};UE.plugin.register("autosubmit",function(){return{shortcutkey:{autosubmit:"ctrl+13"},commands:{autosubmit:{execCommand:function(){var j=this,g=l.findParentByTagName(j.iframe,"form",false);if(g)if(j.fireEvent("beforesubmit")!==false){j.sync();g.submit()}}}}}});UE.commands.imagefloat={execCommand:function(j,g){var c=this;j=c.selection.getRange();if(!j.collapsed){var b=j.getClosedNode();if(b&&b.tagName=="IMG")switch(g){case "left":case "right":case "none":for(var a=
b.parentNode,e;K.$inline[a.tagName]||a.tagName=="A";)a=a.parentNode;e=a;if(e.tagName=="P"&&l.getStyle(e,"text-align")=="center"){if(!l.isBody(e)&&l.getChildCount(e,function(k){return!l.isBr(k)&&!l.isWhitespace(k)})==1){c=e.previousSibling;a=e.nextSibling;if(c&&a&&c.nodeType==1&&a.nodeType==1&&c.tagName==a.tagName&&l.isBlockElm(c)){for(c.appendChild(e.firstChild);a.firstChild;)c.appendChild(a.firstChild);l.remove(e);l.remove(a)}else l.setStyle(e,"text-align","")}j.selectNode(b).select()}l.setStyle(b,
"float",g=="none"?"":g);g=="none"&&l.removeAttributes(b,"align");break;case "center":if(c.queryCommandValue("imagefloat")!="center"){a=b.parentNode;l.setStyle(b,"float","");l.removeAttributes(b,"align");for(e=b;a&&l.getChildCount(a,function(k){return!l.isBr(k)&&!l.isWhitespace(k)})==1&&(K.$inline[a.tagName]||a.tagName=="A");){e=a;a=a.parentNode}j.setStartBefore(e).setCursor(false);a=c.document.createElement("div");a.appendChild(e);l.setStyle(e,"float","");c.execCommand("insertHtml",'<p id="_img_parent_tmp" style="text-align:center">'+
a.innerHTML+"</p>");e=c.document.getElementById("_img_parent_tmp");e.removeAttribute("id");e=e.firstChild;j.selectNode(e).select();(a=e.parentNode.nextSibling)&&l.isEmptyNode(a)&&l.remove(a)}break}}},queryCommandValue:function(){var j=this.selection.getRange(),g;if(j.collapsed)return"none";if((j=j.getClosedNode())&&j.nodeType==1&&j.tagName=="IMG"){g=l.getComputedStyle(j,"float")||j.getAttribute("align");if(g=="none")g=l.getComputedStyle(j.parentNode,"text-align")=="center"?"center":g;return{left:1,
right:1,center:1}[g]?g:"none"}return"none"},queryCommandState:function(){var j=this.selection.getRange();if(j.collapsed)return-1;if((j=j.getClosedNode())&&j.nodeType==1&&j.tagName=="IMG")return 0;return-1}};UE.commands.insertimage={execCommand:function(j,g){g=v.isArray(g)?g:[g];if(g.length){j=this;var c=j.selection.getRange(),b=c.getClosedNode();if(j.fireEvent("beforeinsertimage",g)!==true){if(b&&/img/i.test(b.tagName)&&(b.className!="edui-faked-video"||b.className.indexOf("edui-upload-video")!=-1)&&
!b.getAttribute("word_img")){var a=g.shift(),e=a.floatStyle;delete a.floatStyle;l.setAttributes(b,a);j.execCommand("imagefloat",e);if(g.length>0){c.setStartAfter(b).setCursor(false,true);j.execCommand("insertimage",g)}}else{c=[];b="";a=g[0];if(g.length==1){b='<img src="'+a.src+'" '+(a._src?' _src="'+a._src+'" ':"")+(a.width?'width="'+a.width+'" ':"")+(a.height?' height="'+a.height+'" ':"")+(a.floatStyle=="left"||a.floatStyle=="right"?' style="float:'+a.floatStyle+';"':"")+(a.title&&a.title!=""?' title="'+
a.title+'"':"")+(a.border&&a.border!="0"?' border="'+a.border+'"':"")+(a.alt&&a.alt!=""?' alt="'+a.alt+'"':"")+(a.hspace&&a.hspace!="0"?' hspace = "'+a.hspace+'"':"")+(a.vspace&&a.vspace!="0"?' vspace = "'+a.vspace+'"':"")+"/>";if(a.floatStyle=="center")b='<p style="text-align: center">'+b+"</p>";c.push(b)}else for(e=0;a=g[e++];){b="<p "+(a.floatStyle=="center"?'style="text-align: center" ':"")+'><img src="'+a.src+'" '+(a.width?'width="'+a.width+'" ':"")+(a._src?' _src="'+a._src+'" ':"")+(a.height?
' height="'+a.height+'" ':"")+' style="'+(a.floatStyle&&a.floatStyle!="center"?"float:"+a.floatStyle+";":"")+(a.border||"")+'" '+(a.title?' title="'+a.title+'"':"")+" /></p>";c.push(b)}j.execCommand("insertHtml",c.join(""))}j.fireEvent("afterinsertimage",g)}}}};UE.plugins.justify=function(){var j=l.isBlockElm,g={left:1,right:1,center:1,justify:1},c=function(b,a){var e=b.createBookmark(),k=function(q){return q.nodeType==1?q.tagName.toLowerCase()!="br"&&!l.isBookmarkNode(q):!l.isWhitespace(q)};b.enlarge(true);
for(var f=b.createBookmark(),d=l.getNextDomNode(f.start,false,k),m=b.cloneRange(),h;d&&!(l.getPosition(d,f.end)&l.POSITION_FOLLOWING);)if(d.nodeType==3||!j(d)){for(m.setStartBefore(d);d&&d!==f.end&&!j(d);){h=d;d=l.getNextDomNode(d,false,null,function(q){return!j(q)})}m.setEndAfter(h);d=m.getCommonAncestor();if(!l.isBody(d)&&j(d)){l.setStyles(d,v.isString(a)?{"text-align":a}:a);d=d}else{d=b.document.createElement("p");l.setStyles(d,v.isString(a)?{"text-align":a}:a);var n=m.extractContents();d.appendChild(n);
m.insertNode(d);d=d}d=l.getNextDomNode(d,false,k)}else d=l.getNextDomNode(d,true,k);return b.moveToBookmark(f).moveToBookmark(e)};UE.commands.justify={execCommand:function(b,a){b=this.selection.getRange();var e;if(b.collapsed){e=this.document.createTextNode("p");b.insertNode(e)}c(b,a);if(e){b.setStartBefore(e).collapse(true);l.remove(e)}b.select();return true},queryCommandValue:function(){var b=this.selection.getStart();b=l.getComputedStyle(b,"text-align");return g[b]?b:"left"},queryCommandState:function(){var b=
this.selection.getStart();return b&&l.findParentByTagName(b,["td","th","caption"],true)?-1:0}}};UE.plugins.font=function(){function j(d){for(var m;m=d.parentNode;)if(m.tagName=="SPAN"&&l.getChildCount(m,function(h){return!l.isBookmarkNode(h)&&!l.isBr(h)})==1){m.style.cssText+=d.style.cssText;l.remove(d,true);d=m}else break}function g(d,m,h){if(k[m]){d.adjustmentBoundary();if(!d.collapsed&&d.startContainer.nodeType==1){var n=d.startContainer.childNodes[d.startOffset];if(n&&l.isTagNode(n,"span")){var q=
d.createBookmark();v.each(l.getElementsByTagName(n,"span"),function(o){if(!(!o.parentNode||l.isBookmarkNode(o)))if(!(m=="backcolor"&&l.getComputedStyle(o,"background-color").toLowerCase()===h)){l.removeStyle(o,k[m]);o.style.cssText.replace(/^\s+$/,"").length==0&&l.remove(o,true)}});d.moveToBookmark(q)}}}}function c(d,m,h){var n=d.collapsed,q=d.createBookmark();if(n)for(n=q.start.parentNode;K.$inline[n.tagName];)n=n.parentNode;else n=l.getCommonAncestor(q.start,q.end);v.each(l.getElementsByTagName(n,
"span"),function(o){if(!(!o.parentNode||l.isBookmarkNode(o)))if(/\s*border\s*:\s*none;?\s*/i.test(o.style.cssText))/^\s*border\s*:\s*none;?\s*$/.test(o.style.cssText)?l.remove(o,true):l.removeStyle(o,"border");else{if(/border/i.test(o.style.cssText)&&o.parentNode.tagName=="SPAN"&&/border/i.test(o.parentNode.style.cssText))o.style.cssText=o.style.cssText.replace(/border[^:]*:[^;]+;?/gi,"");if(!(m=="fontborder"&&h=="none"))for(var p=o.nextSibling;p&&p.nodeType==1&&p.tagName=="SPAN";){if(l.isBookmarkNode(p)&&
m=="fontborder")o.appendChild(p);else{if(p.style.cssText==o.style.cssText){l.moveChild(p,o);l.remove(p)}if(o.nextSibling===p)break}p=o.nextSibling}j(o);if(y.ie&&y.version>8)if((p=l.findParent(o,function(r){return r.tagName=="SPAN"&&/background-color/.test(r.style.cssText)}))&&!/background-color/.test(o.style.cssText))o.style.backgroundColor=p.style.backgroundColor}});d.moveToBookmark(q);g(d,m,h)}var b=this,a={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family",
underline:"text-decoration",strikethrough:"text-decoration",fontborder:"border"},e={underline:1,strikethrough:1,fontborder:1},k={forecolor:"color",backcolor:"background-color",fontsize:"font-size",fontfamily:"font-family"};b.setOpt({fontfamily:[{name:"songti",val:"\u5b8b\u4f53,SimSun"},{name:"yahei",val:"\u5fae\u8f6f\u96c5\u9ed1,Microsoft YaHei"},{name:"kaiti",val:"\u6977\u4f53,\u6977\u4f53_GB2312, SimKai"},{name:"heiti",val:"\u9ed1\u4f53, SimHei"},{name:"lishu",val:"\u96b6\u4e66, SimLi"},{name:"andaleMono",
val:"andale mono"},{name:"arial",val:"arial, helvetica,sans-serif"},{name:"arialBlack",val:"arial black,avant garde"},{name:"comicSansMs",val:"comic sans ms"},{name:"impact",val:"impact,chicago"},{name:"timesNewRoman",val:"times new roman"}],fontsize:[10,11,12,14,16,18,20,24,36]});b.addInputRule(function(d){v.each(d.getNodesByTagName("u s del font strike"),function(m){if(m.tagName=="font"){var h=[];for(var n in m.attrs)switch(n){case "size":h.push("font-size:"+({"1":"10","2":"12","3":"16","4":"18",
"5":"24","6":"32","7":"48"}[m.attrs[n]]||m.attrs[n])+"px");break;case "color":h.push("color:"+m.attrs[n]);break;case "face":h.push("font-family:"+m.attrs[n]);break;case "style":h.push(m.attrs[n])}m.attrs={style:h.join(";")}}else{h=m.tagName=="u"?"underline":"line-through";m.attrs={style:(m.getAttr("style")||"")+"text-decoration:"+h+";"}}m.tagName="span"})});for(var f in a)(function(d,m){UE.commands[d]={execCommand:function(h,n){n=n||(this.queryCommandState(h)?"none":h=="underline"?"underline":h==
"fontborder"?"1px solid #000":"line-through");var q=this,o=this.selection.getRange(),p;if(n=="default"){if(o.collapsed){p=q.document.createTextNode("font");o.insertNode(p).select()}q.execCommand("removeFormat","span,a",m);if(p){o.setStartBefore(p).collapse(true);l.remove(p)}c(o,h,n);o.select()}else if(o.collapsed){var r=l.findParentByTagName(o.startContainer,"span",true);p=q.document.createTextNode("font");if(r&&!r.children.length&&!r[y.ie?"innerText":"textContent"].replace(pa,"").length){o.insertNode(p);
if(e[d]){o.selectNode(p).select();q.execCommand("removeFormat","span,a",m,null);r=l.findParentByTagName(p,"span",true);o.setStartBefore(p)}r&&(r.style.cssText+=";"+m+":"+n);o.collapse(true).select()}else{o.insertNode(p);o.selectNode(p).select();r=o.document.createElement("span");if(e[d]){if(l.findParentByTagName(p,"a",true)){o.setStartBefore(p).setCursor();l.remove(p);return}q.execCommand("removeFormat","span,a",m)}r.style.cssText=m+":"+n;p.parentNode.insertBefore(r,p);if(!y.ie||y.ie&&y.version==
9)for(q=r.parentNode;!l.isBlockElm(q);){if(q.tagName=="SPAN")r.style.cssText=q.style.cssText+";"+r.style.cssText;q=q.parentNode}if(Pa)setTimeout(function(){o.setStart(r,0).collapse(true);c(o,h,n);o.select()});else{o.setStart(r,0).collapse(true);c(o,h,n);o.select()}}l.remove(p)}else{e[d]&&q.queryCommandValue(d)&&q.execCommand("removeFormat","span,a",m);o=q.selection.getRange();o.applyInlineStyle("span",{style:m+":"+n});c(o,h,n);o.select()}return true},queryCommandValue:function(h){var n=this.selection.getStart();
if(h=="underline"||h=="strikethrough"){for(h=n;h&&!l.isBlockElm(h)&&!l.isBody(h);){if(h.nodeType==1){n=l.getComputedStyle(h,m);if(n!="none")return n}h=h.parentNode}return"none"}if(h=="fontborder"){for(h=n;h&&K.$inline[h.tagName];){if(n=l.getComputedStyle(h,"border"))if(/1px/.test(n)&&/solid/.test(n))return n;h=h.parentNode}return""}if(h=="FontSize"){n=l.getComputedStyle(n,m);if(h=/^([\d\.]+)(\w+)$/.exec(n))return Math.floor(h[1])+h[2];return n}return l.getComputedStyle(n,m)},queryCommandState:function(h){if(!e[h])return 0;
var n=this.queryCommandValue(h);return h=="fontborder"?/1px/.test(n)&&/solid/.test(n):h=="underline"?/underline/.test(n):/line\-through/.test(n)}}})(f,a[f])};UE.plugins.link=function(){function j(c){var b=c.startContainer,a=c.endContainer;if(b=l.findParentByTagName(b,"a",true))c.setStartBefore(b);if(a=l.findParentByTagName(a,"a",true))c.setEndAfter(a)}function g(c,b,a){var e=c.cloneRange(),k=a.queryCommandValue("link");j(c=c.adjustmentBoundary());a=c.startContainer;if(a.nodeType==1&&k)if((a=a.childNodes[c.startOffset])&&
a.nodeType==1&&a.tagName=="A"&&/^(?:https?|ftp|file)\s*:\s*\/\//.test(a[y.ie?"innerText":"textContent"]))a[y.ie?"innerText":"textContent"]=v.html(b.textValue||b.href);if(!e.collapsed||k){c.removeInlineStyle("a");e=c.cloneRange()}if(e.collapsed){k=c.document.createElement("a");var f="";if(b.textValue){f=v.html(b.textValue);delete b.textValue}else f=v.html(b.href);l.setAttributes(k,b);(a=l.findParentByTagName(e.startContainer,"a",true))&&l.isInNodeEndBoundary(e,a)&&c.setStartAfter(a).collapse(true);
k[y.ie?"innerText":"textContent"]=f;c.insertNode(k).selectNode(k)}else c.applyInlineStyle("a",b)}UE.commands.unlink={execCommand:function(){var c=this.selection.getRange(),b;if(!(c.collapsed&&!l.findParentByTagName(c.startContainer,"a",true))){b=c.createBookmark();j(c);c.removeInlineStyle("a").moveToBookmark(b).select()}},queryCommandState:function(){return!this.highlight&&this.queryCommandValue("link")?0:-1}};UE.commands.link={execCommand:function(c,b){b._href&&(b._href=v.unhtml(b._href,/[<">]/g));
b.href&&(b.href=v.unhtml(b.href,/[<">]/g));b.textValue&&(b.textValue=v.unhtml(b.textValue,/[<">]/g));g(c=this.selection.getRange(),b,this);c.collapse().select(true)},queryCommandValue:function(){var c=this.selection.getRange(),b;if(c.collapsed){b=c.startContainer;if((b=b.nodeType==1?b:b.parentNode)&&(b=l.findParentByTagName(b,"a",true))&&!l.isInNodeEndBoundary(c,b))return b}else{c.shrinkBoundary();var a=c.startContainer.nodeType==3||!c.startContainer.childNodes[c.startOffset]?c.startContainer:c.startContainer.childNodes[c.startOffset],
e=c.endContainer.nodeType==3||c.endOffset==0?c.endContainer:c.endContainer.childNodes[c.endOffset-1];c=c.getCommonAncestor();b=l.findParentByTagName(c,"a",true);if(!b&&c.nodeType==1){c=c.getElementsByTagName("a");for(var k,f,d=0,m;m=c[d++];){k=l.getPosition(m,a);f=l.getPosition(m,e);if((k&l.POSITION_FOLLOWING||k&l.POSITION_CONTAINS)&&(f&l.POSITION_PRECEDING||f&l.POSITION_CONTAINS)){b=m;break}}}return b}},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();return c&&(c.className==
"edui-faked-video"||c.className.indexOf("edui-upload-video")!=-1)?-1:0}}};UE.plugins.insertframe=function(){function j(){g._iframe&&delete g._iframe}var g=this;g.addListener("selectionchange",function(){j()})};UE.commands.scrawl={queryCommandState:function(){return y.ie&&y.version<=8?-1:0}};UE.plugins.removeformat=function(){var j=this;j.setOpt({removeFormatTags:"b,big,code,del,dfn,em,font,i,ins,kbd,q,samp,small,span,strike,strong,sub,sup,tt,u,var",removeFormatAttributes:"class,style,lang,width,height,align,hspace,valign"});
j.commands.removeformat={execCommand:function(g,c,b,a,e){function k(o){if(o.nodeType==3||o.tagName.toLowerCase()!="span")return 0;if(y.ie){var p=o.attributes;if(p.length){o=0;for(var r=p.length;o<r;o++)if(p[o].specified)return 0;return 1}}return!o.attributes.length}function f(o){var p=o.createBookmark();o.collapsed&&o.enlarge(true);if(!e){var r=l.findParentByTagName(o.startContainer,"a",true);r&&o.setStartBefore(r);(r=l.findParentByTagName(o.endContainer,"a",true))&&o.setEndAfter(r)}h=o.createBookmark();
for(r=h.start;(n=r.parentNode)&&!l.isBlockElm(n);){l.breakParent(r,n);l.clearEmptySibling(r)}if(h.end){for(r=h.end;(n=r.parentNode)&&!l.isBlockElm(n);){l.breakParent(r,n);l.clearEmptySibling(r)}r=l.getNextDomNode(h.start,false,q);for(var s;r;){if(r==h.end)break;s=l.getNextDomNode(r,true,q);if(!K.$empty[r.tagName.toLowerCase()]&&!l.isBookmarkNode(r))if(d.test(r.tagName))if(b){l.removeStyle(r,b);k(r)&&b!="text-decoration"&&l.remove(r,true)}else l.remove(r,true);else if(!K.$tableContent[r.tagName]&&
!K.$list[r.tagName]){l.removeAttributes(r,m);k(r)&&l.remove(r,true)}r=s}}r=h.start.parentNode;l.isBlockElm(r)&&!K.$tableContent[r.tagName]&&!K.$list[r.tagName]&&l.removeAttributes(r,m);r=h.end.parentNode;h.end&&l.isBlockElm(r)&&!K.$tableContent[r.tagName]&&!K.$list[r.tagName]&&l.removeAttributes(r,m);o.moveToBookmark(h).moveToBookmark(p);r=o.startContainer;for(s=o.collapsed;r.nodeType==1&&l.isEmptyNode(r)&&K.$removeEmpty[r.tagName];){p=r.parentNode;o.setStartBefore(r);o.startContainer===o.endContainer&&
o.endOffset--;l.remove(r);r=p}if(!s)for(r=o.endContainer;r.nodeType==1&&l.isEmptyNode(r)&&K.$removeEmpty[r.tagName];){p=r.parentNode;o.setEndBefore(r);l.remove(r);r=p}}var d=new RegExp("^(?:"+(c||this.options.removeFormatTags).replace(/,/g,"|")+")$","i"),m=b?[]:(a||this.options.removeFormatAttributes).split(",");g=new ea.Range(this.document);var h,n,q=function(o){return o.nodeType==1};g=this.selection.getRange();f(g);g.select()}}};UE.plugins.blockquote=function(){function j(g){return l.filterNodeList(g.selection.getStartElementPath(),
"blockquote")}this.commands.blockquote={execCommand:function(g,c){g=this.selection.getRange();var b=j(this),a=K.blockquote,e=g.createBookmark();if(b){c=g.startContainer;c=l.isBlockElm(c)?c:l.findParent(c,function(m){return l.isBlockElm(m)});a=g.endContainer;a=l.isBlockElm(a)?a:l.findParent(a,function(m){return l.isBlockElm(m)});c=l.findParentByTagName(c,"li",true)||c;a=l.findParentByTagName(a,"li",true)||a;c.tagName=="LI"||c.tagName=="TD"||c===b||l.isBody(c)?l.remove(b,true):l.breakParent(c,b);if(c!==
a)if(b=l.findParentByTagName(a,"blockquote"))if(a.tagName=="LI"||a.tagName=="TD"||l.isBody(a))b.parentNode&&l.remove(b,true);else l.breakParent(a,b);var k=l.getElementsByTagName(this.document,"blockquote");b=0;for(var f;f=k[b++];)if(f.childNodes.length)l.getPosition(f,c)&l.POSITION_FOLLOWING&&l.getPosition(f,a)&l.POSITION_PRECEDING&&l.remove(f,true);else l.remove(f)}else{b=g.cloneRange();f=k=b.startContainer.nodeType==1?b.startContainer:b.startContainer.parentNode;for(var d=1;;){if(l.isBody(k)){if(f!==
k)if(g.collapsed){b.selectNode(f);d=0}else b.setStartBefore(f);else b.setStart(k,0);break}if(!a[k.tagName]){g.collapsed?b.selectNode(f):b.setStartBefore(f);break}f=k;k=k.parentNode}if(d)for(f=k=k=b.endContainer.nodeType==1?b.endContainer:b.endContainer.parentNode;;){if(l.isBody(k)){f!==k?b.setEndAfter(f):b.setEnd(k,k.childNodes.length);break}if(!a[k.tagName]){b.setEndAfter(f);break}f=k;k=k.parentNode}k=g.document.createElement("blockquote");l.setAttributes(k,c);k.appendChild(b.extractContents());
b.insertNode(k);c=l.getElementsByTagName(k,"blockquote");for(b=0;a=c[b++];)a.parentNode&&l.remove(a,true)}g.moveToBookmark(e).select()},queryCommandState:function(){return j(this)?1:0}}};UE.commands.touppercase=UE.commands.tolowercase={execCommand:function(j){var g=this.selection.getRange();if(g.collapsed)return g;for(var c=g.createBookmark(),b=c.end,a=function(k){return!l.isBr(k)&&!l.isWhitespace(k)},e=l.getNextDomNode(c.start,false,a);e&&l.getPosition(e,b)&l.POSITION_PRECEDING;){if(e.nodeType==
3)e.nodeValue=e.nodeValue[j=="touppercase"?"toUpperCase":"toLowerCase"]();e=l.getNextDomNode(e,true,a);if(e===b)break}g.moveToBookmark(c).select()}};UE.commands.indent={execCommand:function(){var j=this,g=j.queryCommandState("indent")?"0em":j.options.indentValue||"2em";j.execCommand("Paragraph","p",{style:"text-indent:"+g})},queryCommandState:function(){var j=l.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return j&&j.style.textIndent&&parseInt(j.style.textIndent)?1:0}};
UE.commands.print={execCommand:function(){this.window.print()},notNeedUndo:1};UE.commands.preview={execCommand:function(){var j=window.open("","_blank","").document;j.open();j.write('<!DOCTYPE html><html><head><meta charset="utf-8"/><script src="'+this.options.UEDITOR_HOME_URL+"ueditor.parse.js\"><\/script><script>setTimeout(function(){uParse('div',{rootPath: '"+this.options.UEDITOR_HOME_URL+"'})},300)<\/script></head><body><div>"+this.getContent(null,null,true)+"</div></body></html>");j.close()},
notNeedUndo:1};UE.plugins.selectall=function(){var j=this;j.commands.selectall={execCommand:function(){var g=this,c=g.body;g=g.selection.getRange();g.selectNodeContents(c);if(l.isEmptyBlock(c)){y.opera&&c.firstChild&&c.firstChild.nodeType==1&&g.setStartAtFirst(c.firstChild);g.collapse(true)}g.select(true)},notNeedUndo:1};j.addshortcutkey({selectAll:"ctrl+65"})};UE.plugins.paragraph=function(){var j=this,g=l.isBlockElm,c=["TD","LI","PRE"],b=function(a,e,k,f){var d=a.createBookmark(),m=function(r){return r.nodeType==
1?r.tagName.toLowerCase()!="br"&&!l.isBookmarkNode(r):!l.isWhitespace(r)},h;a.enlarge(true);var n=a.createBookmark();h=l.getNextDomNode(n.start,false,m);for(var q=a.cloneRange(),o;h&&!(l.getPosition(h,n.end)&l.POSITION_FOLLOWING);)if(h.nodeType==3||!g(h)){for(q.setStartBefore(h);h&&h!==n.end&&!g(h);){o=h;h=l.getNextDomNode(h,false,null,function(r){return!g(r)})}q.setEndAfter(o);h=a.document.createElement(e);if(k){l.setAttributes(h,k);if(f&&f=="customstyle"&&k.style)h.style.cssText=k.style}h.appendChild(q.extractContents());
l.isEmptyNode(h)&&l.fillChar(a.document,h);q.insertNode(h);var p=h.parentNode;if(g(p)&&!l.isBody(h.parentNode)&&v.indexOf(c,p.tagName)==-1){if(!(f&&f=="customstyle")){p.getAttribute("dir")&&h.setAttribute("dir",p.getAttribute("dir"));p.style.cssText&&(h.style.cssText=p.style.cssText+";"+h.style.cssText);p.style.textAlign&&!h.style.textAlign&&(h.style.textAlign=p.style.textAlign);p.style.textIndent&&!h.style.textIndent&&(h.style.textIndent=p.style.textIndent);p.style.padding&&!h.style.padding&&(h.style.padding=
p.style.padding)}if(k&&/h\d/i.test(p.tagName)&&!/h\d/i.test(h.tagName)){l.setAttributes(p,k);if(f&&f=="customstyle"&&k.style)p.style.cssText=k.style;l.remove(h,true);h=p}else l.remove(h.parentNode,true)}h=v.indexOf(c,p.tagName)!=-1?p:h;h=l.getNextDomNode(h,false,m)}else h=l.getNextDomNode(h,true,m);return a.moveToBookmark(n).moveToBookmark(d)};j.setOpt("paragraph",{p:"",h1:"",h2:"",h3:"",h4:"",h5:"",h6:""});j.commands.paragraph={execCommand:function(a,e,k,f){a=this.selection.getRange();if(a.collapsed){var d=
this.document.createTextNode("p");a.insertNode(d);if(y.ie){var m=d.previousSibling;m&&l.isWhitespace(m)&&l.remove(m);(m=d.nextSibling)&&l.isWhitespace(m)&&l.remove(m)}}a=b(a,e,k,f);if(d){a.setStartBefore(d).collapse(true);pN=d.parentNode;l.remove(d);l.isBlockElm(pN)&&l.isEmptyNode(pN)&&l.fillNode(this.document,pN)}if(y.gecko&&a.collapsed&&a.startContainer.nodeType==1)(k=a.startContainer.childNodes[a.startOffset])&&k.nodeType==1&&k.tagName.toLowerCase()==e&&a.setStart(k,0).collapse(true);a.select();
return true},queryCommandValue:function(){var a=l.filterNodeList(this.selection.getStartElementPath(),"p h1 h2 h3 h4 h5 h6");return a?a.tagName.toLowerCase():""}}};(function(){var j=l.isBlockElm,g=function(b){return l.filterNodeList(b.selection.getStartElementPath(),function(a){return a&&a.nodeType==1&&a.getAttribute("dir")})},c=function(b,a,e){var k=function(q){return q.nodeType==1?!l.isBookmarkNode(q):!l.isWhitespace(q)};if((a=g(a))&&b.collapsed){a.setAttribute("dir",e);return b}a=b.createBookmark();
b.enlarge(true);for(var f=b.createBookmark(),d=l.getNextDomNode(f.start,false,k),m=b.cloneRange(),h;d&&!(l.getPosition(d,f.end)&l.POSITION_FOLLOWING);)if(d.nodeType==3||!j(d)){for(m.setStartBefore(d);d&&d!==f.end&&!j(d);){h=d;d=l.getNextDomNode(d,false,null,function(q){return!j(q)})}m.setEndAfter(h);d=m.getCommonAncestor();if(!l.isBody(d)&&j(d)){d.setAttribute("dir",e);d=d}else{d=b.document.createElement("p");d.setAttribute("dir",e);var n=m.extractContents();d.appendChild(n);m.insertNode(d);d=d}d=
l.getNextDomNode(d,false,k)}else d=l.getNextDomNode(d,true,k);return b.moveToBookmark(f).moveToBookmark(a)};UE.commands.directionality={execCommand:function(b,a){b=this.selection.getRange();if(b.collapsed){var e=this.document.createTextNode("d");b.insertNode(e)}c(b,this,a);if(e){b.setStartBefore(e).collapse(true);l.remove(e)}b.select();return true},queryCommandValue:function(){var b=g(this);return b?b.getAttribute("dir"):"ltr"}}})();UE.plugins.horizontal=function(){var j=this;j.commands.horizontal=
{execCommand:function(g){var c=this;if(c.queryCommandState(g)!==-1){c.execCommand("insertHtml","<hr>");g=c.selection.getRange();var b=g.startContainer;if(b.nodeType==1&&!b.childNodes[g.startOffset])if(b=b.childNodes[g.startOffset-1])if(b.nodeType==1&&b.tagName=="HR")if(c.options.enterTag=="p"){b=c.document.createElement("p");g.insertNode(b);g.setStart(b,0).setCursor()}else{b=c.document.createElement("br");g.insertNode(b);g.setStartBefore(b).setCursor()}return true}},queryCommandState:function(){return l.filterNodeList(this.selection.getStartElementPath(),
"table")?-1:0}};j.addListener("delkeydown",function(g,c){g=this.selection.getRange();g.txtToElmBoundary(true);if(l.isStartInblock(g)){var b=g.startContainer.previousSibling;if(b&&l.isTagNode(b,"hr")){l.remove(b);g.select();l.preventDefault(c);return true}}})};UE.commands.time=UE.commands.date={execCommand:function(j,g){function c(e,k){var f=("0"+e.getHours()).slice(-2),d=("0"+e.getMinutes()).slice(-2);e=("0"+e.getSeconds()).slice(-2);k=k||"hh:ii:ss";return k.replace(/hh/ig,f).replace(/ii/ig,d).replace(/ss/ig,
e)}function b(e,k){var f=("000"+e.getFullYear()).slice(-4),d=f.slice(-2),m=("0"+(e.getMonth()+1)).slice(-2);e=("0"+e.getDate()).slice(-2);k=k||"yyyy-mm-dd";return k.replace(/yyyy/ig,f).replace(/yy/ig,d).replace(/mm/ig,m).replace(/dd/ig,e)}var a=new Date;this.execCommand("insertHtml",j=="time"?c(a,g):b(a,g))}};UE.plugins.rowspacing=function(){var j=this;j.setOpt({rowspacingtop:["5","10","15","20","25"],rowspacingbottom:["5","10","15","20","25"]});j.commands.rowspacing={execCommand:function(g,c,b){this.execCommand("paragraph",
"p",{style:"margin-"+b+":"+c+"px"});return true},queryCommandValue:function(g,c){if(g=l.filterNodeList(this.selection.getStartElementPath(),function(b){return l.isBlockElm(b)})){c=l.getComputedStyle(g,"margin-"+c).replace(/[^\d]/g,"");return!c?0:c}return 0}}};UE.plugins.lineheight=function(){var j=this;j.setOpt({lineheight:["1","1.5","1.75","2","3","4","5"]});j.commands.lineheight={execCommand:function(g,c){this.execCommand("paragraph","p",{style:"line-height:"+(c=="1"?"normal":c+"em")});return true},
queryCommandValue:function(){var g=l.filterNodeList(this.selection.getStartElementPath(),function(c){return l.isBlockElm(c)});if(g){g=l.getComputedStyle(g,"line-height");return g=="normal"?1:g.replace(/[^\d.]*/ig,"")}}}};UE.plugins.insertcode=function(){var j=this;j.ready(function(){v.cssRule("pre","pre{margin:.5em 0;padding:.4em .6em;border-radius:8px;background:#f8f8f8;}",j.document)});j.setOpt("insertcode",{as3:"ActionScript3",bash:"Bash/Shell",cpp:"C/C++",css:"Css",cf:"CodeFunction","c#":"C#",
delphi:"Delphi",diff:"Diff",erlang:"Erlang",groovy:"Groovy",html:"Html",java:"Java",jfx:"JavaFx",js:"Javascript",pl:"Perl",php:"Php",plain:"Plain Text",ps:"PowerShell",python:"Python",ruby:"Ruby",scala:"Scala",sql:"Sql",vb:"Vb",xml:"Xml"});j.commands.insertcode={execCommand:function(g,c){g=this;var b=g.selection.getRange(),a=l.findParentByTagName(b.startContainer,"pre",true);if(a)a.className="brush:"+c+";toolbar:false;";else{var e="";if(b.collapsed)e=y.ie&&y.ie11below?y.version<=8?"&nbsp;":"":"<br/>";
else{a=b.extractContents();b=g.document.createElement("div");b.appendChild(a);v.each(UE.filterNode(UE.htmlparser(b.innerHTML.replace(/[\r\t]/g,"")),g.options.filterTxtRules).children,function(k){if(y.ie&&y.ie11below&&y.version>8){if(k.type=="element")if(k.tagName=="br")e+="\n";else{if(!K.$empty[k.tagName]){v.each(k.children,function(f){if(f.type=="element")if(f.tagName=="br")e+="\n";else K.$empty[k.tagName]||(e+=f.innerText());else e+=f.data});/\n$/.test(e)||(e+="\n")}}else e+=k.data+"\n";if(!k.nextSibling()&&
/\n$/.test(e))e=e.replace(/\n$/,"")}else if(y.ie&&y.ie11below){if(k.type=="element")if(k.tagName=="br")e+="<br>";else{if(!K.$empty[k.tagName]){v.each(k.children,function(f){if(f.type=="element")if(f.tagName=="br")e+="<br>";else K.$empty[k.tagName]||(e+=f.innerText());else e+=f.data});/br>$/.test(e)||(e+="<br>")}}else e+=k.data+"<br>";if(!k.nextSibling()&&/<br>$/.test(e))e=e.replace(/<br>$/,"")}else{e+=k.type=="element"?K.$empty[k.tagName]?"":k.innerText():k.data;if(!/br\/?\s*>$/.test(e))if(k.nextSibling())e+=
"<br>"}})}g.execCommand("inserthtml",'<pre id="coder"class="brush:'+c+';toolbar:false">'+e+"</pre>",true);a=g.document.getElementById("coder");l.removeAttributes(a,"id");if((c=a.previousSibling)&&(c.nodeType==3&&c.nodeValue.length==1&&y.ie&&y.version==6||l.isEmptyBlock(c)))l.remove(c);b=g.selection.getRange();l.isEmptyBlock(a)?b.setStart(a,0).setCursor(false,true):b.selectNodeContents(a).select()}},queryCommandValue:function(){var g=this.selection.getStartElementPath(),c="";v.each(g,function(b){if(b.nodeName==
"PRE"){c=(b=b.className.match(/brush:([^;]+)/))&&b[1]?b[1]:"";return false}});return c}};j.addInputRule(function(g){v.each(g.getNodesByTagName("pre"),function(c){var b=c.getNodesByTagName("br");if(b.length)y.ie&&y.ie11below&&y.version>8&&v.each(b,function(a){var e=UE.uNode.createText("\n");a.parentNode.insertBefore(e,a);a.parentNode.removeChild(a)});else if(!(y.ie&&y.ie11below&&y.version>8)){b=c.innerText().split(/\n/);c.innerHTML("");v.each(b,function(a){a.length&&c.appendChild(UE.uNode.createText(a));
c.appendChild(UE.uNode.createElement("br"))})}})});j.addOutputRule(function(g){v.each(g.getNodesByTagName("pre"),function(c){var b="";v.each(c.children,function(a){b+=a.type=="text"?a.data.replace(/[ ]/g,"&nbsp;").replace(/\n$/,""):a.tagName=="br"?"\n":!K.$empty[a.tagName]?"":a.innerText()});c.innerText(b.replace(/(&nbsp;|\n)+$/,""))})});j.notNeedCodeQuery={help:1,undo:1,redo:1,source:1,print:1,searchreplace:1,fullscreen:1,preview:1,insertparagraph:1,elementpath:1,insertcode:1,inserthtml:1,selectall:1};
j.queryCommandState=function(g){var c=this;if(!c.notNeedCodeQuery[g.toLowerCase()]&&c.selection&&c.queryCommandValue("insertcode"))return-1;return UE.Editor.prototype.queryCommandState.apply(this,arguments)};j.addListener("beforeenterkeydown",function(){var g=j.selection.getRange(),c=l.findParentByTagName(g.startContainer,"pre",true);if(c){j.fireEvent("saveScene");g.collapsed||g.deleteContents();if(!y.ie||y.ie9above){c=j.document.createElement("br");g.insertNode(c).setStartAfter(c).collapse(true);
!c.nextSibling&&(!y.ie||y.version>10)?g.insertNode(c.cloneNode(false)):g.setStartAfter(c);c=c.previousSibling;for(var b;c;){b=c;c=c.previousSibling;if(!c||c.nodeName=="BR"){c=b;break}}if(c){for(b="";c&&c.nodeName!="BR"&&(new RegExp("^[\\s"+l.fillChar+"]*$")).test(c.nodeValue);){b+=c.nodeValue;c=c.nextSibling}if(c.nodeName!="BR")if((c=c.nodeValue.match(new RegExp("^([\\s"+l.fillChar+"]+)")))&&c[1])b+=c[1];if(b){b=j.document.createTextNode(b);g.insertNode(b).setStartAfter(b)}}g.collapse(true).select(true)}else if(y.version>
8){c=j.document.createTextNode("\n");b=g.startContainer;if(g.startOffset==0){if(b.previousSibling){g.insertNode(c);var a=j.document.createTextNode(" ");g.setStartAfter(c).insertNode(a).setStart(a,0).collapse(true).select(true)}}else{g.insertNode(c).setStartAfter(c);a=j.document.createTextNode(" ");(b=g.startContainer.childNodes[g.startOffset])&&!/^\n/.test(b.nodeValue)&&g.setStartBefore(c);g.insertNode(a).setStart(a,0).collapse(true).select(true)}}else{c=j.document.createElement("br");g.insertNode(c);
g.insertNode(j.document.createTextNode(l.fillChar));g.setStartAfter(c);for(c=c.previousSibling;c;){b=c;c=c.previousSibling;if(!c||c.nodeName=="BR"){c=b;break}}if(c){for(b="";c&&c.nodeName!="BR"&&(new RegExp("^[ "+l.fillChar+"]*$")).test(c.nodeValue);){b+=c.nodeValue;c=c.nextSibling}if(c.nodeName!="BR")if((c=c.nodeValue.match(new RegExp("^([ "+l.fillChar+"]+)")))&&c[1])b+=c[1];b=j.document.createTextNode(b);g.insertNode(b).setStartAfter(b)}g.collapse(true).select()}j.fireEvent("saveScene");return true}});
j.addListener("tabkeydown",function(g,c){g=j.selection.getRange();var b=l.findParentByTagName(g.startContainer,"pre",true);if(b){j.fireEvent("saveScene");if(!c.shiftKey)if(g.collapsed){b=j.document.createTextNode("    ");g.insertNode(b).setStartAfter(b).collapse(true).select(true)}else{c=g.createBookmark();for(var a=c.start.previousSibling;a;){if(b.firstChild===a&&!l.isBr(a)){b.insertBefore(j.document.createTextNode("    "),a);break}if(l.isBr(a)){b.insertBefore(j.document.createTextNode("    "),a.nextSibling);
break}a=a.previousSibling}var e=c.end;a=c.start.nextSibling;for(b.firstChild===c.start&&b.insertBefore(j.document.createTextNode("    "),a.nextSibling);a&&a!==e;){if(l.isBr(a)&&a.nextSibling){if(a.nextSibling===e)break;b.insertBefore(j.document.createTextNode("    "),a.nextSibling)}a=a.nextSibling}g.moveToBookmark(c).select()}j.fireEvent("saveScene");return true}});j.addListener("beforeinserthtml",function(g,c){var b=this;g=b.selection.getRange();if(l.findParentByTagName(g.startContainer,"pre",true)){g.collapsed||
g.deleteContents();var a="";if(y.ie&&y.version>8){v.each(UE.filterNode(UE.htmlparser(c),b.options.filterTxtRules).children,function(k){if(k.type=="element")if(k.tagName=="br")a+="\n";else{if(!K.$empty[k.tagName]){v.each(k.children,function(f){if(f.type=="element")if(f.tagName=="br")a+="\n";else K.$empty[k.tagName]||(a+=f.innerText());else a+=f.data});/\n$/.test(a)||(a+="\n")}}else a+=k.data+"\n";if(!k.nextSibling()&&/\n$/.test(a))a=a.replace(/\n$/,"")});c=b.document.createTextNode(v.html(a.replace(/&nbsp;/g,
" ")));g.insertNode(c).selectNode(c).select()}else{var e=b.document.createDocumentFragment();v.each(UE.filterNode(UE.htmlparser(c),b.options.filterTxtRules).children,function(k){if(k.type=="element")if(k.tagName=="br")e.appendChild(b.document.createElement("br"));else{if(!K.$empty[k.tagName]){v.each(k.children,function(f){if(f.type=="element")if(f.tagName=="br")e.appendChild(b.document.createElement("br"));else K.$empty[k.tagName]||e.appendChild(b.document.createTextNode(v.html(f.innerText().replace(/&nbsp;/g,
" "))));else e.appendChild(b.document.createTextNode(v.html(f.data.replace(/&nbsp;/g," "))))});e.lastChild.nodeName!="BR"&&e.appendChild(b.document.createElement("br"))}}else e.appendChild(b.document.createTextNode(v.html(k.data.replace(/&nbsp;/g," "))));!k.nextSibling()&&e.lastChild.nodeName=="BR"&&e.removeChild(e.lastChild)});g.insertNode(e).select()}return true}});j.addListener("keydown",function(g,c){g=this;if((c.keyCode||c.which)==40){var b=g.selection.getRange(),a,e=b.startContainer;if(b.collapsed&&
(a=l.findParentByTagName(b.startContainer,"pre",true))&&!a.nextSibling){for(var k=a.lastChild;k&&k.nodeName=="BR";)k=k.previousSibling;if(k===e||b.startContainer===a&&b.startOffset==a.childNodes.length){g.execCommand("insertparagraph");l.preventDefault(c)}}}});j.addListener("delkeydown",function(g,c){g=this.selection.getRange();g.txtToElmBoundary(true);var b=g.startContainer;if(l.isTagNode(b,"pre")&&g.collapsed&&l.isStartInblock(g)){var a=j.document.createElement("p");l.fillNode(j.document,a);b.parentNode.insertBefore(a,
b);l.remove(b);g.setStart(a,0).setCursor(false,true);l.preventDefault(c);return true}})};UE.commands.cleardoc={execCommand:function(){var j=this,g=j.options.enterTag,c=j.selection.getRange();if(g=="br"){j.body.innerHTML="<br/>";c.setStart(j.body,0).setCursor()}else{j.body.innerHTML="<p>"+(fa?"":"<br/>")+"</p>";c.setStart(j.body.firstChild,0).setCursor(false,true)}setTimeout(function(){j.fireEvent("clearDoc")},0)}};UE.plugin.register("anchor",function(){return{bindEvents:{ready:function(){v.cssRule("anchor",
".anchorclass{background: url('"+this.options.themePath+this.options.theme+"/images/anchor.gif') no-repeat scroll left center transparent;cursor: auto;display: inline-block;height: 16px;width: 15px;}",this.document)}},outputRule:function(j){v.each(j.getNodesByTagName("img"),function(g){var c;if(c=g.getAttr("anchorname")){g.tagName="a";g.setAttr({anchorname:"",name:c,"class":""})}})},inputRule:function(j){v.each(j.getNodesByTagName("a"),function(g){if(g.getAttr("name")&&!g.getAttr("href")){g.tagName=
"img";g.setAttr({anchorname:g.getAttr("name"),"class":"anchorclass"});g.setAttr("name")}})},commands:{anchor:{execCommand:function(j,g){j=this.selection.getRange();var c=j.getClosedNode();if(c&&c.getAttribute("anchorname"))if(g)c.setAttribute("anchorname",g);else{j.setStartBefore(c).setCursor();l.remove(c)}else if(g){c=this.document.createElement("img");j.collapse(true);l.setAttributes(c,{anchorname:g,"class":"anchorclass"});j.insertNode(c).setStartAfter(c).setCursor(false,true)}}}}}});UE.plugins.wordcount=
function(){var j=this;j.setOpt("wordCount",true);j.addListener("contentchange",function(){j.fireEvent("wordcount")});var g;j.addListener("ready",function(){var c=this;l.on(c.body,"keyup",function(b){if(!((b.keyCode||b.which)in{"16":1,"18":1,"20":1,"37":1,"38":1,"39":1,"40":1})){clearTimeout(g);g=setTimeout(function(){c.fireEvent("wordcount")},200)}})})};UE.plugins.pagebreak=function(){function j(a){if(l.isEmptyBlock(a)){for(var e=a.firstChild,k;e&&e.nodeType==1&&l.isEmptyBlock(e);){k=e;e=e.firstChild}!k&&
(k=a);l.fillNode(c.document,k)}}function g(a){return a&&a.nodeType==1&&a.tagName=="HR"&&a.className=="pagebreak"}var c=this,b=["td"];c.setOpt("pageBreakTag","_ueditor_page_break_tag_");c.ready(function(){v.cssRule("pagebreak",".pagebreak{display:block;clear:both !important;cursor:default !important;width: 100% !important;margin:0;}",c.document)});c.addInputRule(function(a){a.traversal(function(e){if(e.type=="text"&&e.data==c.options.pageBreakTag){var k=UE.uNode.createElement('<hr class="pagebreak" noshade="noshade" size="5" style="-webkit-user-select: none;">');
e.parentNode.insertBefore(k,e);e.parentNode.removeChild(e)}})});c.addOutputRule(function(a){v.each(a.getNodesByTagName("hr"),function(e){if(e.getAttr("class")=="pagebreak"){var k=UE.uNode.createText(c.options.pageBreakTag);e.parentNode.insertBefore(k,e);e.parentNode.removeChild(e)}})});c.commands.pagebreak={execCommand:function(){var a=c.selection.getRange(),e=c.document.createElement("hr");l.setAttributes(e,{"class":"pagebreak",noshade:"noshade",size:"5"});l.unSelectable(e);var k=l.findParentByTagName(a.startContainer,
b,true),f=[];if(k)switch(k.tagName){case "TD":k=k.parentNode;if(k.previousSibling){k.parentNode.insertBefore(e,k);f=l.findParents(e)}else{a=l.findParentByTagName(k,"table");a.parentNode.insertBefore(e,a);f=l.findParents(e,true)}k=f[1];e!==k&&l.breakParent(e,k);c.fireEvent("afteradjusttable",c.document)}else{if(!a.collapsed){a.deleteContents();for(k=a.startContainer;!l.isBody(k)&&l.isBlockElm(k)&&l.isEmptyNode(k);){a.setStartBefore(k).collapse(true);l.remove(k);k=a.startContainer}}a.insertNode(e);
for(k=e.parentNode;!l.isBody(k);){l.breakParent(e,k);(k=e.nextSibling)&&l.isEmptyBlock(k)&&l.remove(k);k=e.parentNode}k=e.nextSibling;f=e.previousSibling;if(g(f))l.remove(f);else f&&j(f);if(k){g(k)?l.remove(k):j(k);a.setEndAfter(e).collapse(false)}else{k=c.document.createElement("p");e.parentNode.appendChild(k);l.fillNode(c.document,k);a.setStart(k,0).collapse(true)}a.select(true)}}}};UE.plugin.register("wordimage",function(){var j=this,g=[];return{commands:{wordimage:{execCommand:function(){for(var c=
l.getElementsByTagName(j.body,"img"),b=[],a=0,e;e=c[a++];)(e=e.getAttribute("word_img"))&&b.push(e);return b},queryCommandState:function(){g=l.getElementsByTagName(j.body,"img");for(var c=0,b;b=g[c++];)if(b.getAttribute("word_img"))return 1;return-1},notNeedUndo:true}},inputRule:function(c){v.each(c.getNodesByTagName("img"),function(b){var a=b.attrs,e=parseInt(a.width)<128||parseInt(a.height)<43,k=j.options,f=k.UEDITOR_HOME_URL+"themes/default/images/spacer.gif";if(a.src&&/^(?:(file:\/+))/.test(a.src))b.setAttr({width:a.width,
height:a.height,alt:a.alt,word_img:a.src,src:f,style:"background:url("+(e?k.themePath+k.theme+"/images/word.gif":k.langPath+k.lang+"/images/localimage.png")+") no-repeat center center;border:1px solid #ddd"})})}}});UE.plugins.dragdrop=function(){var j=this;j.ready(function(){l.on(this.body,"dragend",function(){var g=j.selection.getRange(),c=g.getClosedNode()||j.selection.getStart();if(c&&c.tagName=="IMG"){for(var b=c.previousSibling,a;a=c.nextSibling;)if(a.nodeType==1&&a.tagName=="SPAN"&&!a.firstChild)l.remove(a);
else break;if((b&&b.nodeType==1&&!l.isEmptyBlock(b)||!b)&&(!a||a&&!l.isEmptyBlock(a))){if(b&&b.tagName=="P"&&!l.isEmptyBlock(b)){b.appendChild(c);l.moveChild(a,b);l.remove(a)}else a&&a.tagName=="P"&&!l.isEmptyBlock(a)&&a.insertBefore(c,a.firstChild);b&&b.tagName=="P"&&l.isEmptyBlock(b)&&l.remove(b);a&&a.tagName=="P"&&l.isEmptyBlock(a)&&l.remove(a);g.selectNode(c).select();j.fireEvent("saveScene")}}})});j.addListener("keyup",function(g,c){if((c.keyCode||c.which)==13){g=j.selection.getRange();if(g=
l.findParentByTagName(g.startContainer,"p",true))l.getComputedStyle(g,"text-align")=="center"&&l.removeStyle(g,"text-align")}})};UE.plugins.undo=function(){function j(r,s){if(r.length!=s.length)return 0;for(var t=0,u=r.length;t<u;t++)if(r[t]!=s[t])return 0;return 1}function g(r,s){if(r.collapsed!=s.collapsed)return 0;if(!j(r.startAddress,s.startAddress)||!j(r.endAddress,s.endAddress))return 0;return 1}function c(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=false;this.undo=function(){if(this.hasUndo)if(!this.list[this.index-
1]&&this.list.length==1)this.reset();else{for(;this.list[this.index].content==this.list[this.index-1].content;){this.index--;if(this.index==0)return this.restore(0)}this.restore(--this.index)}};this.redo=function(){if(this.hasRedo){for(;this.list[this.index].content==this.list[this.index+1].content;){this.index++;if(this.index==this.list.length-1)return this.restore(this.index)}this.restore(++this.index)}};this.restore=function(){var r=this.editor,s=this.list[this.index],t=UE.htmlparser(s.content.replace(f,
""));r.options.autoClearEmptyNode=false;r.filterInputRule(t);r.options.autoClearEmptyNode=m;r.document.body.innerHTML=t.toHtml();r.fireEvent("afterscencerestore");y.ie&&v.each(l.getElementsByTagName(r.document,"td th caption p"),function(D){l.isEmptyNode(D)&&l.fillNode(r.document,D)});try{var u=(new ea.Range(r.document)).moveToAddress(s.address);u.select(d[u.startContainer.nodeName.toLowerCase()])}catch(w){}this.update();this.clearKey();r.fireEvent("reset",true)};this.getScene=function(){var r=this.editor,
s=r.selection.getRange().createAddress(false,true);r.fireEvent("beforegetscene");var t=UE.htmlparser(r.body.innerHTML);r.options.autoClearEmptyNode=false;r.filterOutputRule(t);r.options.autoClearEmptyNode=m;t=t.toHtml();r.fireEvent("aftergetscene");return{address:s,content:t}};this.save=function(r,s){clearTimeout(b);s=this.getScene(s);var t=this.list[this.index];t&&t.content!=s.content&&a.trigger("contentchange");if(!(t&&t.content==s.content&&(r?1:g(t.address,s.address)))){this.list=this.list.slice(0,
this.index+1);this.list.push(s);this.list.length>e&&this.list.shift();this.index=this.list.length-1;this.clearKey();this.update()}};this.update=function(){this.hasRedo=!!this.list[this.index+1];this.hasUndo=!!this.list[this.index-1]};this.reset=function(){this.list=[];this.index=0;this.hasRedo=this.hasUndo=false;this.clearKey()};this.clearKey=function(){n=0;q=null}}var b,a=this,e=a.options.maxUndoCount||20,k=a.options.maxInputCount||20,f=new RegExp(l.fillChar+"|</hr>","gi"),d={ol:1,ul:1,table:1,tbody:1,
tr:1,body:1},m=a.options.autoClearEmptyNode;a.undoManger=new c;a.undoManger.editor=a;a.addListener("saveScene",function(){this.undoManger.save.apply(this.undoManger,Array.prototype.splice.call(arguments,1))});a.addListener("reset",function(r,s){s||this.undoManger.reset()});a.commands.redo=a.commands.undo={execCommand:function(r){this.undoManger[r]()},queryCommandState:function(r){return this.undoManger["has"+(r.toLowerCase()=="undo"?"Undo":"Redo")]?0:-1},notNeedUndo:1};var h={16:1,17:1,18:1,37:1,
38:1,39:1,40:1},n=0,q,o=false;a.addListener("ready",function(){l.on(this.body,"compositionstart",function(){o=true});l.on(this.body,"compositionend",function(){o=false})});a.addshortcutkey({Undo:"ctrl+90",Redo:"ctrl+89"});var p=true;a.addListener("keydown",function(r,s){var t=this;r=s.keyCode||s.which;if(!h[r]&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey)if(!o){function u(w){w.undoManger.save(false,true);w.fireEvent("selectionchange")}if(t.selection.getRange().collapsed){t.undoManger.list.length==
0&&t.undoManger.save(true);clearTimeout(b);b=setTimeout(function(){if(o)var w=setInterval(function(){if(!o){u(t);clearInterval(w)}},300);else u(t)},200);q=r;n++;n>=k&&u(t)}else{t.undoManger.save(false,true);p=false}}});a.addListener("keyup",function(r,s){if(!h[s.keyCode||s.which]&&!s.ctrlKey&&!s.metaKey&&!s.shiftKey&&!s.altKey)if(!o)if(!p){this.undoManger.save(false,true);p=true}});a.stopCmdUndo=function(){a.__hasEnterExecCommand=true};a.startCmdUndo=function(){a.__hasEnterExecCommand=false}};UE.plugin.register("copy",
function(){function j(){ZeroClipboard.config({debug:false,swfPath:g.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.swf"});var c=g.zeroclipboard=new ZeroClipboard;c.on("copy",function(b){b=b.client;var a=g.selection.getRange(),e=document.createElement("div");e.appendChild(a.cloneContents());b.setText(e.innerText||e.textContent);b.setHtml(e.innerHTML);a.select()});c.on("mouseover mouseout",function(b){var a=b.target;if(b.type=="mouseover")l.addClass(a,"edui-state-hover");else b.type==
"mouseout"&&l.removeClasses(a,"edui-state-hover")});c.on("wrongflash noflash",function(){ZeroClipboard.destroy()})}var g=this;return{bindEvents:{ready:function(){y.ie||(window.ZeroClipboard?j():v.loadFile(document,{src:g.options.UEDITOR_HOME_URL+"third-party/zeroclipboard/ZeroClipboard.js",tag:"script",type:"text/javascript",defer:"defer"},function(){j()}))}},commands:{copy:{execCommand:function(){g.document.execCommand("copy")||alert(g.getLang("copymsg"))}}}}});UE.plugins.paste=function(){function j(f){var d=
this.document;if(!d.getElementById("baidu_pastebin")){var m=this.selection.getRange(),h=m.createBookmark(),n=d.createElement("div");n.id="baidu_pastebin";y.webkit&&n.appendChild(d.createTextNode(l.fillChar+l.fillChar));d.body.appendChild(n);h.start.style.display="";n.style.cssText="position:absolute;width:1px;height:1px;overflow:hidden;left:-1000px;white-space:nowrap;top:"+l.getXY(h.start).y+"px";m.selectNodeContents(n).select(true);setTimeout(function(){if(y.webkit)for(var q=0,o=d.querySelectorAll("#baidu_pastebin"),
p;p=o[q++];)if(l.isEmptyNode(p))l.remove(p);else{n=p;break}try{n.parentNode.removeChild(n)}catch(r){}m.moveToBookmark(h).select(true);f(n)},0)}}function g(f){return f.replace(/<(\/?)([\w\-]+)([^>]*)>/gi,function(d,m,h,n){h=h.toLowerCase();if({img:1}[h])return d;n=n.replace(/([\w\-]*?)\s*=\s*(("([^"]*)")|('([^']*)')|([^\s>]+))/gi,function(q,o,p){if({src:1,href:1,name:1}[o.toLowerCase()])return o+"="+p+" ";return""});return{span:1,div:1}[h]?"":"<"+m+h+" "+v.trim(n)+">"})}function c(f){var d;if(f.firstChild){var m=
l.getElementsByTagName(f,"span");d=0;for(var h;h=m[d++];)if(h.id=="_baidu_cut_start"||h.id=="_baidu_cut_end")l.remove(h);if(y.webkit){h=f.querySelectorAll("div br");for(d=0;m=h[d++];){m=m.parentNode;if(m.tagName=="DIV"&&m.childNodes.length==1){m.innerHTML="<p><br/></p>";l.remove(m)}}m=f.querySelectorAll("#baidu_pastebin");for(d=0;h=m[d++];){var n=b.document.createElement("p");for(h.parentNode.insertBefore(n,h);h.firstChild;)n.appendChild(h.firstChild);l.remove(h)}h=f.querySelectorAll("meta");for(d=
0;m=h[d++];)l.remove(m);h=f.querySelectorAll("br");for(d=0;m=h[d++];)/^apple-/i.test(m.className)&&l.remove(m)}if(y.gecko){h=f.querySelectorAll("[_moz_dirty]");for(d=0;m=h[d++];)m.removeAttribute("_moz_dirty")}if(!y.ie){h=f.querySelectorAll("span.Apple-style-span");for(d=0;m=h[d++];)l.remove(m,true)}d=f.innerHTML;d=UE.filterWord(d);f=UE.htmlparser(d);b.options.filterRules&&UE.filterNode(f,b.options.filterRules);b.filterInputRule(f);if(y.webkit){(d=f.lastChild())&&d.type=="element"&&d.tagName=="br"&&
f.removeChild(d);v.each(b.body.querySelectorAll("div"),function(q){l.isEmptyBlock(q)&&l.remove(q,true)})}d={html:f.toHtml()};b.fireEvent("beforepaste",d,f);if(d.html){f=UE.htmlparser(d.html,true);if(b.queryCommandState("pasteplain")===1)b.execCommand("insertHtml",UE.filterNode(f,b.options.filterTxtRules).toHtml(),true);else{UE.filterNode(f,b.options.filterTxtRules);a=f.toHtml();e=d.html;k=b.selection.getRange().createAddress(true);b.execCommand("insertHtml",b.getOpt("retainOnlyLabelPasted")===true?
g(e):e,true)}b.fireEvent("afterpaste",d)}}}var b=this;b.setOpt({retainOnlyLabelPasted:false});var a,e,k;b.addListener("pasteTransfer",function(f,d){if(k&&a&&e&&a!=e){f=b.selection.getRange();f.moveToAddress(k,true);if(!f.collapsed){for(;!l.isBody(f.startContainer);){var m=f.startContainer;if(m.nodeType==1){m=m.childNodes[f.startOffset];if(!m){f.setStartBefore(f.startContainer);continue}(m=m.previousSibling)&&m.nodeType==3&&(new RegExp("^[\n\r\t "+l.fillChar+"]*$")).test(m.nodeValue)&&f.setStartBefore(m)}if(f.startOffset==
0)f.setStartBefore(f.startContainer);else break}for(;!l.isBody(f.endContainer);){m=f.endContainer;if(m.nodeType==1){m=m.childNodes[f.endOffset];if(!m){f.setEndAfter(f.endContainer);continue}(m=m.nextSibling)&&m.nodeType==3&&(new RegExp("^[\n\r\t"+l.fillChar+"]*$")).test(m.nodeValue)&&f.setEndAfter(m)}if(f.endOffset==f.endContainer[f.endContainer.nodeType==3?"nodeValue":"childNodes"].length)f.setEndAfter(f.endContainer);else break}}f.deleteContents();f.select(true);b.__hasEnterExecCommand=true;f=e;
if(d===2)f=g(f);else if(d)f=a;b.execCommand("inserthtml",f,true);b.__hasEnterExecCommand=false;for(d=b.selection.getRange();!l.isBody(d.startContainer)&&!d.startOffset&&d.startContainer[d.startContainer.nodeType==3?"nodeValue":"childNodes"].length;)d.setStartBefore(d.startContainer);d=d.createAddress(true);k.endAddress=d.startAddress}});b.addListener("ready",function(){l.on(b.body,"cut",function(){!b.selection.getRange().collapsed&&b.undoManger&&b.undoManger.save()});l.on(b.body,y.ie||y.opera?"keydown":
"paste",function(f){(y.ie||y.opera)&&(!f.ctrlKey&&!f.metaKey||f.keyCode!="86")||j.call(b,function(d){c(d)})})});b.commands.paste={execCommand:function(){if(y.ie){j.call(b,function(f){c(f)});b.document.execCommand("paste")}else alert(b.getLang("pastemsg"))}}};UE.plugins.pasteplain=function(){var j=this;j.setOpt({pasteplain:false,filterTxtRules:function(){function c(a){a.tagName="p";a.setStyle()}function b(a){a.parentNode.removeChild(a,true)}return{"-":"script style object iframe embed input select",
p:{$:{}},br:{$:{}},div:function(a){for(var e,k=UE.uNode.createElement("p");e=a.firstChild();)if(e.type=="text"||!UE.dom.dtd.$block[e.tagName])k.appendChild(e);else if(k.firstChild()){a.parentNode.insertBefore(k,a);k=UE.uNode.createElement("p")}else a.parentNode.insertBefore(e,a);k.firstChild()&&a.parentNode.insertBefore(k,a);a.parentNode.removeChild(a)},ol:b,ul:b,dl:b,dt:b,dd:b,li:b,caption:c,th:c,tr:c,h1:c,h2:c,h3:c,h4:c,h5:c,h6:c,td:function(a){a.innerText()&&a.parentNode.insertAfter(UE.uNode.createText(" &nbsp; &nbsp;"),
a);a.parentNode.removeChild(a,a.innerText())}}}()});var g=j.options.pasteplain;j.commands.pasteplain={queryCommandState:function(){return g?1:0},execCommand:function(){g=!g|0},notNeedUndo:1}};UE.plugins.list=function(){function j(o){var p=[];for(var r in o)p.push(r);return p}function g(o){var p=o.className;if(l.hasClass(o,/custom_/))return p.match(/custom_(\w+)/)[1];return l.getStyle(o,"list-style-type")}function c(o,p){v.each(l.getElementsByTagName(o,"ol ul"),function(r){if(l.inDoc(r,o)){var s=r.parentNode;
if(s.tagName==r.tagName){var t=g(r)||(r.tagName=="OL"?"decimal":"disc"),u=g(s)||(s.tagName=="OL"?"decimal":"disc");if(t==u){t=v.indexOf(h[r.tagName],t);t=t+1==h[r.tagName].length?0:t+1;a(r,h[r.tagName][t])}}var w=0;t=2;if(l.hasClass(r,/custom_/))/[ou]l/i.test(s.tagName)&&l.hasClass(s,/custom_/)||(t=1);else if(/[ou]l/i.test(s.tagName)&&l.hasClass(s,/custom_/))t=3;(s=l.getStyle(r,"list-style-type"))&&(r.style.cssText="list-style-type:"+s);r.className=v.trim(r.className.replace(/list-paddingleft-\w+/,
""))+" list-paddingleft-"+t;v.each(l.getElementsByTagName(r,"li"),function(D){D.style.cssText&&(D.style.cssText="");if(D.firstChild){if(D.parentNode===r){w++;if(l.hasClass(r,/custom_/)){var z=1,F=g(r);if(r.tagName=="OL"){if(F)switch(F){case "cn":case "cn1":case "cn2":if(w>10&&(w%10==0||w>10&&w<20))z=2;else if(w>20)z=3;break;case "num2":if(w>9)z=2}D.className="list-"+m[F]+w+" list-"+F+"-paddingleft-"+z}else D.className="list-"+m[F]+" list-"+F+"-paddingleft"}else D.className=D.className.replace(/list-[\w\-]+/gi,
"");z=D.getAttribute("class");z!==null&&!z.replace(/\s/g,"")&&l.removeAttributes(D,"class")}}else l.remove(D)});!p&&b(r,r.tagName.toLowerCase(),g(r)||l.getStyle(r,"list-style-type"),true)}})}function b(o,p,r,s){var t=o.nextSibling;if(t&&t.nodeType==1&&t.tagName.toLowerCase()==p&&(g(t)||l.getStyle(t,"list-style-type")||(p=="ol"?"decimal":"disc"))==r){l.moveChild(t,o);t.childNodes.length==0&&l.remove(t)}t&&l.isFillChar(t)&&l.remove(t);if((t=o.previousSibling)&&t.nodeType==1&&t.tagName.toLowerCase()==
p&&(g(t)||l.getStyle(t,"list-style-type")||(p=="ol"?"decimal":"disc"))==r)l.moveChild(o,t);t&&l.isFillChar(t)&&l.remove(t);!s&&l.isEmptyBlock(o)&&l.remove(o);g(o)&&c(o.ownerDocument,true)}function a(o,p){if(m[p])o.className="custom_"+p;try{l.setStyle(o,"list-style-type",p)}catch(r){}}function e(o){var p=o.previousSibling;p&&l.isEmptyBlock(p)&&l.remove(p);(p=o.nextSibling)&&l.isEmptyBlock(p)&&l.remove(p)}function k(o){for(;o&&!l.isBody(o);){if(o.nodeName=="TABLE")return null;if(o.nodeName=="LI")return o;
o=o.parentNode}}var f=this,d={TD:1,PRE:1,BLOCKQUOTE:1},m={cn:"cn-1-",cn1:"cn-2-",cn2:"cn-3-",num:"num-1-",num1:"num-2-",num2:"num-3-",dash:"dash",dot:"dot"};f.setOpt({autoTransWordToList:false,insertorderedlist:{num:"",num1:"",num2:"",cn:"",cn1:"",cn2:"",decimal:"","lower-alpha":"","lower-roman":"","upper-alpha":"","upper-roman":""},insertunorderedlist:{circle:"",disc:"",square:"",dash:"",dot:""},listDefaultPaddingLeft:"30",listiconpath:"http://bs.baidu.com/listicon/",maxListLevel:-1,disablePInList:false});
var h={OL:j(f.options.insertorderedlist),UL:j(f.options.insertunorderedlist)},n=f.options.listiconpath;for(var q in m)!f.options.insertorderedlist.hasOwnProperty(q)&&!f.options.insertunorderedlist.hasOwnProperty(q)&&delete m[q];f.ready(function(){var o=[];for(var p in m){if(p=="dash"||p=="dot"){o.push("li.list-"+m[p]+"{background-image:url("+n+m[p]+".gif)}");o.push("ul.custom_"+p+"{list-style:none;}ul.custom_"+p+" li{background-position:0 3px;background-repeat:no-repeat}")}else{for(var r=0;r<99;r++)o.push("li.list-"+
m[p]+r+"{background-image:url("+n+"list-"+m[p]+r+".gif)}");o.push("ol.custom_"+p+"{list-style:none;}ol.custom_"+p+" li{background-position:0 3px;background-repeat:no-repeat}")}switch(p){case "cn":o.push("li.list-"+p+"-paddingleft-1{padding-left:25px}");o.push("li.list-"+p+"-paddingleft-2{padding-left:40px}");o.push("li.list-"+p+"-paddingleft-3{padding-left:55px}");break;case "cn1":o.push("li.list-"+p+"-paddingleft-1{padding-left:30px}");o.push("li.list-"+p+"-paddingleft-2{padding-left:40px}");o.push("li.list-"+
p+"-paddingleft-3{padding-left:55px}");break;case "cn2":o.push("li.list-"+p+"-paddingleft-1{padding-left:40px}");o.push("li.list-"+p+"-paddingleft-2{padding-left:55px}");o.push("li.list-"+p+"-paddingleft-3{padding-left:68px}");break;case "num":case "num1":o.push("li.list-"+p+"-paddingleft-1{padding-left:25px}");break;case "num2":o.push("li.list-"+p+"-paddingleft-1{padding-left:35px}");o.push("li.list-"+p+"-paddingleft-2{padding-left:40px}");break;case "dash":o.push("li.list-"+p+"-paddingleft{padding-left:35px}");
break;case "dot":o.push("li.list-"+p+"-paddingleft{padding-left:20px}")}}o.push(".list-paddingleft-1{padding-left:0}");o.push(".list-paddingleft-2{padding-left:"+f.options.listDefaultPaddingLeft+"px}");o.push(".list-paddingleft-3{padding-left:"+f.options.listDefaultPaddingLeft*2+"px}");v.cssRule("list","ol,ul{margin:0;pading:0;"+(y.ie?"":"width:95%")+"}li{clear:both;}"+o.join("\n"),f.document)});f.ready(function(){l.on(f.body,"cut",function(){setTimeout(function(){var o=f.selection.getRange(),p;if(!o.collapsed)if(p=
l.findParentByTagName(o.startContainer,"li",true))if(!p.nextSibling&&l.isEmptyBlock(p)){p=p.parentNode;var r;if(r=p.previousSibling){l.remove(p);o.setStartAtLast(r).collapse(true)}else if(r=p.nextSibling){l.remove(p);o.setStartAtFirst(r).collapse(true)}else{r=f.document.createElement("p");l.fillNode(f.document,r);p.parentNode.insertBefore(r,p);l.remove(p);o.setStart(r,0).collapse(true)}o.select(true)}})})});f.addListener("beforepaste",function(o,p){var r=this.selection.getRange(),s=UE.htmlparser(p.html,
true);if(r=l.findParentByTagName(r.startContainer,"li",true)){var t=r.parentNode;v.each(s.getNodesByTagName(t.tagName=="OL"?"ul":"ol"),function(u){u.tagName=t.tagName;u.setAttr();if(u.parentNode===s)o=g(t)||(t.tagName=="OL"?"decimal":"disc");else{var w=u.parentNode.getAttr("class");(o=w&&/custom_/.test(w)?w.match(/custom_(\w+)/)[1]:u.parentNode.getStyle("list-style-type"))||(o=t.tagName=="OL"?"decimal":"disc")}w=v.indexOf(h[t.tagName],o);if(u.parentNode!==s)w=w+1==h[t.tagName].length?0:w+1;w=h[t.tagName][w];
m[w]?u.setAttr("class","custom_"+w):u.setStyle("list-style-type",w)})}p.html=s.toHtml()});f.getOpt("disablePInList")===true&&f.addOutputRule(function(o){v.each(o.getNodesByTagName("li"),function(p){var r=[],s=0;v.each(p.children,function(t){if(t.tagName=="p"){for(var u;u=t.children.pop();){r.splice(s,0,u);u.parentNode=p;lastNode=u}u=r[r.length-1];if(!u||u.type!="element"||u.tagName!="br"){t=UE.uNode.createElement("br");t.parentNode=p;r.push(t)}s=r.length}});if(r.length)p.children=r})});f.addInputRule(function(o){v.each(o.getNodesByTagName("li"),
function(t){for(var u=UE.uNode.createElement("p"),w=0,D;D=t.children[w];)if(D.type=="text"||K.p[D.tagName])u.appendChild(D);else if(u.firstChild()){t.insertBefore(u,D);u=UE.uNode.createElement("p");w+=2}else w++;if(u.firstChild()&&!u.parentNode||!t.firstChild())t.appendChild(u);u.firstChild()||u.innerHTML(y.ie?"&nbsp;":"<br/>");t=t.firstChild();(u=t.lastChild())&&u.type=="text"&&/^\s*$/.test(u.data)&&t.removeChild(u)});if(f.options.autoTransWordToList){var p={num1:/^\d+\)/,decimal:/^\d+\./,"lower-alpha":/^[a-z]+\)/,
"upper-alpha":/^[A-Z]+\./,cn:/^[\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+[\u3001]/,cn2:/^\([\u4E00\u4E8C\u4E09\u56DB\u516d\u4e94\u4e03\u516b\u4e5d]+\)/},r={square:"n"};function s(t,u){if((u=u.firstChild())&&u.type=="element"&&u.tagName=="span"&&/Wingdings|Symbol/.test(u.getStyle("font-family"))){for(var w in r)if(r[w]==u.data)return w;return"disc"}for(w in p)if(p[w].test(t))return w}v.each(o.getNodesByTagName("p"),function(t){function u(I,S,L){if(I.tagName=="ol")if(y.ie){var X=S.firstChild();
X.type=="element"&&X.tagName=="span"&&p[L].test(X.innerText())&&S.removeChild(X)}else S.innerHTML(S.innerHTML().replace(p[L],""));else S.removeChild(S.firstChild());L=UE.uNode.createElement("li");L.appendChild(S);I.appendChild(L)}if(t.getAttr("class")=="MsoListParagraph"){t.setStyle("margin","");t.setStyle("margin-left","");t.setAttr("class","");var w=t,D,z=t;if(t.parentNode.tagName!="li"&&(D=s(t.innerText(),t))){var F=UE.uNode.createElement(f.options.insertorderedlist.hasOwnProperty(D)?"ol":"ul");
for(m[D]?F.setAttr("class","custom_"+D):F.setStyle("list-style-type",D);t&&t.parentNode.tagName!="li"&&s(t.innerText(),t);){(w=t.nextSibling())||t.parentNode.insertBefore(F,t);u(F,t,D);t=w}!F.parentNode&&t&&t.parentNode&&t.parentNode.insertBefore(F,t)}(t=z.firstChild())&&t.type=="element"&&t.tagName=="span"&&/^\s*(&nbsp;)+\s*$/.test(t.innerText())&&t.parentNode.removeChild(t)}})}});f.addListener("contentchange",function(){c(f.document)});f.addListener("keydown",function(o,p){function r(){p.preventDefault?
p.preventDefault():(p.returnValue=false);f.fireEvent("contentchange");f.undoManger&&f.undoManger.save()}function s(I,S){for(;I&&!l.isBody(I);){if(S(I))return null;if(I.nodeType==1&&/[ou]l/i.test(I.tagName))return I;I=I.parentNode}return null}o=p.keyCode||p.which;if(o==13&&!p.shiftKey){var t=f.selection.getRange(),u=l.findParent(t.startContainer,function(I){return l.isBlockElm(I)},true),w=l.findParentByTagName(t.startContainer,"li",true);if(u&&u.tagName!="PRE"&&!w){w=u.innerHTML.replace(new RegExp(l.fillChar,
"g"),"");if(/^\s*1\s*\.[^\d]/.test(w)){u.innerHTML=w.replace(/^\s*1\s*\./,"");t.setStartAtLast(u).collapse(true).select();f.__hasEnterExecCommand=true;f.execCommand("insertorderedlist");f.__hasEnterExecCommand=false}}t=f.selection.getRange();u=s(t.startContainer,function(I){return I.tagName=="TABLE"});w=t.collapsed?u:s(t.endContainer,function(I){return I.tagName=="TABLE"});if(u&&w&&u===w){if(!t.collapsed){u=l.findParentByTagName(t.startContainer,"li",true);w=l.findParentByTagName(t.endContainer,"li",
true);if(u&&w&&u===w){t.deleteContents();if((w=l.findParentByTagName(t.startContainer,"li",true))&&l.isEmptyBlock(w)){F=w.previousSibling;next=w.nextSibling;u=f.document.createElement("p");l.fillNode(f.document,u);z=w.parentNode;if(F&&next){t.setStart(next,0).collapse(true).select(true);l.remove(w)}else{!F&&!next||!F?z.parentNode.insertBefore(u,z):w.parentNode.parentNode.insertBefore(u,z.nextSibling);l.remove(w);z.firstChild||l.remove(z);t.setStart(u,0).setCursor()}r();return}}else{u=t.cloneRange();
var D=u.collapse(false).createBookmark();t.deleteContents();u.moveToBookmark(D);w=l.findParentByTagName(u.startContainer,"li",true);e(w);u.select();r();return}}if(w=l.findParentByTagName(t.startContainer,"li",true)){if(l.isEmptyBlock(w)){D=t.createBookmark();var z=w.parentNode;if(w!==z.lastChild){l.breakParent(w,z);e(w)}else{z.parentNode.insertBefore(w,z.nextSibling);l.isEmptyNode(z)&&l.remove(z)}if(!K.$list[w.parentNode.tagName])if(l.isBlockElm(w.firstChild))l.remove(w,true);else{u=f.document.createElement("p");
for(w.parentNode.insertBefore(u,w);w.firstChild;)u.appendChild(w.firstChild);l.remove(w)}t.moveToBookmark(D).select()}else{u=w.firstChild;if(!u||!l.isBlockElm(u)){u=f.document.createElement("p");for(!w.firstChild&&l.fillNode(f.document,u);w.firstChild;)u.appendChild(w.firstChild);w.appendChild(u);u=u}D=f.document.createElement("span");t.insertNode(D);l.breakParent(D,w);F=D.nextSibling;u=F.firstChild;if(!u){u=f.document.createElement("p");l.fillNode(f.document,u);F.appendChild(u);u=u}if(l.isEmptyNode(u)){u.innerHTML=
"";l.fillNode(f.document,u)}t.setStart(u,0).collapse(true).shrinkBoundary().select();l.remove(D);var F=F.previousSibling;if(F&&l.isEmptyBlock(F)){F.innerHTML="<p></p>";l.fillNode(f.document,F.firstChild)}}r()}}}if(o==8){t=f.selection.getRange();if(t.collapsed&&l.isStartInblock(t)){u=t.cloneRange().trimBoundary();if((w=l.findParentByTagName(t.startContainer,"li",true))&&l.isStartInblock(u))if((u=l.findParentByTagName(t.startContainer,"p",true))&&u!==w.firstChild){z=l.findParentByTagName(u,["ol","ul"]);
l.breakParent(u,z);e(u);f.fireEvent("contentchange");t.setStart(u,0).setCursor(false,true);f.fireEvent("saveScene");l.preventDefault(p)}else if(w&&(F=w.previousSibling)){if(!(o==46&&w.childNodes.length)){if(K.$list[F.tagName])F=F.lastChild;f.undoManger&&f.undoManger.save();u=w.firstChild;if(l.isBlockElm(u))if(l.isEmptyNode(u)){F.appendChild(u);for(t.setStart(u,0).setCursor(false,true);w.firstChild;)F.appendChild(w.firstChild)}else{D=f.document.createElement("span");t.insertNode(D);if(l.isEmptyBlock(F))F.innerHTML=
"";l.moveChild(w,F);t.setStartBefore(D).collapse(true).select(true);l.remove(D)}else if(l.isEmptyNode(w)){u=f.document.createElement("p");F.appendChild(u);t.setStart(u,0).setCursor()}else for(t.setEnd(F,F.childNodes.length).collapse().select(true);w.firstChild;)F.appendChild(w.firstChild);l.remove(w);f.fireEvent("contentchange");f.fireEvent("saveScene");l.preventDefault(p)}}else if(w&&!w.previousSibling){z=w.parentNode;D=t.createBookmark();if(l.isTagNode(z.parentNode,"ol ul"))z.parentNode.insertBefore(w,
z);else{for(;w.firstChild;)z.parentNode.insertBefore(w.firstChild,z);l.remove(w)}l.isEmptyNode(z)&&l.remove(z);t.moveToBookmark(D).setCursor(false,true);f.fireEvent("contentchange");f.fireEvent("saveScene");l.preventDefault(p)}}}});f.addListener("keyup",function(o,p){if((p.keyCode||p.which)==8){o=f.selection.getRange();if(o=l.findParentByTagName(o.startContainer,["ol","ul"],true))b(o,o.tagName.toLowerCase(),g(o)||l.getComputedStyle(o,"list-style-type"),true)}});f.addListener("tabkeydown",function(){function o(F){if(f.options.maxListLevel!=
-1){F=F.parentNode;for(var I=0;/[ou]l/i.test(F.tagName);){I++;F=F.parentNode}if(I>=f.options.maxListLevel)return true}}var p=f.selection.getRange(),r=l.findParentByTagName(p.startContainer,"li",true);if(r){var s;if(p.collapsed){if(o(r))return true;var t=r.parentNode,u=f.document.createElement(t.tagName),w=v.indexOf(h[u.tagName],g(t)||l.getComputedStyle(t,"list-style-type"));w=w+1==h[u.tagName].length?0:w+1;w=h[u.tagName][w];a(u,w);if(l.isStartInblock(p)){f.fireEvent("saveScene");s=p.createBookmark();
t.insertBefore(u,r);u.appendChild(r);b(u,u.tagName.toLowerCase(),w);f.fireEvent("contentchange");p.moveToBookmark(s).select(true);return true}}else{f.fireEvent("saveScene");s=p.createBookmark();t=0;var D;u=l.findParents(r);for(var z;z=u[t++];)if(l.isTagNode(z,"ol ul")){D=z;break}z=r;if(s.end)for(;z&&!(l.getPosition(z,s.end)&l.POSITION_FOLLOWING);)if(o(z))z=l.getNextDomNode(z,false,null,function(F){return F!==D});else{t=z.parentNode;u=f.document.createElement(t.tagName);w=v.indexOf(h[u.tagName],g(t)||
l.getComputedStyle(t,"list-style-type"));w=h[u.tagName][w+1==h[u.tagName].length?0:w+1];a(u,w);for(t.insertBefore(u,z);z&&!(l.getPosition(z,s.end)&l.POSITION_FOLLOWING);){r=z.nextSibling;u.appendChild(z);if(!r||l.isTagNode(r,"ol ul")){if(r)for(;r=r.firstChild;){if(r.tagName=="LI")break}else r=l.getNextDomNode(z,false,null,function(F){return F!==D});break}z=r}b(u,u.tagName.toLowerCase(),w);z=r}f.fireEvent("contentchange");p.moveToBookmark(s).select();return true}}});f.commands.insertorderedlist=f.commands.insertunorderedlist=
{execCommand:function(o,p){p||(p=o.toLowerCase()=="insertorderedlist"?"decimal":"disc");var r=this,s=this.selection.getRange(),t=function(ga){return ga.nodeType==1?ga.tagName.toLowerCase()!="br":!l.isWhitespace(ga)},u=o.toLowerCase()=="insertorderedlist"?"ol":"ul",w=r.document.createDocumentFragment();s.adjustmentBoundary().shrinkBoundary();var D=s.createBookmark(true),z=k(r.document.getElementById(D.start)),F=0,I=k(r.document.getElementById(D.end)),S=0,L,X,T,R;if(z||I){z&&(L=z.parentNode);D.end||
(I=z);I&&(X=I.parentNode);if(L===X){for(;z!==I;){R=z;z=z.nextSibling;if(!l.isBlockElm(R.firstChild)){for(t=r.document.createElement("p");R.firstChild;)t.appendChild(R.firstChild);R.appendChild(t)}w.appendChild(R)}R=r.document.createElement("span");L.insertBefore(R,I);if(!l.isBlockElm(I.firstChild)){for(t=r.document.createElement("p");I.firstChild;)t.appendChild(I.firstChild);I.appendChild(t)}w.appendChild(I);l.breakParent(R,L);l.isEmptyNode(R.previousSibling)&&l.remove(R.previousSibling);l.isEmptyNode(R.nextSibling)&&
l.remove(R.nextSibling);t=g(L)||l.getComputedStyle(L,"list-style-type")||(o.toLowerCase()=="insertorderedlist"?"decimal":"disc");if(L.tagName.toLowerCase()==u&&t==p){t=0;for(t=r.document.createDocumentFragment();r=w.firstChild;)if(l.isTagNode(r,"ol ul"))t.appendChild(r);else for(;r.firstChild;){t.appendChild(r.firstChild);l.remove(r)}R.parentNode.insertBefore(t,R)}else{T=r.document.createElement(u);a(T,p);T.appendChild(w);R.parentNode.insertBefore(T,R)}l.remove(R);T&&b(T,u,p);s.moveToBookmark(D).select();
return}if(z){for(;z;){R=z.nextSibling;if(l.isTagNode(z,"ol ul"))w.appendChild(z);else{T=r.document.createDocumentFragment();for(o=0;z.firstChild;){if(l.isBlockElm(z.firstChild))o=1;T.appendChild(z.firstChild)}if(o)w.appendChild(T);else{o=r.document.createElement("p");o.appendChild(T);w.appendChild(o)}l.remove(z)}z=R}L.parentNode.insertBefore(w,L.nextSibling);if(l.isEmptyNode(L)){s.setStartBefore(L);l.remove(L)}else s.setStartAfter(L);F=1}if(I&&l.inDoc(X,r.document)){for(z=X.firstChild;z&&z!==I;){R=
z.nextSibling;if(l.isTagNode(z,"ol ul"))w.appendChild(z);else{T=r.document.createDocumentFragment();for(o=0;z.firstChild;){if(l.isBlockElm(z.firstChild))o=1;T.appendChild(z.firstChild)}if(o)w.appendChild(T);else{o=r.document.createElement("p");o.appendChild(T);w.appendChild(o)}l.remove(z)}z=R}R=l.createElement(r.document,"div",{tmpDiv:1});l.moveChild(I,R);w.appendChild(R);l.remove(I);X.parentNode.insertBefore(w,X);s.setEndBefore(X);l.isEmptyNode(X)&&l.remove(X);S=1}}F||s.setStartBefore(r.document.getElementById(D.start));
D.end&&!S&&s.setEndAfter(r.document.getElementById(D.end));s.enlarge(true,function(ga){return d[ga.tagName]});w=r.document.createDocumentFragment();I=s.createBookmark();L=l.getNextDomNode(I.start,false,t);T=s.cloneRange();for(F=l.isBlockElm;L&&L!==I.end&&l.getPosition(L,I.end)&l.POSITION_PRECEDING;)if(L.nodeType==3||K.li[L.tagName])if(L.nodeType==1&&K.$list[L.tagName]){for(;L.firstChild;)w.appendChild(L.firstChild);z=l.getNextDomNode(L,false,t);l.remove(L);L=z}else{z=L;for(T.setStartBefore(L);L&&
L!==I.end&&(!F(L)||l.isBookmarkNode(L));){z=L;L=l.getNextDomNode(L,false,null,function(ga){return!d[ga.tagName]})}if(L&&F(L))if((R=l.getNextDomNode(z,false,t))&&l.isBookmarkNode(R)){L=l.getNextDomNode(R,false,t);z=R}T.setEndAfter(z);L=l.getNextDomNode(z,false,t);R=s.document.createElement("li");R.appendChild(T.extractContents());if(l.isEmptyNode(R)){for(z=s.document.createElement("p");R.firstChild;)z.appendChild(R.firstChild);R.appendChild(z)}w.appendChild(R)}else L=l.getNextDomNode(L,true,t);s.moveToBookmark(I).collapse(true);
T=r.document.createElement(u);a(T,p);T.appendChild(w);s.insertNode(T);b(T,u,p);t=0;for(p=l.getElementsByTagName(T,"div");r=p[t++];)r.getAttribute("tmpDiv")&&l.remove(r,true);s.moveToBookmark(D).select()},queryCommandState:function(o){o=o.toLowerCase()=="insertorderedlist"?"ol":"ul";for(var p=this.selection.getStartElementPath(),r=0,s;s=p[r++];){if(s.nodeName=="TABLE")return 0;if(o==s.nodeName.toLowerCase())return 1}return 0},queryCommandValue:function(o){o=o.toLowerCase()=="insertorderedlist"?"ol":
"ul";for(var p=this.selection.getStartElementPath(),r,s=0,t;t=p[s++];){if(t.nodeName=="TABLE"){r=null;break}if(o==t.nodeName.toLowerCase()){r=t;break}}return r?g(r)||l.getComputedStyle(r,"list-style-type"):null}}};(function(){var j={textarea:function(g,c){var b=c.ownerDocument.createElement("textarea");b.style.cssText="position:absolute;resize:none;width:100%;height:100%;border:0;padding:0;margin:0;overflow-y:auto;";if(y.ie&&y.version<8){b.style.width=c.offsetWidth+"px";b.style.height=c.offsetHeight+
"px";c.onresize=function(){b.style.width=c.offsetWidth+"px";b.style.height=c.offsetHeight+"px"}}c.appendChild(b);return{setContent:function(a){b.value=a},getContent:function(){return b.value},select:function(){var a;if(y.ie){a=b.createTextRange();a.collapse(true);a.select()}else{b.setSelectionRange(0,0);b.focus()}},dispose:function(){c.removeChild(b);c=b=c.onresize=null}}},codemirror:function(g,c){var b=window.CodeMirror(c,{mode:"text/html",tabMode:"indent",lineNumbers:true,lineWrapping:true}),a=
b.getWrapperElement();a.style.cssText='position:absolute;left:0;top:0;width:100%;height:100%;font-family:consolas,"Courier new",monospace;font-size:13px;';b.getScrollerElement().style.cssText="position:absolute;left:0;top:0;width:100%;height:100%;";b.refresh();return{getCodeMirror:function(){return b},setContent:function(e){b.setValue(e)},getContent:function(){return b.getValue()},select:function(){b.focus()},dispose:function(){c.removeChild(a);b=a=null}}}};UE.plugins.source=function(){function g(n){return j[b.sourceEditor==
"codemirror"&&window.CodeMirror?"codemirror":"textarea"](c,n)}var c=this,b=this.options,a=false,e,k;b.sourceEditor=y.ie?"textarea":b.sourceEditor||"codemirror";c.setOpt({sourceEditorFirst:false});var f,d,m;c.commands.source={execCommand:function(){if(a=!a){m=c.selection.getRange().createAddress(false,true);c.undoManger&&c.undoManger.save(true);if(y.gecko)c.body.contentEditable=false;f=c.iframe.style.cssText;c.iframe.style.cssText+="position:absolute;left:-32768px;top:-32768px;";c.fireEvent("beforegetcontent");
var n=UE.htmlparser(c.body.innerHTML);c.filterOutputRule(n);n.traversal(function(p){if(p.type=="element")switch(p.tagName){case "td":case "th":case "caption":p.children&&p.children.length==1&&p.firstChild().tagName=="br"&&p.removeChild(p.firstChild());break;case "pre":p.innerText(p.innerText().replace(/&nbsp;/g," "))}});c.fireEvent("aftergetcontent");n=n.toHtml(true);e=g(c.iframe.parentNode);e.setContent(n);k=c.setContent;c.setContent=function(p){p=UE.htmlparser(p);c.filterInputRule(p);p=p.toHtml();
e.setContent(p)};setTimeout(function(){e.select();c.addListener("fullscreenchanged",function(){try{e.getCodeMirror().refresh()}catch(p){}})});d=c.getContent;c.getContent=function(){return e.getContent()||"<p>"+(y.ie?"":"<br/>")+"</p>"}}else{c.iframe.style.cssText=f;n=e.getContent()||"<p>"+(y.ie?"":"<br/>")+"</p>";n=n.replace(new RegExp("[\\r\\t\\n ]*</?(\\w+)\\s*(?:[^>]*)>","g"),function(p,r){if(r&&!K.$inlineWithA[r.toLowerCase()])return p.replace(/(^[\n\r\t ]*)|([\n\r\t ]*$)/g,"");return p.replace(/(^[\n\r\t]*)|([\n\r\t]*$)/g,
"")});c.setContent=k;c.setContent(n);e.dispose();e=null;c.getContent=d;n=c.body.firstChild;if(!n){c.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";n=c.body.firstChild}c.undoManger&&c.undoManger.save(true);if(y.gecko){var q=document.createElement("input");q.style.cssText="position:absolute;left:0;top:-32768px";document.body.appendChild(q);c.body.contentEditable=false;setTimeout(function(){l.setViewportOffset(q,{left:-32768,top:0});q.focus();setTimeout(function(){c.body.contentEditable=true;c.selection.getRange().moveToAddress(m).select(true);
l.remove(q)})})}else try{c.selection.getRange().moveToAddress(m).select(true)}catch(o){}}this.fireEvent("sourcemodechanged",a)},queryCommandState:function(){return a|0},notNeedUndo:1};var h=c.queryCommandState;c.queryCommandState=function(n){n=n.toLowerCase();if(a)return n in{source:1,fullscreen:1}?1:-1;return h.apply(this,arguments)};b.sourceEditor=="codemirror"&&c.addListener("ready",function(){v.loadFile(document,{src:b.codeMirrorJsUrl||b.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.js",
tag:"script",type:"text/javascript",defer:"defer"},function(){b.sourceEditorFirst&&setTimeout(function(){c.execCommand("source")},0)});v.loadFile(document,{tag:"link",rel:"stylesheet",type:"text/css",href:b.codeMirrorCssUrl||b.UEDITOR_HOME_URL+"third-party/codemirror/codemirror.css"})})}})();UE.plugins.enterkey=function(){var j,g=this,c=g.options.enterTag;g.addListener("keyup",function(b,a){if((a.keyCode||a.which)==13){b=g.selection.getRange();a=b.startContainer;var e;if(y.ie)g.fireEvent("saveScene",
true,true);else{if(/h\d/i.test(j)){if(y.gecko){if(!l.findParentByTagName(a,["h1","h2","h3","h4","h5","h6","blockquote","caption","table"],true)){g.document.execCommand("formatBlock",false,"<p>");e=1}}else if(a.nodeType==1){a=g.document.createTextNode("");var k;b.insertNode(a);if(k=l.findParentByTagName(a,"div",true)){for(e=g.document.createElement("p");k.firstChild;)e.appendChild(k.firstChild);k.parentNode.insertBefore(e,k);l.remove(k);b.setStartBefore(a).setCursor();e=1}l.remove(a)}g.undoManger&&
e&&g.undoManger.save()}y.opera&&b.select()}}});g.addListener("keydown",function(b,a){if((a.keyCode||a.which)==13)if(g.fireEvent("beforeenterkeydown"))l.preventDefault(a);else{g.fireEvent("saveScene",true,true);j="";b=g.selection.getRange();if(!b.collapsed){var e=b.startContainer,k=b.endContainer;e=l.findParentByTagName(e,"td",true);k=l.findParentByTagName(k,"td",true);if(e&&k&&e!==k||!e&&k||e&&!k){a.preventDefault?a.preventDefault():(a.returnValue=false);return}}if(c=="p"){if(!y.ie){e=l.findParentByTagName(b.startContainer,
["ol","ul","p","h1","h2","h3","h4","h5","h6","blockquote","caption"],true);if(!e&&!y.opera){g.document.execCommand("formatBlock",false,"<p>");if(y.gecko){b=g.selection.getRange();(e=l.findParentByTagName(b.startContainer,"p",true))&&l.removeDirtyAttr(e)}}else{j=e.tagName;e.tagName.toLowerCase()=="p"&&y.gecko&&l.removeDirtyAttr(e)}}}else{a.preventDefault?a.preventDefault():(a.returnValue=false);if(b.collapsed){a=b.document.createElement("br");b.insertNode(a);if(a.parentNode.lastChild===a){a.parentNode.insertBefore(a.cloneNode(true),
a);b.setStartBefore(a)}else b.setStartAfter(a);b.setCursor()}else{b.deleteContents();e=b.startContainer;if(e.nodeType==1&&(e=e.childNodes[b.startOffset])){for(;e.nodeType==1;){if(K.$empty[e.tagName]){b.setStartBefore(e).setCursor();g.undoManger&&g.undoManger.save();return false}if(!e.firstChild){a=b.document.createElement("br");e.appendChild(a);b.setStart(e,0).setCursor();g.undoManger&&g.undoManger.save();return false}e=e.firstChild}if(e===b.startContainer.childNodes[b.startOffset]){a=b.document.createElement("br");
b.insertNode(a).setCursor()}else b.setStart(e,0).setCursor()}else{a=b.document.createElement("br");b.insertNode(a).setStartAfter(a).setCursor()}}}}})};UE.plugins.keystrokes=function(){var j=this,g=true;j.addListener("keydown",function(c,b){c=b.keyCode||b.which;var a=j.selection.getRange();if(!a.collapsed&&!(b.ctrlKey||b.shiftKey||b.altKey||b.metaKey)&&(c>=65&&c<=90||c>=48&&c<=57||c>=96&&c<=111||{13:1,8:1,46:1}[c])){var e=a.startContainer;l.isFillChar(e)&&a.setStartBefore(e);e=a.endContainer;l.isFillChar(e)&&
a.setEndAfter(e);a.txtToElmBoundary();if(a.endContainer&&a.endContainer.nodeType==1)(e=a.endContainer.childNodes[a.endOffset])&&l.isBr(e)&&a.setEndAfter(e);if(a.startOffset==0){e=a.startContainer;if(l.isBoundaryNode(e,"firstChild")){e=a.endContainer;if(a.endOffset==(e.nodeType==3?e.nodeValue.length:e.childNodes.length)&&l.isBoundaryNode(e,"lastChild")){j.fireEvent("saveScene");j.body.innerHTML="<p>"+(y.ie?"":"<br/>")+"</p>";a.setStart(j.body.firstChild,0).setCursor(false,true);j._selectionChange();
return}}}}if(c==Ca.Backspace){a=j.selection.getRange();g=a.collapsed;if(j.fireEvent("delkeydown",b))return;var k,f;if(a.collapsed&&a.inFillChar()){k=a.startContainer;if(l.isFillChar(k)){a.setStartBefore(k).shrinkBoundary(true).collapse(true);l.remove(k)}else{k.nodeValue=k.nodeValue.replace(new RegExp("^"+l.fillChar),"");a.startOffset--;a.collapse(true).select(true)}}if(k=a.getClosedNode()){j.fireEvent("saveScene");a.setStartBefore(k);l.remove(k);a.setCursor();j.fireEvent("saveScene");l.preventDefault(b);
return}if(!y.ie){k=l.findParentByTagName(a.startContainer,"table",true);f=l.findParentByTagName(a.endContainer,"table",true);if(k&&!f||!k&&f||k!==f){b.preventDefault();return}}}if(c==Ca.Tab){var d={ol:1,ul:1,table:1};if(j.fireEvent("tabkeydown",b)){l.preventDefault(b);return}a=j.selection.getRange();j.fireEvent("saveScene");e=0;var m="";k=j.options.tabSize||4;for(f=j.options.tabNode||"&nbsp;";e<k;e++)m+=f;e=j.document.createElement("span");e.innerHTML=m+l.fillChar;if(a.collapsed)a.insertNode(e.cloneNode(true).firstChild).setCursor(true);
else{m=function(n){return l.isBlockElm(n)&&!d[n.tagName.toLowerCase()]};k=l.findParent(a.startContainer,m,true);f=l.findParent(a.endContainer,m,true);if(k&&f&&k===f){a.deleteContents();a.insertNode(e.cloneNode(true).firstChild).setCursor(true)}else{k=a.createBookmark();a.enlarge(true);f=a.createBookmark();for(var h=l.getNextDomNode(f.start,false,m);h&&!(l.getPosition(h,f.end)&l.POSITION_FOLLOWING);){h.insertBefore(e.cloneNode(true).firstChild,h.firstChild);h=l.getNextDomNode(h,false,m)}a.moveToBookmark(f).moveToBookmark(k).select()}}l.preventDefault(b)}if(y.gecko&&
c==46){a=j.selection.getRange();if(a.collapsed){k=a.startContainer;if(l.isEmptyBlock(k)){for(c=k.parentNode;l.getChildCount(c)==1&&!l.isBody(c);){k=c;c=c.parentNode}k===c.lastChild&&b.preventDefault()}}}});j.addListener("keyup",function(c,b){c=this;if((b.keyCode||b.which)==Ca.Backspace)if(!c.fireEvent("delkeyup")){b=c.selection.getRange();if(b.collapsed){var a;if(a=l.findParentByTagName(b.startContainer,["h1","h2","h3","h4","h5","h6"],true))if(l.isEmptyBlock(a)){var e=a.previousSibling;if(e&&e.nodeName!=
"TABLE"){l.remove(a);b.setStartAtLast(e).setCursor(false,true);return}else if((e=a.nextSibling)&&e.nodeName!="TABLE"){l.remove(a);b.setStartAtFirst(e).setCursor(false,true);return}}if(l.isBody(b.startContainer)){a=l.createElement(c.document,"p",{innerHTML:y.ie?l.fillChar:"<br/>"});b.insertNode(a).setStart(a,0).setCursor(false,true)}}if(!g&&(b.startContainer.nodeType==3||b.startContainer.nodeType==1&&l.isEmptyBlock(b.startContainer)))if(y.ie){c=b.document.createElement("span");b.insertNode(c).setStartBefore(c).collapse(true);
b.select();l.remove(c)}else b.select()}})};UE.plugins.fiximgclick=function(){function j(){this.cover=this.resizer=this.editor=null;this.doc=document;this.prePos={x:0,y:0};this.startPos={x:0,y:0}}var g=false;(function(){var c=[[0,0,-1,-1],[0,0,0,-1],[0,0,1,-1],[0,0,-1,0],[0,0,1,0],[0,0,-1,1],[0,0,0,1],[0,0,1,1]];j.prototype={init:function(b){var a=this;a.editor=b;a.startPos=this.prePos={x:0,y:0};a.dragId=-1;b=[];var e=a.cover=document.createElement("div"),k=a.resizer=document.createElement("div");
e.id=a.editor.ui.id+"_imagescale_cover";e.style.cssText="position:absolute;display:none;z-index:"+a.editor.options.zIndex+";filter:alpha(opacity=0); opacity:0;background:#CCC;";l.on(e,"mousedown click",function(){a.hide()});for(i=0;i<8;i++)b.push('<span class="edui-editor-imagescale-hand'+i+'"></span>');k.id=a.editor.ui.id+"_imagescale";k.className="edui-editor-imagescale";k.innerHTML=b.join("");k.style.cssText+=";display:none;border:1px solid #3b77ff;z-index:"+a.editor.options.zIndex+";";a.editor.ui.getDom().appendChild(e);
a.editor.ui.getDom().appendChild(k);a.initStyle();a.initEvents()},initStyle:function(){v.cssRule("imagescale",".edui-editor-imagescale{display:none;position:absolute;border:1px solid #38B2CE;cursor:hand;-webkit-box-sizing: content-box;-moz-box-sizing: content-box;box-sizing: content-box;}.edui-editor-imagescale span{position:absolute;width:6px;height:6px;overflow:hidden;font-size:0px;display:block;background-color:#3C9DD0;}.edui-editor-imagescale .edui-editor-imagescale-hand0{cursor:nw-resize;top:0;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand1{cursor:n-resize;top:0;margin-top:-4px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand2{cursor:ne-resize;top:0;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand3{cursor:w-resize;top:50%;margin-top:-4px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand4{cursor:e-resize;top:50%;margin-top:-4px;left:100%;margin-left:-3px;}.edui-editor-imagescale .edui-editor-imagescale-hand5{cursor:sw-resize;top:100%;margin-top:-3px;left:0;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand6{cursor:s-resize;top:100%;margin-top:-3px;left:50%;margin-left:-4px;}.edui-editor-imagescale .edui-editor-imagescale-hand7{cursor:se-resize;top:100%;margin-top:-3px;left:100%;margin-left:-3px;}")},
initEvents:function(){var b=this;b.startPos.x=b.startPos.y=0;b.isDraging=false},_eventHandler:function(b){var a=this;switch(b.type){case "mousedown":var e=b.target||b.srcElement;if(e.className.indexOf("edui-editor-imagescale-hand")!=-1&&a.dragId==-1){a.dragId=e.className.slice(-1);a.startPos.x=a.prePos.x=b.clientX;a.startPos.y=a.prePos.y=b.clientY;l.on(a.doc,"mousemove",a.proxy(a._eventHandler,a))}break;case "mousemove":if(a.dragId!=-1){a.updateContainerStyle(a.dragId,{x:b.clientX-a.prePos.x,y:b.clientY-
a.prePos.y});a.prePos.x=b.clientX;a.prePos.y=b.clientY;g=true;a.updateTargetElement()}break;case "mouseup":if(a.dragId!=-1){a.updateContainerStyle(a.dragId,{x:b.clientX-a.prePos.x,y:b.clientY-a.prePos.y});a.updateTargetElement();a.target.parentNode&&a.attachTo(a.target);a.dragId=-1}l.un(a.doc,"mousemove",a.proxy(a._eventHandler,a));if(g){g=false;a.editor.fireEvent("contentchange")}break;default:break}},updateTargetElement:function(){var b=this;l.setStyles(b.target,{width:b.resizer.style.width,height:b.resizer.style.height});
b.target.width=parseInt(b.resizer.style.width);b.target.height=parseInt(b.resizer.style.height);b.attachTo(b.target)},updateContainerStyle:function(b,a){var e=this,k=e.resizer,f;if(c[b][0]!=0){f=parseInt(k.style.left)+a.x;k.style.left=e._validScaledProp("left",f)+"px"}if(c[b][1]!=0){f=parseInt(k.style.top)+a.y;k.style.top=e._validScaledProp("top",f)+"px"}if(c[b][2]!=0){f=k.clientWidth+c[b][2]*a.x;k.style.width=e._validScaledProp("width",f)+"px"}if(c[b][3]!=0){f=k.clientHeight+c[b][3]*a.y;k.style.height=
e._validScaledProp("height",f)+"px"}},_validScaledProp:function(b,a){var e=this.resizer,k=document;a=isNaN(a)?0:a;switch(b){case "left":return a<0?0:a+e.clientWidth>k.clientWidth?k.clientWidth-e.clientWidth:a;case "top":return a<0?0:a+e.clientHeight>k.clientHeight?k.clientHeight-e.clientHeight:a;case "width":return a<=0?1:a+e.offsetLeft>k.clientWidth?k.clientWidth-e.offsetLeft:a;case "height":return a<=0?1:a+e.offsetTop>k.clientHeight?k.clientHeight-e.offsetTop:a}},hideCover:function(){this.cover.style.display=
"none"},showCover:function(){var b=this,a=l.getXY(b.editor.ui.getDom()),e=l.getXY(b.editor.iframe);l.setStyles(b.cover,{width:b.editor.iframe.offsetWidth+"px",height:b.editor.iframe.offsetHeight+"px",top:e.y-a.y+"px",left:e.x-a.x+"px",position:"absolute",display:""})},show:function(b){var a=this;a.resizer.style.display="block";b&&a.attachTo(b);l.on(this.resizer,"mousedown",a.proxy(a._eventHandler,a));l.on(a.doc,"mouseup",a.proxy(a._eventHandler,a));a.showCover();a.editor.fireEvent("afterscaleshow",
a);a.editor.fireEvent("saveScene")},hide:function(){var b=this;b.hideCover();b.resizer.style.display="none";l.un(b.resizer,"mousedown",b.proxy(b._eventHandler,b));l.un(b.doc,"mouseup",b.proxy(b._eventHandler,b));b.editor.fireEvent("afterscalehide",b)},proxy:function(b,a){return function(){return b.apply(a||this,arguments)}},attachTo:function(b){var a=this;b=a.target=b;var e=this.resizer,k=l.getXY(b),f=l.getXY(a.editor.iframe),d=l.getXY(e.parentNode);l.setStyles(e,{width:b.width+"px",height:b.height+
"px",left:f.x+k.x-a.editor.document.body.scrollLeft-d.x-parseInt(e.style.borderLeftWidth)+"px",top:f.y+k.y-a.editor.document.body.scrollTop-d.y-parseInt(e.style.borderTopWidth)+"px"})}}})();return function(){var c=this,b;c.setOpt("imageScaleEnabled",true);!y.ie&&c.options.imageScaleEnabled&&c.addListener("click",function(){var a=c.selection.getRange().getClosedNode();if(a&&a.tagName=="IMG"&&c.body.contentEditable!="false"){if(!(a.className.indexOf("edui-faked-music")!=-1||a.getAttribute("anchorname")||
l.hasClass(a,"loadingclass")||l.hasClass(a,"loaderrorclass"))){if(!b){b=new j;b.init(c);c.ui.getDom().appendChild(b.resizer);var e=function(){b.hide();b.target&&c.selection.getRange().selectNode(b.target).select()},k=function(d){var m=d.target||d.srcElement;if(m&&(m.className===undefined||m.className.indexOf("edui-editor-imagescale")==-1))e(d)},f;c.addListener("afterscaleshow",function(){c.addListener("beforekeydown",e);c.addListener("beforemousedown",k);l.on(document,"keydown",e);l.on(document,"mousedown",
k);c.selection.getNative().removeAllRanges()});c.addListener("afterscalehide",function(){c.removeListener("beforekeydown",e);c.removeListener("beforemousedown",k);l.un(document,"keydown",e);l.un(document,"mousedown",k);var d=b.target;d.parentNode&&c.selection.getRange().selectNode(d).select()});l.on(b.resizer,"mousedown",function(d){c.selection.getNative().removeAllRanges();var m=d.target||d.srcElement;if(m&&m.className.indexOf("edui-editor-imagescale-hand")==-1)f=setTimeout(function(){b.hide();b.target&&
c.selection.getRange().selectNode(m).select()},200)});l.on(b.resizer,"mouseup",function(d){(d=d.target||d.srcElement)&&d.className.indexOf("edui-editor-imagescale-hand")==-1&&clearTimeout(f)})}b.show(a)}}else b&&b.resizer.style.display!="none"&&b.hide()});y.webkit&&c.addListener("click",function(a,e){e.target.tagName=="IMG"&&c.body.contentEditable!="false"&&(new ea.Range(c.document)).selectNode(e.target).select()})}}();UE.plugin.register("autolink",function(){var j=0;return!y.ie?{bindEvents:{reset:function(){j=
0},keydown:function(g,c){g=this;c=c.keyCode||c.which;if(c==32||c==13){c=g.selection.getNative();for(var b=c.getRangeAt(0).cloneRange(),a,e=b.startContainer;e.nodeType==1&&b.startOffset>0;){e=b.startContainer.childNodes[b.startOffset-1];if(!e)break;b.setStart(e,e.nodeType==1?e.childNodes.length:e.nodeValue.length);b.collapse(true);e=b.startContainer}do{if(b.startOffset==0){for(e=b.startContainer.previousSibling;e&&e.nodeType==1;)e=e.lastChild;if(!e||l.isFillChar(e))break;a=e.nodeValue.length}else{e=
b.startContainer;a=b.startOffset}b.setStart(e,a-1);a=b.toString().charCodeAt(0)}while(a!=160&&a!=32);if(b.toString().replace(new RegExp(l.fillChar,"g"),"").match(/(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i)){for(;b.toString().length;){if(/^(?:https?:\/\/|ssh:\/\/|ftp:\/\/|file:\/|www\.)/i.test(b.toString()))break;try{b.setStart(b.startContainer,b.startOffset+1)}catch(k){for(e=b.startContainer;!(next=e.nextSibling);){if(l.isBody(e))return;e=e.parentNode}b.setStart(next,0)}}if(!l.findParentByTagName(b.startContainer,
"a",true)){a=g.document.createElement("a");e=g.document.createTextNode(" ");var f;g.undoManger&&g.undoManger.save();a.appendChild(b.extractContents());a.href=a.innerHTML=a.innerHTML.replace(/<[^>]+>/g,"");f=a.getAttribute("href").replace(new RegExp(l.fillChar,"g"),"");f=/^(?:https?:\/\/)/ig.test(f)?f:"http://"+f;a.setAttribute("_src",v.html(f));a.href=v.html(f);b.insertNode(a);a.parentNode.insertBefore(e,a.nextSibling);b.setStart(e,0);b.collapse(true);c.removeAllRanges();c.addRange(b);g.undoManger&&
g.undoManger.save()}}}}}}:{}},function(){function j(c){if(c.nodeType==3)return null;if(c.nodeName=="A")return c;for(c=c.lastChild;c;){if(c.nodeName=="A")return c;if(c.nodeType==3){if(l.isWhitespace(c)){c=c.previousSibling;continue}return null}c=c.lastChild}}var g={37:1,38:1,39:1,40:1,13:1,32:1};y.ie&&this.addListener("keyup",function(c,b){c=this;b=b.keyCode;if(g[b]){c=c.selection.getRange();var a=c.startContainer;if(b==13){for(;a&&!l.isBody(a)&&!l.isBlockElm(a);)a=a.parentNode;if(a&&!l.isBody(a)&&
a.nodeName=="P")if((b=a.previousSibling)&&b.nodeType==1)(b=j(b))&&!b.getAttribute("_href")&&l.remove(b,true)}else if(b==32){if(a.nodeType==3&&/^\s$/.test(a.nodeValue))(a=a.previousSibling)&&a.nodeName=="A"&&!a.getAttribute("_href")&&l.remove(a,true)}else if((a=l.findParentByTagName(a,"a",true))&&!a.getAttribute("_href")){b=c.createBookmark();l.remove(a,true);c.moveToBookmark(b).select(true)}}})});UE.plugins.autoheight=function(){function j(){var d=this;clearTimeout(k);if(!f)if(!d.queryCommandState||
d.queryCommandState&&d.queryCommandState("source")!=1)k=setTimeout(function(){for(var m=d.body.lastChild;m&&m.nodeType!=1;)m=m.previousSibling;if(m&&m.nodeType==1){m.style.clear="both";e=Math.max(l.getXY(m).y+m.offsetHeight+25,Math.max(a.minFrameHeight,a.initialFrameHeight));if(e!=b){if(e!==parseInt(d.iframe.parentNode.style.height))d.iframe.parentNode.style.height=e+"px";d.body.style.height=e+"px";b=e}l.removeStyle(m,"clear")}},50)}var g=this;g.autoHeightEnabled=g.options.autoHeightEnabled!==false;
if(g.autoHeightEnabled){var c,b=0,a=g.options,e,k,f;g.addListener("fullscreenchanged",function(d,m){f=m});g.addListener("destroy",function(){g.removeListener("contentchange afterinserthtml keyup mouseup",j)});g.enableAutoHeight=function(){var d=this;if(d.autoHeightEnabled){var m=d.document;d.autoHeightEnabled=true;c=m.body.style.overflowY;m.body.style.overflowY="hidden";d.addListener("contentchange afterinserthtml keyup mouseup",j);setTimeout(function(){j.call(d)},y.gecko?100:0);d.fireEvent("autoheightchanged",
d.autoHeightEnabled)}};g.disableAutoHeight=function(){g.body.style.overflowY=c||"";g.removeListener("contentchange",j);g.removeListener("keyup",j);g.removeListener("mouseup",j);g.autoHeightEnabled=false;g.fireEvent("autoheightchanged",g.autoHeightEnabled)};g.on("setHeight",function(){g.disableAutoHeight()});g.addListener("ready",function(){g.enableAutoHeight();var d;l.on(y.ie?g.body:g.document,y.webkit?"dragover":"drop",function(){clearTimeout(d);d=setTimeout(function(){j.call(g)},100)});var m;window.onscroll=
function(){if(m===null)m=this.scrollY;else if(this.scrollY==0&&m!=0){g.window.scrollTo(0,0);m=null}}})}};UE.plugins.autofloat=function(){function j(){if(!UE.ui){alert(k.autofloatMsg);return 0}return 1}function g(){var u=document.body.style;u.backgroundImage='url("about:blank")';u.backgroundAttachment="fixed"}function c(){var u=l.getXY(o),w=l.getComputedStyle(o,"position"),D=l.getComputedStyle(o,"left");o.style.width=o.offsetWidth+"px";o.style.zIndex=e.options.zIndex*1+1;o.parentNode.insertBefore(q,
o);if(m||h&&y.ie){if(o.style.position!="absolute")o.style.position="absolute";o.style.top=(document.body.scrollTop||document.documentElement.scrollTop)-p+f+"px"}else{if(y.ie7Compat&&s){s=false;o.style.left=l.getXY(o).x-document.documentElement.getBoundingClientRect().left+2+"px"}if(o.style.position!="fixed"){o.style.position="fixed";o.style.top=f+"px";(w=="absolute"||w=="relative")&&parseFloat(D)&&(o.style.left=u.x+"px")}}}function b(){s=true;q.parentNode&&q.parentNode.removeChild(q);o.style.cssText=
n}function a(){var u=r(e.container),w=e.options.toolbarTopOffset||0;u.top<0&&u.bottom-o.offsetHeight>w?c():b()}var e=this,k=e.getLang();e.setOpt({topOffset:0});var f=e.options.topOffset;if(e.options.autoFloatEnabled!==false){var d=UE.ui.uiUtils,m=y.ie&&y.version<=6,h=y.quirks,n,q=document.createElement("div"),o,p,r,s=true,t=v.defer(function(){a()},y.ie?200:100,true);e.addListener("destroy",function(){l.un(window,["scroll","resize"],a);e.removeListener("keydown",t)});e.addListener("ready",function(){if(j(e))if(e.ui){r=
d.getClientRect;o=e.ui.getDom("toolbarbox");p=r(o).top;n=o.style.cssText;q.style.height=o.offsetHeight+"px";m&&g();l.on(window,["scroll","resize"],a);e.addListener("keydown",t);e.addListener("beforefullscreenchange",function(u,w){w&&b()});e.addListener("fullscreenchanged",function(u,w){w||a()});e.addListener("sourcemodechanged",function(){setTimeout(function(){a()},0)});e.addListener("clearDoc",function(){setTimeout(function(){a()},0)})}})}};UE.plugins.video=function(){function j(b,a,e,k,f,d,m){var h;
c.getOpt("basePath");switch(m){case "image":h="<img "+(k?'id="'+k+'"':"")+' width="'+a+'" height="'+e+'" _url="'+b+'" class="'+d.replace(/\bvideo-js\b/,"")+'" src="'+c.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" style="background:url('+c.options.UEDITOR_HOME_URL+"themes/default/images/videologo.gif) no-repeat center center; border:1px solid gray;"+(f?"float:"+f+";":"")+'" />';break;case "embed":h='<embed class="previewVideo" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src='+
UE.ckplay_path+'/ckplayer.swf width="'+a+'" flashvars="f='+v.html(b)+'&p=0" height="'+e+'" wmode="transparent" play="false" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" ></embed>';break;case "video":b.substr(b.lastIndexOf(".")+1);h='<embed class="previewVideo" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" src='+UE.ckplay_path+'/ckplayer.swf width="'+a+'" flashvars="f='+v.html(b)+'&p=0" height="'+e+'" wmode="transparent" play="false" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" ></embed>';
break}return h}function g(b,a){v.each(b.getNodesByTagName(a?"img":"embed video"),function(e){var k=e.getAttr("class");if(k&&k.indexOf("edui-faked-video")!=-1){var f=j(a?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",k,a?"embed":"image");e.parentNode.replaceChild(UE.uNode.createElement(f),e)}if(k&&k.indexOf("edui-upload-video")!=-1){f=j(a?e.getAttr("_url"):e.getAttr("src"),e.getAttr("width"),e.getAttr("height"),null,e.getStyle("float")||"",k,
a?"video":"image");e.parentNode.replaceChild(UE.uNode.createElement(f),e)}})}var c=this;c.addOutputRule(function(b){g(b,true)});c.addInputRule(function(b){g(b)});c.commands.insertvideo={execCommand:function(b,a,e){a=v.isArray(a)?a:[a];var k=[],f;b=0;for(var d,m=a.length;b<m;b++){d=a[b];f=e=="upload"?"edui-upload-video video-js vjs-default-skin":"edui-faked-video";k.push(j(d.url,d.width||420,d.height||280,"tmpVedio"+b,null,f,"image"))}c.execCommand("inserthtml",k.join(""),true);e=this.selection.getRange();
b=0;for(m=a.length;b<m;b++){k=this.document.getElementById("tmpVedio"+b);l.removeAttributes(k,"id");e.selectNode(k).select();c.execCommand("imagefloat",a[b].align)}},queryCommandState:function(){var b=c.selection.getRange().getClosedNode();return b&&(b.className=="edui-faked-video"||b.className.indexOf("edui-upload-video")!=-1)?1:0}}};(function(){function j(){}var g=UE.UETable=function(c){this.table=c;this.indexTable=[];this.selectedTds=[];this.cellsRange={};this.update(c)};g.removeSelectedClass=
function(c){v.each(c,function(b){l.removeClasses(b,"selectTdClass")})};g.addSelectedClass=function(c){v.each(c,function(b){l.addClass(b,"selectTdClass")})};g.isEmptyBlock=function(c){var b=new RegExp(l.fillChar,"g");if(c[y.ie?"innerText":"textContent"].replace(/^\s*$/,"").replace(b,"").length>0)return 0;for(var a in K.$isNotEmpty)if(K.$isNotEmpty.hasOwnProperty(a))if(c.getElementsByTagName(a).length)return 0;return 1};g.getWidth=function(c){if(!c)return 0;return parseInt(l.getComputedStyle(c,"width"),
10)};g.getTableCellAlignState=function(c){!v.isArray(c)&&(c=[c]);var b={},a=["align","valign"],e=null,k=true;v.each(c,function(f){v.each(a,function(d){e=f.getAttribute(d);if(!b[d]&&e)b[d]=e;else if(!b[d]||e!==b[d])return k=false});return k});return k?b:null};g.getTableItemsByRange=function(c){var b=c.selection.getStart();if(b&&b.id&&b.id.indexOf("_baidu_bookmark_start_")===0&&b.nextSibling)b=b.nextSibling;var a=(c=b&&l.findParentByTagName(b,["td","th"],true))&&c.parentNode;b=b&&l.findParentByTagName(b,
"caption",true);return{cell:c,tr:a,table:b?b.parentNode:a&&a.parentNode.parentNode,caption:b}};g.getUETableBySelected=function(c){if((c=g.getTableItemsByRange(c).table)&&c.ueTable&&c.ueTable.selectedTds.length)return c.ueTable;return null};g.getDefaultValue=function(c,b){var a={thin:"0px",medium:"1px",thick:"2px"},e,k;if(b){f=b.getElementsByTagName("td")[0];k=l.getComputedStyle(b,"border-left-width");c=parseInt(a[k]||k,10);k=l.getComputedStyle(f,"padding-left");e=parseInt(a[k]||k,10);k=l.getComputedStyle(f,
"border-left-width");a=parseInt(a[k]||k,10)}else{b=c.document.createElement("table");b.insertRow(0).insertCell(0).innerHTML="xxx";c.body.appendChild(b);var f=b.getElementsByTagName("td")[0];k=l.getComputedStyle(b,"border-left-width");c=parseInt(a[k]||k,10);k=l.getComputedStyle(f,"padding-left");e=parseInt(a[k]||k,10);k=l.getComputedStyle(f,"border-left-width");a=parseInt(a[k]||k,10);l.remove(b)}return{tableBorder:c,tdPadding:e,tdBorder:a}};g.getUETable=function(c){var b=c.tagName.toLowerCase();c=
b=="td"||b=="th"||b=="caption"?l.findParentByTagName(c,"table",true):c;if(!c.ueTable)c.ueTable=new g(c);return c.ueTable};g.cloneCell=function(c,b,a){if(!c||v.isString(c))return this.table.ownerDocument.createElement(c||"td");var e=l.hasClass(c,"selectTdClass");e&&l.removeClasses(c,"selectTdClass");var k=c.cloneNode(true);if(b)k.rowSpan=k.colSpan=1;!a&&l.removeAttributes(k,"width height");!a&&l.removeAttributes(k,"style");k.style.borderLeftStyle="";k.style.borderTopStyle="";k.style.borderLeftColor=
c.style.borderRightColor;k.style.borderLeftWidth=c.style.borderRightWidth;k.style.borderTopColor=c.style.borderBottomColor;k.style.borderTopWidth=c.style.borderBottomWidth;e&&l.addClass(c,"selectTdClass");return k};g.prototype={getMaxRows:function(){for(var c=this.table.rows,b=1,a=0,e;e=c[a];a++){for(var k=1,f=0,d;d=e.cells[f++];)k=Math.max(d.rowSpan||1,k);b=Math.max(k+a,b)}return b},getMaxCols:function(){for(var c=this.table.rows,b=0,a={},e=0,k;k=c[e];e++){for(var f=0,d=0,m;m=k.cells[d++];){f+=m.colSpan||
1;if(m.rowSpan&&m.rowSpan>1)for(var h=1;h<m.rowSpan;h++)if(a["row_"+(e+h)])a["row_"+(e+h)]++;else a["row_"+(e+h)]=m.colSpan||1}f+=a["row_"+e]||0;b=Math.max(f,b)}return b},getCellColIndex:function(){},getHSideCell:function(c,b){try{var a=this.getCellInfo(c),e,k,f=this.selectedTds.length,d=this.cellsRange;if(!b&&(!f?!a.colIndex:!d.beginColIndex)||b&&(!f?a.colIndex==this.colsNum-1:d.endColIndex==this.colsNum-1))return null;e=!f?a.rowIndex:d.beginRowIndex;k=!b?!f?a.colIndex<1?0:a.colIndex-1:d.beginColIndex-
1:!f?a.colIndex+1:d.endColIndex+1;return this.getCell(this.indexTable[e][k].rowIndex,this.indexTable[e][k].cellIndex)}catch(m){j(m)}},getTabNextCell:function(c,b){c=this.getCellInfo(c);b=b||c.rowIndex;c=c.colIndex+1+(c.colSpan-1);var a;try{a=this.getCell(this.indexTable[b][c].rowIndex,this.indexTable[b][c].cellIndex)}catch(e){try{b=b*1+1;c=0;a=this.getCell(this.indexTable[b][c].rowIndex,this.indexTable[b][c].cellIndex)}catch(k){}}return a},getVSideCell:function(c,b,a){try{var e=this.getCellInfo(c),
k,f,d=this.selectedTds.length&&!a,m=this.cellsRange;if(!b&&e.rowIndex==0||b&&(!d?e.rowIndex+e.rowSpan>this.rowsNum-1:m.endRowIndex==this.rowsNum-1))return null;k=!b?!d?e.rowIndex-1:m.beginRowIndex-1:!d?e.rowIndex+e.rowSpan:m.endRowIndex+1;f=!d?e.colIndex:m.beginColIndex;return this.getCell(this.indexTable[k][f].rowIndex,this.indexTable[k][f].cellIndex)}catch(h){j(h)}},getSameEndPosCells:function(c,b){try{var a=b.toLowerCase()==="x",e=l.getXY(c)[a?"x":"y"]+c["offset"+(a?"Width":"Height")],k=this.table.rows;
b=null;for(var f=[],d=0;d<this.rowsNum;d++){b=k[d].cells;for(var m=0,h;h=b[m++];){var n=l.getXY(h)[a?"x":"y"]+h["offset"+(a?"Width":"Height")];if(n>e&&a)break;if(c==h||e==n){if(h[a?"colSpan":"rowSpan"]==1)f.push(h);if(a)break}}}return f}catch(q){j(q)}},setCellContent:function(c,b){c.innerHTML=b||(y.ie?l.fillChar:"<br />")},cloneCell:g.cloneCell,getSameStartPosXCells:function(c){try{var b=l.getXY(c).x+c.offsetWidth,a=this.table.rows,e;c=[];for(var k=0;k<this.rowsNum;k++){e=a[k].cells;for(var f=0,d;d=
e[f++];){var m=l.getXY(d).x;if(m>b)break;if(m==b&&d.colSpan==1){c.push(d);break}}}return c}catch(h){j(h)}},update:function(c){this.table=c||this.table;this.selectedTds=[];this.cellsRange={};this.indexTable=[];c=this.table.rows;for(var b=this.getMaxRows(),a=b-c.length,e=this.getMaxCols();a--;)this.table.insertRow(c.length);this.rowsNum=b;this.colsNum=e;a=0;for(var k=c.length;a<k;a++)this.indexTable[a]=new Array(e);a=0;for(var f;f=c[a];a++){k=0;var d;for(f=f.cells;d=f[k];k++){if(d.rowSpan>b)d.rowSpan=
b;var m=k,h=d.rowSpan||1;for(d=d.colSpan||1;this.indexTable[a][m];)m++;for(var n=0;n<h;n++)for(var q=0;q<d;q++)this.indexTable[a+n][m+q]={rowIndex:a,cellIndex:k,colIndex:m,rowSpan:h,colSpan:d}}}for(n=0;n<b;n++)for(q=0;q<e;q++)if(this.indexTable[n][q]===undefined){f=c[n];d=(d=f.cells[f.cells.length-1])?d.cloneNode(true):this.table.ownerDocument.createElement("td");this.setCellContent(d);if(d.colSpan!==1)d.colSpan=1;if(d.rowSpan!==1)d.rowSpan=1;f.appendChild(d);this.indexTable[n][q]={rowIndex:n,cellIndex:d.cellIndex,
colIndex:q,rowSpan:1,colSpan:1}}c=l.getElementsByTagName(this.table,"td");var o=[];v.each(c,function(p){l.hasClass(p,"selectTdClass")&&o.push(p)});if(o.length){b=o[o.length-1];c=this.getCellInfo(o[0]);b=this.getCellInfo(b);this.selectedTds=o;this.cellsRange={beginRowIndex:c.rowIndex,beginColIndex:c.colIndex,endRowIndex:b.rowIndex+b.rowSpan-1,endColIndex:b.colIndex+b.colSpan-1}}if(!l.hasClass(this.table.rows[0],"firstRow")){l.addClass(this.table.rows[0],"firstRow");for(a=1;a<this.table.rows.length;a++)l.removeClasses(this.table.rows[a],
"firstRow")}},getCellInfo:function(c){if(c){var b=c.cellIndex;c=c.parentNode.rowIndex;for(var a=this.indexTable[c],e=this.colsNum,k=b;k<e;k++){var f=a[k];if(f.rowIndex===c&&f.cellIndex===b)return f}}},getCell:function(c,b){return c<this.rowsNum&&this.table.rows[c].cells[b]||null},deleteCell:function(c,b){b=typeof b=="number"?b:c.parentNode.rowIndex;this.table.rows[b].deleteCell(c.cellIndex)},getCellsRange:function(c,b){function a(o,p,r,s){var t=o,u=p,w=r,D=s,z,F,I;if(o>0)for(F=p;F<s;F++){z=e.indexTable[o][F];
I=z.rowIndex;if(I<o)t=Math.min(I,t)}if(s<e.colsNum)for(I=o;I<r;I++){z=e.indexTable[I][s];F=z.colIndex+z.colSpan-1;if(F>s)D=Math.max(F,D)}if(r<e.rowsNum)for(F=p;F<s;F++){z=e.indexTable[r][F];I=z.rowIndex+z.rowSpan-1;if(I>r)w=Math.max(I,w)}if(p>0)for(I=o;I<r;I++){z=e.indexTable[I][p];F=z.colIndex;if(F<p)u=Math.min(z.colIndex,u)}return t!=o||u!=p||w!=r||D!=s?a(t,u,w,D):{beginRowIndex:o,beginColIndex:p,endRowIndex:r,endColIndex:s}}try{var e=this,k=e.getCellInfo(c);if(c===b)return{beginRowIndex:k.rowIndex,
beginColIndex:k.colIndex,endRowIndex:k.rowIndex+k.rowSpan-1,endColIndex:k.colIndex+k.colSpan-1};var f=e.getCellInfo(b),d=Math.min(k.rowIndex,f.rowIndex),m=Math.min(k.colIndex,f.colIndex),h=Math.max(k.rowIndex+k.rowSpan-1,f.rowIndex+f.rowSpan-1),n=Math.max(k.colIndex+k.colSpan-1,f.colIndex+f.colSpan-1);return a(d,m,h,n)}catch(q){}},getCells:function(c){this.clearSelected();for(var b=c.beginColIndex,a=c.endRowIndex,e=c.endColIndex,k,f,d={},m=[],h=c.beginRowIndex;h<=a;h++)for(var n=b;n<=e;n++){c=this.indexTable[h][n];
k=c.rowIndex;f=c.colIndex;var q=k+"|"+f;if(!d[q]){d[q]=1;if(k<h||f<n||k+c.rowSpan-1>a||f+c.colSpan-1>e)return null;m.push(this.getCell(k,c.cellIndex))}}return m},clearSelected:function(){g.removeSelectedClass(this.selectedTds);this.selectedTds=[];this.cellsRange={}},setSelected:function(c){var b=this.getCells(c);g.addSelectedClass(b);this.selectedTds=b;this.cellsRange=c},isFullRow:function(){var c=this.cellsRange;return c.endColIndex-c.beginColIndex+1==this.colsNum},isFullCol:function(){var c=this.cellsRange,
b=this.table.getElementsByTagName("th");c=c.endRowIndex-c.beginRowIndex+1;return!b.length?c==this.rowsNum:c==this.rowsNum||c==this.rowsNum-1},getNextCell:function(c,b,a){try{var e=this.getCellInfo(c),k,f,d=this.selectedTds.length&&!a,m=this.cellsRange;if(!b&&e.rowIndex==0||b&&(!d?e.rowIndex+e.rowSpan>this.rowsNum-1:m.endRowIndex==this.rowsNum-1))return null;k=!b?!d?e.rowIndex-1:m.beginRowIndex-1:!d?e.rowIndex+e.rowSpan:m.endRowIndex+1;f=!d?e.colIndex:m.beginColIndex;return this.getCell(this.indexTable[k][f].rowIndex,
this.indexTable[k][f].cellIndex)}catch(h){j(h)}},getPreviewCell:function(c,b){try{var a=this.getCellInfo(c),e,k,f=this.selectedTds.length,d=this.cellsRange;if(!b&&(!f?!a.colIndex:!d.beginColIndex)||b&&(!f?a.rowIndex>this.colsNum-1:d.endColIndex==this.colsNum-1))return null;e=!b?!f?a.rowIndex:d.beginRowIndex:!f?a.rowIndex<1?0:a.rowIndex-1:d.beginRowIndex;k=!b?!f?a.colIndex<1?0:a.colIndex-1:d.beginColIndex-1:!f?a.colIndex:d.endColIndex+1;return this.getCell(this.indexTable[e][k].rowIndex,this.indexTable[e][k].cellIndex)}catch(m){j(m)}},
moveContent:function(c,b){if(!g.isEmptyBlock(b))if(g.isEmptyBlock(c))c.innerHTML=b.innerHTML;else{var a=c.lastChild;if(a.nodeType==3||!K.$block[a.tagName])c.appendChild(c.ownerDocument.createElement("br"));for(;a=b.firstChild;)c.appendChild(a)}},mergeRight:function(c){var b=this.getCellInfo(c),a=this.indexTable[b.rowIndex][b.colIndex+b.colSpan],e=this.getCell(a.rowIndex,a.cellIndex);c.colSpan=b.colSpan+a.colSpan;c.removeAttribute("width");this.moveContent(c,e);this.deleteCell(e,a.rowIndex);this.update()},
mergeDown:function(c){var b=this.getCellInfo(c),a=this.indexTable[b.rowIndex+b.rowSpan][b.colIndex],e=this.getCell(a.rowIndex,a.cellIndex);c.rowSpan=b.rowSpan+a.rowSpan;c.removeAttribute("height");this.moveContent(c,e);this.deleteCell(e,a.rowIndex);this.update()},mergeRange:function(){var c=this.cellsRange,b=this.getCell(c.beginRowIndex,this.indexTable[c.beginRowIndex][c.beginColIndex].cellIndex);if(b.tagName=="TH"&&c.endRowIndex!==c.beginRowIndex){var a=this.indexTable;c=this.getCellInfo(b);b=this.getCell(1,
a[1][c.colIndex].cellIndex);c=this.getCellsRange(b,this.getCell(a[this.rowsNum-1][c.colIndex].rowIndex,a[this.rowsNum-1][c.colIndex].cellIndex))}var e=this.getCells(c);a=0;for(var k;k=e[a++];)if(k!==b){this.moveContent(b,k);this.deleteCell(k)}b.rowSpan=c.endRowIndex-c.beginRowIndex+1;b.rowSpan>1&&b.removeAttribute("height");b.colSpan=c.endColIndex-c.beginColIndex+1;b.colSpan>1&&b.removeAttribute("width");if(b.rowSpan==this.rowsNum&&b.colSpan!=1)b.colSpan=1;if(b.colSpan==this.colsNum&&b.rowSpan!=1){e=
b.parentNode.rowIndex;if(this.table.deleteRow){a=e+1;e=e+1;for(c=b.rowSpan;a<c;a++)this.table.deleteRow(e)}else{a=0;for(c=b.rowSpan-1;a<c;a++){k=this.table.rows[e+1];k.parentNode.removeChild(k)}}b.rowSpan=1}this.update()},insertRow:function(c,b){function a(q,o,p){if(q==0){q=(p.nextSibling||p.previousSibling).cells[q];if(q.tagName=="TH"){q=o.ownerDocument.createElement("th");q.appendChild(o.firstChild);p.insertBefore(q,o);l.remove(o)}}else if(o.tagName=="TH"){q=o.ownerDocument.createElement("td");
q.appendChild(o.firstChild);p.insertBefore(q,o);l.remove(o)}}var e=this.colsNum,k=this.table.insertRow(c),f,d=typeof b=="string"&&b.toUpperCase()=="TH";if(c==0||c==this.rowsNum)for(var m=0;m<e;m++){f=this.cloneCell(b,true);this.setCellContent(f);f.getAttribute("vAlign")&&f.setAttribute("vAlign",f.getAttribute("vAlign"));k.appendChild(f);d||a(m,f,k)}else{var h=this.indexTable[c];for(m=0;m<e;m++){var n=h[m];if(n.rowIndex<c){f=this.getCell(n.rowIndex,n.cellIndex);f.rowSpan=n.rowSpan+1}else{f=this.cloneCell(b,
true);this.setCellContent(f);k.appendChild(f)}d||a(m,f,k)}}this.update();return k},deleteRow:function(c){for(var b=this.table.rows[c],a=this.indexTable[c],e=this.colsNum,k=0,f=0;f<e;){var d=a[f],m=this.getCell(d.rowIndex,d.cellIndex);if(m.rowSpan>1)if(d.rowIndex==c){d=m.cloneNode(true);d.rowSpan=m.rowSpan-1;d.innerHTML="";m.rowSpan=1;var h=c+1,n=this.table.rows[h];h=this.getPreviewMergedCellsNum(h,f)-k;if(h<f){h=f-h-1;l.insertAfter(n.cells[h],d)}else n.cells.length&&n.insertBefore(d,n.cells[0]);k+=
1}f+=m.colSpan||1}c=[];k={};for(f=0;f<e;f++){m=a[f].rowIndex;d=a[f].cellIndex;n=m+"_"+d;if(!k[n]){k[n]=1;m=this.getCell(m,d);c.push(m)}}var q=[];v.each(c,function(o){o.rowSpan==1?o.parentNode.removeChild(o):q.push(o)});v.each(q,function(o){o.rowSpan--});b.parentNode.removeChild(b);this.update()},insertCol:function(c,b,a){function e(o,p,r){if(o==0){o=p.nextSibling||p.previousSibling;if(o.tagName=="TH"){o=p.ownerDocument.createElement("th");o.appendChild(p.firstChild);r.insertBefore(o,p);l.remove(p)}}else if(p.tagName==
"TH"){o=p.ownerDocument.createElement("td");o.appendChild(p.firstChild);r.insertBefore(o,p);l.remove(p)}}var k=this.rowsNum,f=0,d,m,h=parseInt((this.table.offsetWidth-(this.colsNum+1)*20-(this.colsNum+1))/(this.colsNum+1),10),n=typeof b=="string"&&b.toUpperCase()=="TH",q;if(c==0||c==this.colsNum)for(;f<k;f++){d=this.table.rows[f];q=d.cells[c==0?c:d.cells.length];m=this.cloneCell(b,true);this.setCellContent(m);m.setAttribute("vAlign",m.getAttribute("vAlign"));q&&m.setAttribute("width",q.getAttribute("width"));
c?l.insertAfter(d.cells[d.cells.length-1],m):d.insertBefore(m,d.cells[0]);n||e(f,m,d)}else for(;f<k;f++){q=this.indexTable[f][c];if(q.colIndex<c){m=this.getCell(q.rowIndex,q.cellIndex);m.colSpan=q.colSpan+1}else{d=this.table.rows[f];q=d.cells[q.cellIndex];m=this.cloneCell(b,true);this.setCellContent(m);m.setAttribute("vAlign",m.getAttribute("vAlign"));q&&m.setAttribute("width",q.getAttribute("width"));q?d.insertBefore(m,q):d.appendChild(m)}n||e(f,m,d)}this.update();this.updateWidth(h,a||{tdPadding:10,
tdBorder:1})},updateWidth:function(c,b){var a=this.table;b=g.getWidth(a)-b.tdPadding*2-b.tdBorder+c;if(b<a.ownerDocument.body.offsetWidth)a.setAttribute("width",b);else{a=l.getElementsByTagName(this.table,"td th");v.each(a,function(e){e.setAttribute("width",c)})}},deleteCol:function(c){for(var b=this.indexTable,a=this.table.rows,e=this.table.getAttribute("width"),k=0,f=this.rowsNum,d={},m=0;m<f;){var h=b[m][c],n=h.rowIndex+"_"+h.colIndex;if(!d[n]){d[n]=1;n=this.getCell(h.rowIndex,h.cellIndex);k||
(k=n&&parseInt(n.offsetWidth/n.colSpan,10).toFixed(0));if(n.colSpan>1)n.colSpan--;else a[m].deleteCell(h.cellIndex);m+=h.rowSpan||1}}this.table.setAttribute("width",e-k);this.update()},splitToCells:function(c){var b=this;c=this.splitToRows(c);v.each(c,function(a){b.splitToCols(a)})},splitToRows:function(c){var b=this.getCellInfo(c),a=b.rowIndex,e=b.colIndex,k=[];c.rowSpan=1;k.push(c);for(var f=a,d=a+b.rowSpan;f<d;f++)if(f!=a){var m=this.table.rows[f].insertCell(e-this.getPreviewMergedCellsNum(f,e));
m.colSpan=b.colSpan;this.setCellContent(m);m.setAttribute("vAlign",c.getAttribute("vAlign"));m.setAttribute("align",c.getAttribute("align"));if(c.style.cssText)m.style.cssText=c.style.cssText;k.push(m)}this.update();return k},getPreviewMergedCellsNum:function(c,b){for(var a=this.indexTable[c],e=0,k=0;k<b;){var f=a[k].colSpan;e+=f-(a[k].rowIndex==c?1:0);k+=f}return e},splitToCols:function(c){var b=(c.offsetWidth/c.colSpan-22).toFixed(0),a=this.getCellInfo(c),e=a.rowIndex,k=a.colIndex,f=[];c.colSpan=
1;c.setAttribute("width",b);f.push(c);for(var d=k,m=k+a.colSpan;d<m;d++)if(d!=k){var h=this.table.rows[e],n=h.insertCell(this.indexTable[e][d].cellIndex+1);n.rowSpan=a.rowSpan;this.setCellContent(n);n.setAttribute("vAlign",c.getAttribute("vAlign"));n.setAttribute("align",c.getAttribute("align"));n.setAttribute("width",b);if(c.style.cssText)n.style.cssText=c.style.cssText;if(c.tagName=="TH"){var q=c.ownerDocument.createElement("th");q.appendChild(n.firstChild);q.setAttribute("vAlign",c.getAttribute("vAlign"));
q.rowSpan=n.rowSpan;h.insertBefore(q,n);l.remove(n)}f.push(n)}this.update();return f},isLastCell:function(c,b,a){b=b||this.rowsNum;a=a||this.colsNum;c=this.getCellInfo(c);return c.rowIndex+c.rowSpan==b&&c.colIndex+c.colSpan==a},getLastCell:function(c){c=c||this.table.getElementsByTagName("td");this.getCellInfo(c[0]);var b=this,a=c[0],e=a.parentNode,k=0,f=0,d;v.each(c,function(m){if(m.parentNode==e)f+=m.colSpan||1;k+=m.rowSpan*m.colSpan||1});d=k/f;v.each(c,function(m){if(b.isLastCell(m,d,f)){a=m;return false}});
return a},selectRow:function(c){var b=this.indexTable[c];c=this.getCell(b[0].rowIndex,b[0].cellIndex);b=this.getCell(b[this.colsNum-1].rowIndex,b[this.colsNum-1].cellIndex);this.setSelected(this.getCellsRange(c,b))},selectTable:function(){var c=this.table.getElementsByTagName("td");this.setSelected(this.getCellsRange(c[0],c[c.length-1]))},setBackground:function(c,b){if(typeof b==="string")v.each(c,function(n){n.style.backgroundColor=b});else if(typeof b==="object"){b=v.extend({repeat:true,colorList:["#ddd",
"#fff"]},b);for(var a=this.getCellInfo(c[0]).rowIndex,e=0,k=b.colorList,f=function(n,q,o){return n[q]?n[q]:o?n[q%n.length]:""},d=0,m;m=c[d++];){var h=this.getCellInfo(m);m.style.backgroundColor=f(k,a+e==h.rowIndex?e:++e,b.repeat)}}},removeBackground:function(c){v.each(c,function(b){b.style.backgroundColor=""})}}})();(function(){function j(d,m){var h=l.getElementsByTagName(d,"td th");v.each(h,function(q){q.removeAttribute("width")});d.setAttribute("width",g(m,true,k(m,d)));var n=[];setTimeout(function(){v.each(h,
function(q){q.colSpan==1&&n.push(q.offsetWidth)});v.each(h,function(q,o){q.colSpan==1&&q.setAttribute("width",n[o]+"")})},0)}function g(d,m,h){var n=d.body;return n.offsetWidth-(m?parseInt(l.getComputedStyle(n,"margin-left"),10)*2:0)-h.tableBorder*2-(d.options.offsetWidth||0)}function c(d){if(d=a(d).cell){var m=f(d);return m.selectedTds.length?m.selectedTds:[d]}else return[]}var b=UE.UETable,a=function(d){return b.getTableItemsByRange(d)},e=function(d){return b.getUETableBySelected(d)},k=function(d,
m){return b.getDefaultValue(d,m)},f=function(d){return b.getUETable(d)};UE.commands.inserttable={queryCommandState:function(){return a(this).table?-1:0},execCommand:function(d,m){function h(o,p){for(var r=[],s=o.numRows,t=o.numCols,u=0;u<s;u++){r.push("<tr"+(u==0?' class="firstRow"':"")+">");for(var w=0;w<t;w++)r.push('<td width="'+p+'"  vAlign="'+o.tdvalign+'" >'+(y.ie&&y.version<11?l.fillChar:"<br/>")+"</td>");r.push("</tr>")}return"<table><tbody>"+r.join("")+"</tbody></table>"}m||(m=v.extend({},
{numCols:this.options.defaultCols,numRows:this.options.defaultRows,tdvalign:this.options.tdvalign}));d=this;var n=this.selection.getRange().startContainer;n=l.findParent(n,function(o){return l.isBlockElm(o)},true)||d.body;var q=k(d);n=Math.floor(n.offsetWidth/m.numCols-q.tdPadding*2-q.tdBorder);!m.tdvalign&&(m.tdvalign=d.options.tdvalign);d.execCommand("inserthtml",h(m,n))}};UE.commands.insertparagraphbeforetable={queryCommandState:function(){return a(this).cell?0:-1},execCommand:function(){var d=
a(this).table;if(d){var m=this.document.createElement("p");m.innerHTML=y.ie?"&nbsp;":"<br />";d.parentNode.insertBefore(m,d);this.selection.getRange().setStart(m,0).setCursor()}}};UE.commands.deletetable={queryCommandState:function(){var d=this.selection.getRange();return l.findParentByTagName(d.startContainer,"table",true)?0:-1},execCommand:function(d,m){d=this.selection.getRange();if(m=m||l.findParentByTagName(d.startContainer,"table",true)){var h=m.nextSibling;if(!h){h=l.createElement(this.document,
"p",{innerHTML:y.ie?l.fillChar:"<br/>"});m.parentNode.insertBefore(h,m)}l.remove(m);d=this.selection.getRange();h.nodeType==3?d.setStartBefore(h):d.setStart(h,0);d.setCursor(false,true);this.fireEvent("tablehasdeleted")}}};UE.commands.cellalign={queryCommandState:function(){return c(this).length?0:-1},execCommand:function(d,m){d=c(this);if(d.length)for(var h=0,n;n=d[h++];)n.setAttribute("align",m)}};UE.commands.cellvalign={queryCommandState:function(){return c(this).length?0:-1},execCommand:function(d,
m){d=c(this);if(d.length)for(var h=0,n;n=d[h++];)n.setAttribute("vAlign",m)}};UE.commands.insertcaption={queryCommandState:function(){var d=a(this).table;if(d)return d.getElementsByTagName("caption").length==0?1:-1;return-1},execCommand:function(){var d=a(this).table;if(d){var m=this.document.createElement("caption");m.innerHTML=y.ie?l.fillChar:"<br/>";d.insertBefore(m,d.firstChild);this.selection.getRange().setStart(m,0).setCursor()}}};UE.commands.deletecaption={queryCommandState:function(){var d=
this.selection.getRange();if(d=l.findParentByTagName(d.startContainer,"table"))return d.getElementsByTagName("caption").length==0?-1:1;return-1},execCommand:function(){var d=this.selection.getRange();if(d=l.findParentByTagName(d.startContainer,"table")){l.remove(d.getElementsByTagName("caption")[0]);this.selection.getRange().setStart(d.rows[0].cells[0],0).setCursor()}}};UE.commands.inserttitle={queryCommandState:function(){var d=a(this).table;if(d){d=d.rows[0];return d.cells[d.cells.length-1].tagName.toLowerCase()!=
"th"?0:-1}return-1},execCommand:function(){var d=a(this).table;d&&f(d).insertRow(0,"th");d=d.getElementsByTagName("th")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.deletetitle={queryCommandState:function(){var d=a(this).table;if(d){d=d.rows[0];return d.cells[d.cells.length-1].tagName.toLowerCase()=="th"?0:-1}return-1},execCommand:function(){var d=a(this).table;d&&l.remove(d.rows[0]);d=d.getElementsByTagName("td")[0];this.selection.getRange().setStart(d,0).setCursor(false,
true)}};UE.commands.inserttitlecol={queryCommandState:function(){var d=a(this).table;if(d)return d.rows[d.rows.length-1].getElementsByTagName("th").length?-1:0;return-1},execCommand:function(){var d=a(this).table;d&&f(d).insertCol(0,"th");j(d,this);d=d.getElementsByTagName("th")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.deletetitlecol={queryCommandState:function(){var d=a(this).table;if(d)return d.rows[d.rows.length-1].getElementsByTagName("th").length?0:-1;return-1},
execCommand:function(){var d=a(this).table;if(d)for(var m=0;m<d.rows.length;m++)l.remove(d.rows[m].children[0]);j(d,this);d=d.getElementsByTagName("td")[0];this.selection.getRange().setStart(d,0).setCursor(false,true)}};UE.commands.mergeright={queryCommandState:function(){var d=a(this),m=d.table;d=d.cell;if(!m||!d)return-1;var h=f(m);if(h.selectedTds.length)return-1;var n=h.getCellInfo(d),q=n.colIndex+n.colSpan;if(q>=h.colsNum)return-1;h=h.indexTable[n.rowIndex][q];m=m.rows[h.rowIndex].cells[h.cellIndex];
if(!m||d.tagName!=m.tagName)return-1;return h.rowIndex==n.rowIndex&&h.rowSpan==n.rowSpan?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell;f(h).mergeRight(h);d.moveToBookmark(m).select()}};UE.commands.mergedown={queryCommandState:function(){var d=a(this),m=d.table;d=d.cell;if(!m||!d)return-1;var h=f(m);if(h.selectedTds.length)return-1;var n=h.getCellInfo(d),q=n.rowIndex+n.rowSpan;if(q>=h.rowsNum)return-1;h=h.indexTable[q][n.colIndex];m=m.rows[h.rowIndex].cells[h.cellIndex];
if(!m||d.tagName!=m.tagName)return-1;return h.colIndex==n.colIndex&&h.colSpan==n.colSpan?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell;f(h).mergeDown(h);d.moveToBookmark(m).select()}};UE.commands.mergecells={queryCommandState:function(){return e(this)?0:-1},execCommand:function(){var d=e(this);if(d&&d.selectedTds.length){var m=d.selectedTds[0];d.mergeRange();d=this.selection.getRange();l.isEmptyBlock(m)?d.setStart(m,0).collapse(true):d.selectNodeContents(m);
d.select()}}};UE.commands.insertrow={queryCommandState:function(){var d=a(this),m=d.cell;return m&&(m.tagName=="TD"||m.tagName=="TH"&&d.tr!==d.table.rows[0])&&f(d.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this),n=h.cell;h=h.table;var q=f(h),o=q.getCellInfo(n);if(q.selectedTds.length){o=q.cellsRange;for(var p=0,r=o.endRowIndex-o.beginRowIndex+1;p<r;p++)q.insertRow(o.beginRowIndex,n)}else q.insertRow(o.rowIndex,n);
d.moveToBookmark(m).select();h.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",h)}};UE.commands.insertrownext={queryCommandState:function(){var d=a(this),m=d.cell;return m&&m.tagName=="TD"&&f(d.table).rowsNum<this.options.maxRowNum?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this),n=h.cell;h=h.table;var q=f(h),o=q.getCellInfo(n);if(q.selectedTds.length){o=q.cellsRange;for(var p=0,r=o.endRowIndex-o.beginRowIndex+1;p<r;p++)q.insertRow(o.endRowIndex+
1,n)}else q.insertRow(o.rowIndex+o.rowSpan,n);d.moveToBookmark(m).select();h.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",h)}};UE.commands.deleterow={queryCommandState:function(){return a(this).cell?0:-1},execCommand:function(){var d=a(this).cell,m=f(d),h=m.cellsRange,n=m.getCellInfo(d),q=m.getVSideCell(d),o=m.getVSideCell(d,true);d=this.selection.getRange();if(v.isEmptyObject(h))m.deleteRow(n.rowIndex);else for(var p=h.beginRowIndex;p<h.endRowIndex+1;p++)m.deleteRow(h.beginRowIndex);
p=m.table;if(p.getElementsByTagName("td").length)if(n.rowSpan==1||n.rowSpan==h.endRowIndex-h.beginRowIndex+1){if(o||q)d.selectNodeContents(o||q).setCursor(false,true)}else(m=m.getCell(n.rowIndex,m.indexTable[n.rowIndex][n.colIndex].cellIndex))&&d.selectNodeContents(m).setCursor(false,true);else{m=p.nextSibling;l.remove(p);m&&d.setStart(m,0).setCursor(false,true)}p.getAttribute("interlaced")==="enabled"&&this.fireEvent("interlacetable",p)}};UE.commands.insertcol={queryCommandState:function(){var d=
a(this),m=d.cell;return m&&(m.tagName=="TD"||m.tagName=="TH"&&m!==d.tr.cells[0])&&f(d.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(d){var m=this.selection.getRange(),h=m.createBookmark(true);if(this.queryCommandState(d)!=-1){d=a(this).cell;var n=f(d),q=n.getCellInfo(d);if(n.selectedTds.length){q=n.cellsRange;for(var o=0,p=q.endColIndex-q.beginColIndex+1;o<p;o++)n.insertCol(q.beginColIndex,d)}else n.insertCol(q.colIndex,d);m.moveToBookmark(h).select(true)}}};UE.commands.insertcolnext=
{queryCommandState:function(){var d=a(this);return d.cell&&f(d.table).colsNum<this.options.maxColNum?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell,n=f(h),q=n.getCellInfo(h);if(n.selectedTds.length){q=n.cellsRange;for(var o=0,p=q.endColIndex-q.beginColIndex+1;o<p;o++)n.insertCol(q.endColIndex+1,h)}else n.insertCol(q.colIndex+q.colSpan,h);d.moveToBookmark(m).select()}};UE.commands.deletecol={queryCommandState:function(){return a(this).cell?0:-1},
execCommand:function(){var d=a(this).cell,m=f(d),h=m.cellsRange,n=m.getCellInfo(d),q=m.getHSideCell(d),o=m.getHSideCell(d,true);if(v.isEmptyObject(h))m.deleteCol(n.colIndex);else for(n=h.beginColIndex;n<h.endColIndex+1;n++)m.deleteCol(h.beginColIndex);m=m.table;h=this.selection.getRange();if(m.getElementsByTagName("td").length)if(l.inDoc(d,this.document))h.setStart(d,0).setCursor(false,true);else if(o&&l.inDoc(o,this.document))h.selectNodeContents(o).setCursor(false,true);else q&&l.inDoc(q,this.document)&&
h.selectNodeContents(q).setCursor(true,true);else{d=m.nextSibling;l.remove(m);d&&h.setStart(d,0).setCursor(false,true)}}};UE.commands.splittocells={queryCommandState:function(){var d=a(this),m=d.cell;if(!m)return-1;if(f(d.table).selectedTds.length>0)return-1;return m&&(m.colSpan>1||m.rowSpan>1)?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell;f(h).splitToCells(h);d.moveToBookmark(m).select()}};UE.commands.splittorows={queryCommandState:function(){var d=
a(this),m=d.cell;if(!m)return-1;if(f(d.table).selectedTds.length>0)return-1;return m&&m.rowSpan>1?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell;f(h).splitToRows(h);d.moveToBookmark(m).select()}};UE.commands.splittocols={queryCommandState:function(){var d=a(this),m=d.cell;if(!m)return-1;if(f(d.table).selectedTds.length>0)return-1;return m&&m.colSpan>1?0:-1},execCommand:function(){var d=this.selection.getRange(),m=d.createBookmark(true),h=a(this).cell;
f(h).splitToCols(h);d.moveToBookmark(m).select()}};UE.commands.adaptbytext=UE.commands.adaptbywindow={queryCommandState:function(){return a(this).table?0:-1},execCommand:function(d){var m=a(this).table;if(m)if(d=="adaptbywindow")j(m,this);else{d=l.getElementsByTagName(m,"td th");v.each(d,function(h){h.removeAttribute("width")});m.removeAttribute("width")}}};UE.commands.averagedistributecol={queryCommandState:function(){var d=e(this);if(!d)return-1;return d.isFullRow()||d.isFullCol()?0:-1},execCommand:function(){function d(){var q=
n.table,o=0,p=0,r=k(h,q);if(n.isFullRow()){o=q.offsetWidth;p=n.colsNum}else{q=n.cellsRange.endColIndex;for(var s,t=n.cellsRange.beginColIndex;t<=q;){s=n.selectedTds[t];o+=s.offsetWidth;t+=s.colSpan;p+=1}}return Math.ceil(o/p)-r.tdBorder*2-r.tdPadding*2}function m(q){v.each(l.getElementsByTagName(n.table,"th"),function(p){p.setAttribute("width","")});var o=n.isFullRow()?l.getElementsByTagName(n.table,"td"):n.selectedTds;v.each(o,function(p){p.colSpan==1&&p.setAttribute("width",q)})}var h=this,n=e(h);
n&&n.selectedTds.length&&m(d())}};UE.commands.averagedistributerow={queryCommandState:function(){var d=e(this);if(!d)return-1;if(d.selectedTds&&/th/ig.test(d.selectedTds[0].tagName))return-1;return d.isFullRow()||d.isFullCol()?0:-1},execCommand:function(){function d(){var q,o=0;q=n.table;var p=k(h,q),r=parseInt(l.getComputedStyle(q.getElementsByTagName("td")[0],"padding-top"));if(n.isFullCol()){o=l.getElementsByTagName(q,"caption");var s=l.getElementsByTagName(q,"th"),t,u;if(o.length>0)t=o[0].offsetHeight;
if(s.length>0)u=s[0].offsetHeight;o=q.offsetHeight-(t||0)-(u||0);q=s.length==0?n.rowsNum:n.rowsNum-1}else{u=n.cellsRange.beginRowIndex;s=n.cellsRange.endRowIndex;t=0;q=l.getElementsByTagName(q,"tr");for(u=u;u<=s;u++){o+=q[u].offsetHeight;t+=1}q=t}return y.ie&&y.version<9?Math.ceil(o/q):Math.ceil(o/q)-p.tdBorder*2-r*2}function m(q){var o=n.isFullCol()?l.getElementsByTagName(n.table,"td"):n.selectedTds;v.each(o,function(p){p.rowSpan==1&&p.setAttribute("height",q)})}var h=this,n=e(h);n&&n.selectedTds.length&&
m(d())}};UE.commands.cellalignment={queryCommandState:function(){return a(this).table?0:-1},execCommand:function(d,m){d=this;var h=e(d);if(h)v.each(h.selectedTds,function(n){l.setAttributes(n,m)});else{h=(h=d.selection.getStart())&&l.findParentByTagName(h,["td","th","caption"],true);if(/caption/ig.test(h.tagName)){h.style.textAlign=m.align;h.style.verticalAlign=m.vAlign}else l.setAttributes(h,m);d.selection.getRange().setCursor(true)}},queryCommandValue:function(){var d=a(this).cell;d||(d=c(this)[0]);
if(d){var m=UE.UETable.getUETable(d).selectedTds;!m.length&&(m=d);return UE.UETable.getTableCellAlignState(m)}else return null}};UE.commands.tablealignment={queryCommandState:function(){if(y.ie&&y.version<8)return-1;return a(this).table?0:-1},execCommand:function(d,m){(d=(d=this.selection.getStart())&&l.findParentByTagName(d,["table"],true))&&d.setAttribute("align",m)}};UE.commands.edittable={queryCommandState:function(){return a(this).table?0:-1},execCommand:function(d,m){d=this.selection.getRange();
if(d=l.findParentByTagName(d.startContainer,"table")){d=l.getElementsByTagName(d,"td").concat(l.getElementsByTagName(d,"th"),l.getElementsByTagName(d,"caption"));v.each(d,function(h){h.style.borderColor=m})}}};UE.commands.edittd={queryCommandState:function(){return a(this).table?0:-1},execCommand:function(d,m){d=this;var h=e(d);if(h)v.each(h.selectedTds,function(n){n.style.backgroundColor=m});else if(d=(d=d.selection.getStart())&&l.findParentByTagName(d,["td","th","caption"],true))d.style.backgroundColor=
m}};UE.commands.settablebackground={queryCommandState:function(){return c(this).length>1?0:-1},execCommand:function(d,m){d=c(this);f(d[0]).setBackground(d,m)}};UE.commands.cleartablebackground={queryCommandState:function(){var d=c(this);if(!d.length)return-1;for(var m=0,h;h=d[m++];)if(h.style.backgroundColor!=="")return 0;return-1},execCommand:function(){var d=c(this);f(d[0]).removeBackground(d)}};UE.commands.interlacetable=UE.commands.uninterlacetable={queryCommandState:function(d){var m=a(this).table;
if(!m)return-1;m=m.getAttribute("interlaced");return d=="interlacetable"?m==="enabled"?-1:0:!m||m==="disabled"?-1:0},execCommand:function(d,m){var h=a(this).table;if(d=="interlacetable"){h.setAttribute("interlaced","enabled");this.fireEvent("interlacetable",h,m)}else{h.setAttribute("interlaced","disabled");this.fireEvent("uninterlacetable",h)}}};UE.commands.setbordervisible={queryCommandState:function(){if(!a(this).table)return-1;return 0},execCommand:function(){var d=a(this).table;v.each(l.getElementsByTagName(d,
"td"),function(m){m.style.borderWidth="1px";m.style.borderStyle="solid"})}}})();UE.plugins.table=function(){function j(){}function g(x){c(x,"width",true);c(x,"height",true)}function c(x,A,C){if(x.style[A]){C&&x.setAttribute(A,parseInt(x.style[A],10));x.style[A]=""}}function b(x){if(x.tagName=="TD"||x.tagName=="TH")return x;if(x=l.findParentByTagName(x,"td",true)||l.findParentByTagName(x,"th",true))return x;return null}function a(x){var A=new RegExp(l.fillChar,"g");if(x[y.ie?"innerText":"textContent"].replace(/^\s*$/,
"").replace(A,"").length>0)return 0;for(var C in K.$isNotEmpty)if(x.getElementsByTagName(C).length)return 0;return 1}function e(x){if(x.pageX||x.pageY)return{x:x.pageX,y:x.pageY};return{x:x.clientX+J.document.body.scrollLeft-J.document.body.clientLeft,y:x.clientY+J.document.body.scrollTop-J.document.body.clientTop}}function k(x){if(!X())try{var A=b(x.target||x.srcElement),C;if(ra){J.body.style.webkitUserSelect="none";if(Math.abs(ua.x-x.clientX)>Ja||Math.abs(ua.y-x.clientY)>Ja){w();ra=false;ha=0;z(x)}}if(la&&
ia){ha=0;J.body.style.webkitUserSelect="none";J.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();C=e(x);q(J,true,la,C,A);if(la=="h")ka.style.left=h(ia,x)+"px";else if(la=="v")ka.style.top=n(ia,x)+"px"}else if(A){if(J.fireEvent("excludetable",A)!==true){C=e(x);var G=o(A,C),O=l.findParentByTagName(A,"table",true);if(m(O,A,x,true)){if(J.fireEvent("excludetable",O)!==true)J.body.style.cursor="url("+J.options.cursorpath+"h.png),pointer"}else if(m(O,A,x)){if(J.fireEvent("excludetable",O)!==
true)J.body.style.cursor="url("+J.options.cursorpath+"v.png),pointer"}else{J.body.style.cursor="text";if(/\d/.test(G)){G=G.replace(/\d/,"");A=da(A).getPreviewCell(A,G=="v")}q(J,A?!!G:false,A?G:"",C,A)}}}else f(false,O,J)}catch($){j($)}}function f(x,A,C){if(x)d(A,C);else va||(Ra=setTimeout(function(){!va&&aa&&aa.parentNode&&aa.parentNode.removeChild(aa)},2E3))}function d(x,A){function C(H,N){clearTimeout(E);E=setTimeout(function(){A.fireEvent("tableClicked",x,N)},300)}function G(){clearTimeout(E);
var H=da(x),N=x.rows[0].cells[0],M=H.getLastCell();M=H.getCellsRange(N,M);A.selection.getRange().setStart(N,0).setCursor(false,true);H.setSelected(M)}var O=l.getXY(x),$=x.ownerDocument;if(aa&&aa.parentNode)return aa;aa=$.createElement("div");aa.contentEditable=false;aa.innerHTML="";aa.style.cssText="width:15px;height:15px;background-image:url("+A.options.UEDITOR_HOME_URL+"dialogs/table/dragicon.png);position: absolute;cursor:move;top:"+(O.y-15)+"px;left:"+O.x+"px;";l.unSelectable(aa);aa.onmouseover=
function(){va=true};aa.onmouseout=function(){va=false};l.on(aa,"click",function(H,N){C(N,this)});l.on(aa,"dblclick",function(H,N){G(N)});l.on(aa,"dragstart",function(H,N){l.preventDefault(N)});var E;$.body.appendChild(aa)}function m(x,A,C,G){C=e(C);A=o(A,C);if(G){G=(G=x.getElementsByTagName("caption")[0])?G.offsetHeight:0;return A=="v1"&&C.y-l.getXY(x).y-G<8}else return A=="h1"&&C.x-l.getXY(x).x<8}function h(x,A){var C=da(x);if(C){var G=C.getSameEndPosCells(x,"x")[0];x=C.getSameStartPosXCells(x)[0];
A=e(A).x;C=(G?l.getXY(G).x:l.getXY(C.table).x)+20;G=x?l.getXY(x).x+x.offsetWidth-20:J.body.offsetWidth+5||parseInt(l.getComputedStyle(J.body,"width"),10);C+=Da;G-=Da;return A<C?C:A>G?G:A}}function n(x,A){try{var C=l.getXY(x).y,G=e(A).y;return G<C?C:G}catch(O){j(O)}}function q(x,A,C,G,O){try{x.body.style.cursor=C=="h"?"col-resize":C=="v"?"row-resize":"text";if(y.ie)if(C&&!na&&!ja(x)){Ka(x,x.document);La(C,O)}else oa(x);Ea=A}catch($){j($)}}function o(x,A){var C=l.getXY(x);if(!C)return"";if(C.x+x.offsetWidth-
A.x<wa)return"h";if(A.x-C.x<wa)return"h1";if(C.y+x.offsetHeight-A.y<wa)return"v";if(A.y-C.y<wa)return"v1";return""}function p(x,A){if(!X()){ua={x:A.clientX,y:A.clientY};if(A.button==2){x=ja(J);var C=false;if(x){var G=Ma(J,A);v.each(x.selectedTds,function(O){if(O===G)C=true});if(C){G=x.selectedTds[0];setTimeout(function(){J.selection.getRange().setStart(G,0).setCursor(false,true)},0)}else{xa(l.getElementsByTagName(J.body,"th td"));x.clearSelected()}}}else s(A)}}function r(x){ha=0;x=x||J.window.event;
var A=b(x.target||x.srcElement);if(A){var C;if(C=o(A,e(x))){oa(J);if(C=="h1"){C="h";if(m(l.findParentByTagName(A,"table"),A,x))J.execCommand("adaptbywindow");else(A=da(A).getPreviewCell(A))&&J.selection.getRange().selectNodeContents(A).setCursor(true,true)}if(C=="h"){x=da(A);var G=R(A,x.table,true);G=u(G,"left");x.width=x.offsetWidth;var O=[],$=[];v.each(G,function(E){O.push(E.offsetWidth)});v.each(G,function(E){E.removeAttribute("width")});window.setTimeout(function(){var E=true;v.each(G,function(N,
M){N=N.offsetWidth;if(N>O[M])return E=false;$.push(N)});var H=E?$:O;v.each(G,function(N,M){N.width=H[M]-ya()})},0)}}}}function s(x){xa(l.getElementsByTagName(J.body,"td th"));v.each(J.document.getElementsByTagName("table"),function(C){C.ueTable=null});if(ba=Ma(J,x)){var A=l.findParentByTagName(ba,"table",true);(ut=da(A))&&ut.clearSelected();if(Ea)t(x);else{J.document.body.style.webkitUserSelect="";na=true;J.addListener("mouseover",I)}}}function t(x){if(y.ie)x=D(x);w();ra=true;za=setTimeout(function(){z(x)},
Na)}function u(x,A){for(var C=[],G=null,O=0,$=x.length;O<$;O++)(G=x[O][A])&&C.push(G);return C}function w(){za&&clearTimeout(za);za=null}function D(x){var A=["pageX","pageY","clientX","clientY","srcElement","target"],C={};if(x)for(var G=0,O,$;O=A[G];G++)($=x[O])&&(C[O]=$);return C}function z(x){ra=false;if(ba=x.target||x.srcElement){x=o(ba,e(x));if(/\d/.test(x)){x=x.replace(/\d/,"");ba=da(ba).getPreviewCell(ba,x=="v")}oa(J);Ka(J,J.document);J.fireEvent("saveScene");La(x,ba);na=true;la=x;ia=ba}}function F(x,
A){if(!X()){w();ra=false;if(Ea){ha=++ha%3;ua={x:A.clientX,y:A.clientY};Sa=setTimeout(function(){ha>0&&ha--},Na);if(ha===2){ha=0;r(A);return}}if(A.button!=2){x=this;var C=x.selection.getRange(),G=l.findParentByTagName(C.startContainer,"table",true),O=l.findParentByTagName(C.endContainer,"table",true);if(G||O)if(G===O){G=l.findParentByTagName(C.startContainer,["td","th","caption"],true);O=l.findParentByTagName(C.endContainer,["td","th","caption"],true);G!==O&&x.selection.clearRange()}else x.selection.clearRange();
na=false;x.document.body.style.webkitUserSelect="";if(la&&ia){x.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();ha=0;if(ka=x.document.getElementById("ue_tableDragLine")){A=l.getXY(ia);C=l.getXY(ka);switch(la){case "h":L(ia,C.x-A.x);break;case "v":T(ia,C.y-A.y-ia.offsetHeight);break;default:}la="";ia=null;oa(x);x.fireEvent("saveScene");return}}if(ba){if(G=(C=da(ba))?C.selectedTds[0]:null){C=new ea.Range(x.document);l.isEmptyBlock(G)?C.setStart(G,0).setCursor(false,true):C.selectNodeContents(G).shrinkBoundary().setCursor(false,
true)}else{C=x.selection.getRange().shrinkBoundary();if(!C.collapsed){G=l.findParentByTagName(C.startContainer,["td","th"],true);O=l.findParentByTagName(C.endContainer,["td","th"],true);if(G&&!O||!G&&O||G&&O&&G!==O)C.setCursor(false,true)}}ba=null;x.removeListener("mouseover",I)}else{(G=l.findParentByTagName(A.target||A.srcElement,"td",true))||(G=l.findParentByTagName(A.target||A.srcElement,"th",true));if(G&&(G.tagName=="TD"||G.tagName=="TH")){if(x.fireEvent("excludetable",G)===true)return;C=new ea.Range(x.document);
C.setStart(G,0).setCursor(false,true)}}x._selectionChange(250,A)}}}function I(x,A){if(!X()){x=this;var C=A.target||A.srcElement;ma=l.findParentByTagName(C,"td",true)||l.findParentByTagName(C,"th",true);if(ba&&ma&&(ba.tagName=="TD"&&ma.tagName=="TD"||ba.tagName=="TH"&&ma.tagName=="TH")&&l.findParentByTagName(ba,"table")==l.findParentByTagName(ma,"table")){C=da(ma);if(ba!=ma){x.document.body.style.webkitUserSelect="none";x.selection.getNative()[y.ie9below?"empty":"removeAllRanges"]();x=C.getCellsRange(ba,
ma);C.setSelected(x)}else{x.document.body.style.webkitUserSelect="";C.clearSelected()}}A.preventDefault?A.preventDefault():(A.returnValue=false)}}function S(x,A,C){var G=parseInt(l.getComputedStyle(x,"line-height"),10);A=C+A;A=A<G?G:A;if(x.style.height)x.style.height="";x.rowSpan==1?x.setAttribute("height",A):x.removeAttribute&&x.removeAttribute("height")}function L(x,A){var C=da(x);if(C){C=C.table;var G=R(x,C);C.style.width="";C.removeAttribute("width");A=ga(A,x,G);x.nextSibling?v.each(G,function(O){O.left.width=
+O.left.width+A;O.right&&(O.right.width=+O.right.width-A)}):v.each(G,function(O){O.left.width-=-A})}}function X(){return J.body.contentEditable==="false"}function T(x,A){if(!(Math.abs(A)<10)){var C=da(x);if(C){x=C.getSameEndPosCells(x,"y");C=x[0]?x[0].offsetHeight:0;for(var G=0,O;O=x[G++];)S(O,A,C)}}}function R(x,A,C){A||(A=l.findParentByTagName(x,"table"));if(!A)return null;l.getNodeIndex(x);x=x;A=A.rows;for(var G=0;x;){if(x.nodeType===1)G+=x.colSpan||1;x=x.previousSibling}x=null;var O=[];v.each(A,
function($){var E=0;v.each($.cells,function(H){E+=H.colSpan||1;if(E===G){O.push({left:H,right:H.nextSibling||null});return false}else if(E>G){C&&O.push({left:H});return false}})});return O}function ga(x,A,C){x-=ya();if(x<0)return 0;x-=Oa(A);var G=x<0?"left":"right";x=Math.abs(x);v.each(C,function(O){if(O=O[G])x=Math.min(x,Oa(O)-Da)});x=x<0?0:x;return G==="left"?-x:x}function Oa(x){var A=0;A=x.offsetWidth-ya();x.nextSibling||(A-=Ta(x));A=A<0?0:A;try{x.width=A}catch(C){}return A}function Ta(x){tab=
l.findParentByTagName(x,"table",false);if(tab.offsetVal===undefined){var A=x.previousSibling;tab.offsetVal=A?x.offsetWidth-A.offsetWidth===ca.borderWidth?ca.borderWidth:0:0}return tab.offsetVal}function ya(){if(ca.tabcellSpace===undefined){var x=J.document.createElement("table"),A=J.document.createElement("tbody"),C=J.document.createElement("tr"),G=J.document.createElement("td"),O=null;G.style.cssText="border: 0;";G.width=1;C.appendChild(G);C.appendChild(O=G.cloneNode(false));A.appendChild(C);x.appendChild(A);
x.style.cssText="visibility: hidden;";J.body.appendChild(x);ca.paddingSpace=G.offsetWidth-1;A=x.offsetWidth;G.style.cssText="";O.style.cssText="";ca.borderWidth=(x.offsetWidth-A)/3;ca.tabcellSpace=ca.paddingSpace+ca.borderWidth;J.body.removeChild(x)}ya=function(){return ca.tabcellSpace};return ca.tabcellSpace}function Ka(x){if(!na){ka=x.document.createElement("div");l.setAttributes(ka,{id:"ue_tableDragLine",unselectable:"on",contenteditable:false,onresizestart:"return false",ondragstart:"return false",
onselectstart:"return false",style:"background-color:blue;position:absolute;padding:0;margin:0;background-image:none;border:0px none;opacity:0;filter:alpha(opacity=0)"});x.body.appendChild(ka)}}function oa(x){if(!na)for(var A;A=x.document.getElementById("ue_tableDragLine");)l.remove(A)}function La(x,A){if(A){var C=l.findParentByTagName(A,"table"),G=C.getElementsByTagName("caption"),O=C.offsetWidth,$=C.offsetHeight-(G.length>0?G[0].offsetHeight:0);C=l.getXY(C);var E=l.getXY(A);switch(x){case "h":x=
"height:"+$+"px;top:"+(C.y+(G.length>0?G[0].offsetHeight:0))+"px;left:"+(E.x+A.offsetWidth);ka.style.cssText=x+"px;position: absolute;display:block;background-color:blue;width:1px;border:0; color:blue;opacity:.3;filter:alpha(opacity=30)";break;case "v":x="width:"+O+"px;left:"+C.x+"px;top:"+(E.y+A.offsetHeight);ka.style.cssText=x+"px;overflow:hidden;position: absolute;display:block;background-color:blue;height:1px;border:0;color:blue;opacity:.2;filter:alpha(opacity=20)";break;default:}}}function Fa(x,
A){x=l.getElementsByTagName(x.body,"table");for(var C,G=0,O;O=x[G++];){C=l.getElementsByTagName(O,"td");if(C[0])if(A){C=C[0].style.borderColor.replace(/\s/g,"");/(#ffffff)|(rgb\(255,255,255\))/ig.test(C)&&l.addClass(O,"noBorderTable")}else l.removeClasses(O,"noBorderTable")}}function Ua(x,A,C){var G=x.body;return G.offsetWidth-(A?parseInt(l.getComputedStyle(G,"margin-left"),10)*2:0)-C.tableBorder*2-(x.options.offsetWidth||0)}function Ma(x,A){var C=l.findParentByTagName(A.target||A.srcElement,["td",
"th"],true),G=null;if(!C)return null;G=o(C,e(A));if(!C)return null;if(G==="h1"&&C.previousSibling){G=l.getXY(C);var O=C.offsetWidth;if(Math.abs(G.x+O-A.clientX)>O/3)C=C.previousSibling}else if(G==="v1"&&C.parentNode.previousSibling){G=l.getXY(C);O=C.offsetHeight;if(Math.abs(G.y+O-A.clientY)>O/3)C=C.parentNode.previousSibling.firstChild}return C&&x.fireEvent("excludetable",C)!==true?C:null}var J=this,za=null,Sa=null,Da=5,ra=false,wa=5,Ja=10,ha=0,ua=null,Na=360,ca=UE.UETable,da=function(x){return ca.getUETable(x)},
ja=function(x){return ca.getUETableBySelected(x)},Ga=function(x,A){return ca.getDefaultValue(x,A)},xa=function(x){return ca.removeSelectedClass(x)};J.ready(function(){var x=this,A=x.selection.getText;x.selection.getText=function(){var C=ja(x);if(C){var G="";v.each(C.selectedTds,function(O){G+=O[y.ie?"innerText":"textContent"]});return G}else return A.call(x.selection)}});var ba=null,ma=null,la="",Ea=false,aa=null,va=false,ka=null,ia=null,na=false;J.setOpt({maxColNum:20,maxRowNum:100,defaultCols:5,
defaultRows:5,tdvalign:"top",cursorpath:J.options.UEDITOR_HOME_URL+"themes/default/images/cursor_",tableDragable:false,classList:["ue-table-interlace-color-single","ue-table-interlace-color-double"]});J.getUETable=da;var Va={deletetable:1,inserttable:1,cellvalign:1,insertcaption:1,deletecaption:1,inserttitle:1,deletetitle:1,mergeright:1,mergedown:1,mergecells:1,insertrow:1,insertrownext:1,deleterow:1,insertcol:1,insertcolnext:1,deletecol:1,splittocells:1,splittorows:1,splittocols:1,adaptbytext:1,
adaptbywindow:1,adaptbycustomer:1,insertparagraph:1,insertparagraphbeforetable:1,averagedistributecol:1,averagedistributerow:1};J.ready(function(){v.cssRule("table",".selectTdClass{background-color:#edf5fa !important}table.noBorderTable td,table.noBorderTable th,table.noBorderTable caption{border:1px dashed #ddd !important}table{margin-bottom:10px;border-collapse:collapse;display:table;}td,th{padding: 5px 10px;border: 1px solid #DDD;}caption{border:1px dashed #DDD;border-bottom:0;padding:3px;text-align:center;}th{border-top:1px solid #BBB;background-color:#F7F7F7;}table tr.firstRow th{border-top-width:2px;}.ue-table-interlace-color-single{ background-color: #fcfcfc; } .ue-table-interlace-color-double{ background-color: #f7faff; }td p{margin:0;padding:0;}",
J.document);var x,A,C;J.addListener("keydown",function(E,H){E=this;var N=H.keyCode||H.which;if(N==8){var M=ja(E);if(M&&M.selectedTds.length){if(M.isFullCol())E.execCommand("deletecol");else M.isFullRow()?E.execCommand("deleterow"):E.fireEvent("delcells");l.preventDefault(H)}var P=l.findParentByTagName(E.selection.getStart(),"caption",true),Q=E.selection.getRange();if(Q.collapsed&&P&&a(P)){E.fireEvent("saveScene");M=P.parentNode;l.remove(P);M&&Q.setStart(M.rows[0].cells[0],0).setCursor(false,true);
E.fireEvent("saveScene")}}if(N==46)if(M=ja(E)){E.fireEvent("saveScene");for(P=0;Q=M.selectedTds[P++];)l.fillNode(E.document,Q);E.fireEvent("saveScene");l.preventDefault(H)}if(N==13){N=E.selection.getRange();if(P=l.findParentByTagName(N.startContainer,"caption",true)){M=l.findParentByTagName(P,"table");if(N.collapsed)P&&N.setStart(M.rows[0].cells[0],0).setCursor(false,true);else{N.deleteContents();E.fireEvent("saveScene")}l.preventDefault(H);return}if(N.collapsed)if(M=l.findParentByTagName(N.startContainer,
"table")){Q=M.rows[0].cells[0];P=l.findParentByTagName(E.selection.getStart(),["td","th"],true);M=M.previousSibling;if(Q===P&&(!M||M.nodeType==1&&M.tagName=="TABLE")&&l.isStartInblock(N))if((N=l.findParent(E.selection.getStart(),function(U){return l.isBlockElm(U)},true))&&(/t(h|d)/i.test(N.tagName)||N===P.firstChild)){E.execCommand("insertparagraphbeforetable");l.preventDefault(H)}}}if((H.ctrlKey||H.metaKey)&&H.keyCode=="67"){x=null;if(M=ja(E)){H=M.selectedTds;A=M.isFullCol();C=M.isFullRow();x=[[M.cloneCell(H[0],
null,true)]];for(P=1;Q=H[P];P++)Q.parentNode!==H[P-1].parentNode?x.push([M.cloneCell(Q,null,true)]):x[x.length-1].push(M.cloneCell(Q,null,true))}}});J.addListener("tablehasdeleted",function(){q(this,false,"",null);aa&&l.remove(aa)});J.addListener("beforepaste",function(E,H){var N=this;E=N.selection.getRange();if(l.findParentByTagName(E.startContainer,"caption",true)){E=N.document.createElement("div");E.innerHTML=H.html;H.html=E[y.ie9below?"innerText":"textContent"]}else{var M=ja(N);if(x){N.fireEvent("saveScene");
E=N.selection.getRange();var P=l.findParentByTagName(E.startContainer,["td","th"],true),Q,U;if(P){M=da(P);if(C){var Y=M.getCellInfo(P).rowIndex;P.tagName=="TH"&&Y++;E=0;for(var V;V=x[E++];){U=M.insertRow(Y++,"td");for(var Z=0,W;W=V[Z];Z++){(P=U.cells[Z])||(P=U.insertCell(Z));P.innerHTML=W.innerHTML;W.getAttribute("width")&&P.setAttribute("width",W.getAttribute("width"));W.getAttribute("vAlign")&&P.setAttribute("vAlign",W.getAttribute("vAlign"));W.getAttribute("align")&&P.setAttribute("align",W.getAttribute("align"));
W.style.cssText&&(P.style.cssText=W.style.cssText)}for(Z=0;W=U.cells[Z];Z++){if(!V[Z])break;W.innerHTML=V[Z].innerHTML;V[Z].getAttribute("width")&&W.setAttribute("width",V[Z].getAttribute("width"));V[Z].getAttribute("vAlign")&&W.setAttribute("vAlign",V[Z].getAttribute("vAlign"));V[Z].getAttribute("align")&&W.setAttribute("align",V[Z].getAttribute("align"));V[Z].style.cssText&&(W.style.cssText=V[Z].style.cssText)}}}else{if(A){Y=M.getCellInfo(P);Z=P=0;for(V=x[0];W=V[Z++];)P+=W.colSpan||1;N.__hasEnterExecCommand=
true;for(E=0;E<P;E++)N.execCommand("insertcol");N.__hasEnterExecCommand=false;P=M.table.rows[0].cells[Y.cellIndex];if(P.tagName=="TH")P=M.table.rows[1].cells[Y.cellIndex]}for(E=0;V=x[E++];){Q=P;for(Z=0;W=V[Z++];)if(P){P.innerHTML=W.innerHTML;W.getAttribute("width")&&P.setAttribute("width",W.getAttribute("width"));W.getAttribute("vAlign")&&P.setAttribute("vAlign",W.getAttribute("vAlign"));W.getAttribute("align")&&P.setAttribute("align",W.getAttribute("align"));W.style.cssText&&(P.style.cssText=W.style.cssText);
U=P;P=P.nextSibling}else{Y=W.cloneNode(true);l.removeAttributes(Y,["class","rowSpan","colSpan"]);U.parentNode.appendChild(Y)}P=M.getNextCell(Q,true,true);if(!x[E])break;if(!P){Y=M.getCellInfo(Q);M.table.insertRow(M.table.rows.length);M.update();P=M.getVSideCell(Q,true)}}}M.update()}else{M=N.document.createElement("table");for(E=0;V=x[E++];){U=M.insertRow(M.rows.length);for(Z=0;W=V[Z++];){Y=ca.cloneCell(W,null,true);l.removeAttributes(Y,["class"]);U.appendChild(Y)}if(Z==2&&Y.rowSpan>1)Y.rowSpan=1}E=
Ga(N);E=N.body.offsetWidth-parseInt(l.getComputedStyle(N.body,"margin-left"),10)*2-E.tableBorder*2-(N.options.offsetWidth||0);N.execCommand("insertHTML","<table  "+(A&&C?'width="'+E+'"':"")+">"+M.innerHTML.replace(/>\s*</g,"><").replace(/\bth\b/gi,"td")+"</table>")}N.fireEvent("contentchange");N.fireEvent("saveScene");H.html="";return true}else{E=N.document.createElement("div");E.innerHTML=H.html;V=E.getElementsByTagName("table");if(l.findParentByTagName(N.selection.getStart(),"table")){v.each(V,
function(sa){l.remove(sa)});if(l.findParentByTagName(N.selection.getStart(),"caption",true))E.innerHTML=E[y.ie?"innerText":"textContent"]}else v.each(V,function(sa){g(sa,true);l.removeAttributes(sa,["style","border"]);v.each(l.getElementsByTagName(sa,"td"),function(Ha){a(Ha)&&l.fillNode(N.document,Ha);g(Ha,true)})});H.html=E.innerHTML}}});J.addListener("afterpaste",function(){v.each(l.getElementsByTagName(J.body,"table"),function(E){if(E.offsetWidth>J.body.offsetWidth){var H=Ga(J,E);E.style.width=
J.body.offsetWidth-parseInt(l.getComputedStyle(J.body,"margin-left"),10)*2-H.tableBorder*2-(J.options.offsetWidth||0)+"px"}})});J.addListener("blur",function(){x=null});var G;J.addListener("keydown",function(){clearTimeout(G);G=setTimeout(function(){var E=J.selection.getRange();if(E=l.findParentByTagName(E.startContainer,["th","td"],true)){var H=E.parentNode.parentNode.parentNode;if(H.offsetWidth>H.getAttribute("width"))E.style.wordBreak="break-all"}},100)});J.addListener("selectionchange",function(){q(J,
false,"",null)});J.addListener("contentchange",function(){var E=this;oa(E);if(!ja(E)){var H=E.selection.getRange().startContainer;H=l.findParentByTagName(H,["td","th"],true);v.each(l.getElementsByTagName(E.document,"table"),function(N){if(E.fireEvent("excludetable",N)!==true){N.ueTable=new ca(N);N.onmouseover=function(){E.fireEvent("tablemouseover",N)};N.onmousemove=function(){E.fireEvent("tablemousemove",N);E.options.tableDragable&&f(true,this,E);v.defer(function(){E.fireEvent("contentchange",50)},
true)};N.onmouseout=function(){E.fireEvent("tablemouseout",N);q(E,false,"",null);oa(E)};N.onclick=function(M){M=E.window.event||M;var P=b(M.target||M.srcElement);if(P){var Q=da(P),U=Q.table,Y=Q.getCellInfo(P),V=E.selection.getRange();if(m(U,P,M,true)){U=Q.getCell(Q.indexTable[Q.rowsNum-1][Y.colIndex].rowIndex,Q.indexTable[Q.rowsNum-1][Y.colIndex].cellIndex);if(M.shiftKey&&Q.selectedTds.length)if(Q.selectedTds[0]!==U){M=Q.getCellsRange(Q.selectedTds[0],U);Q.setSelected(M)}else V&&V.selectNodeContents(U).select();
else if(P!==U){M=Q.getCellsRange(P,U);Q.setSelected(M)}else V&&V.selectNodeContents(U).select()}else if(m(U,P,M)){U=Q.getCell(Q.indexTable[Y.rowIndex][Q.colsNum-1].rowIndex,Q.indexTable[Y.rowIndex][Q.colsNum-1].cellIndex);if(M.shiftKey&&Q.selectedTds.length)if(Q.selectedTds[0]!==U){M=Q.getCellsRange(Q.selectedTds[0],U);Q.setSelected(M)}else V&&V.selectNodeContents(U).select();else if(P!==U){M=Q.getCellsRange(P,U);Q.setSelected(M)}else V&&V.selectNodeContents(U).select()}}}}});Fa(E,true)}});l.on(J.document,
"mousemove",k);l.on(J.document,"mouseout",function(E){(E.target||E.srcElement).tagName=="TABLE"&&q(J,false,"",null)});J.addListener("interlacetable",function(E,H,N){if(H){E=this;H=H.rows;for(var M=H.length,P=function(U,Y,V){return U[Y]?U[Y]:V?U[Y%U.length]:""},Q=0;Q<M;Q++)H[Q].className=P(N||E.options.classList,Q,true)}});J.addListener("uninterlacetable",function(E,H){if(H){E=H.rows;H=this.options.classList;for(var N=E.length,M=0;M<N;M++)l.removeClasses(E[M],H)}});J.addListener("mousedown",p);J.addListener("mouseup",
F);l.on(J.body,"dragstart",function(E){F.call(J,"dragstart",E)});J.addOutputRule(function(E){v.each(E.getNodesByTagName("div"),function(H){H.getAttr("id")=="ue_tableDragLine"&&H.parentNode.removeChild(H)})});var O=0;J.addListener("mousedown",function(){O=0});J.addListener("tabkeydown",function(){var E=this.selection.getRange(),H=E.getCommonAncestor(true,true),N=l.findParentByTagName(H,"table");if(N){if(l.findParentByTagName(H,"caption",true))(H=l.getElementsByTagName(N,"th td"))&&H.length&&E.setStart(H[0],
0).setCursor(false,true);else{H=l.findParentByTagName(H,["td","th"],true);var M=da(H);O=H.rowSpan>1?O:M.getCellInfo(H).rowIndex;if(H=M.getTabNextCell(H,O))a(H)?E.setStart(H,0).setCursor(false,true):E.selectNodeContents(H).select();else{J.fireEvent("saveScene");J.__hasEnterExecCommand=true;this.execCommand("insertrownext");J.__hasEnterExecCommand=false;E=this.selection.getRange();E.setStart(N.rows[N.rows.length-1].cells[0],0).setCursor();J.fireEvent("saveScene")}}return true}});y.ie&&J.addListener("selectionchange",
function(){q(this,false,"",null)});J.addListener("keydown",function(E,H){E=this;var N=H.keyCode||H.which;if(!(N==8||N==46)){(H=!H.ctrlKey&&!H.metaKey&&!H.shiftKey&&!H.altKey)&&xa(l.getElementsByTagName(E.body,"td"));(E=ja(E))&&H&&E.clearSelected()}});J.addListener("beforegetcontent",function(){Fa(this,false);y.ie&&v.each(this.document.getElementsByTagName("caption"),function(E){if(l.isEmptyNode(E))E.innerHTML="&nbsp;"})});J.addListener("aftergetcontent",function(){Fa(this,true)});J.addListener("getAllHtml",
function(){xa(J.document.getElementsByTagName("td"))});J.addListener("fullscreenchanged",function(E,H){if(!H){var N=this.body.offsetWidth/document.body.offsetWidth;E=l.getElementsByTagName(this.body,"table");v.each(E,function(M){if(M.offsetWidth<J.body.offsetWidth)return false;var P=l.getElementsByTagName(M,"td"),Q=[];v.each(P,function(V){Q.push(V.offsetWidth)});for(var U=0,Y;Y=P[U];U++)Y.setAttribute("width",Math.floor(Q[U]*N));M.setAttribute("width",Math.floor(Ua(J,true,Ga(J))))})}});var $=J.execCommand;
J.execCommand=function(E){var H=this;E=E.toLowerCase();var N=ja(H),M=new ea.Range(H.document),P=H.commands[E]||UE.commands[E],Q;if(P){if(N&&!Va[E]&&!P.notNeedUndo&&!H.__hasEnterExecCommand){H.__hasEnterExecCommand=true;H.fireEvent("beforeexeccommand",E);N=N.selectedTds;for(var U=P=-2,Y,V,Z=0,W;W=N[Z];Z++){a(W)?M.setStart(W,0).setCursor(false,true):M.selectNode(W).select(true);V=H.queryCommandState(E);Y=H.queryCommandValue(E);if(V!=-1){if(P!==V||U!==Y){H._ignoreContentChange=true;Q=$.apply(H,arguments);
H._ignoreContentChange=false}P=H.queryCommandState(E);U=H.queryCommandValue(E);l.isEmptyBlock(W)&&l.fillNode(H.document,W)}}M.setStart(N[0],0).shrinkBoundary(true).setCursor(false,true);H.fireEvent("contentchange");H.fireEvent("afterexeccommand",E);H.__hasEnterExecCommand=false;H._selectionChange()}else Q=$.apply(H,arguments);return Q}}});var Ra};UE.UETable.prototype.sortTable=function(j,g){var c=this.table,b=c.rows,a=[],e=b[0].cells[0].tagName==="TH",k=0;if(this.selectedTds.length){for(var f=this.cellsRange,
d=f.endRowIndex+1,m=f.beginRowIndex;m<d;m++)a[m]=b[m];a.splice(0,f.beginRowIndex);k=f.endRowIndex+1===this.rowsNum?0:f.endRowIndex+1}else{m=0;for(d=b.length;m<d;m++)a[m]=b[m]}var h={reversecurrent:function(){return 1},orderbyasc:function(n,q){return(n.innerText||n.textContent).localeCompare(q.innerText||q.textContent)},reversebyasc:function(n,q){return q.innerHTML.localeCompare(n.innerHTML)},orderbynum:function(n,q){n=n[y.ie?"innerText":"textContent"].match(/\d+/);q=q[y.ie?"innerText":"textContent"].match(/\d+/);
if(n)n=+n[0];if(q)q=+q[0];return(n||0)-(q||0)},reversebynum:function(n,q){n=n[y.ie?"innerText":"textContent"].match(/\d+/);q=q[y.ie?"innerText":"textContent"].match(/\d+/);if(n)n=+n[0];if(q)q=+q[0];return(q||0)-(n||0)}};c.setAttribute("data-sort-type",g&&typeof g==="string"&&h[g]?g:"");e&&a.splice(0,1);a=v.sort(a,function(n,q){return g&&typeof g==="function"?g.call(this,n.cells[j],q.cells[j]):g&&typeof g==="number"?1:g&&typeof g==="string"&&h[g]?h[g].call(this,n.cells[j],q.cells[j]):h.orderbyasc.call(this,
n.cells[j],q.cells[j])});e=c.ownerDocument.createDocumentFragment();m=0;for(d=a.length;m<d;m++)e.appendChild(a[m]);c=c.getElementsByTagName("tbody")[0];k?c.insertBefore(e,b[k-f.endRowIndex+f.beginRowIndex-1]):c.appendChild(e)};UE.plugins.tablesort=function(){var j=this,g=UE.UETable,c=function(a){return g.getUETable(a)},b=function(a){return g.getTableItemsByRange(a)};j.ready(function(){v.cssRule("tablesort","table.sortEnabled tr.firstRow th,table.sortEnabled tr.firstRow td{padding-right:20px;background-repeat: no-repeat;background-position: center right;   background-image:url("+
j.options.themePath+j.options.theme+"/images/sortable.png);}",j.document);j.addListener("afterexeccommand",function(a,e){if(e=="mergeright"||e=="mergedown"||e=="mergecells")this.execCommand("disablesort")})});UE.commands.sorttable={queryCommandState:function(){var a=b(this);if(!a.cell)return-1;a=a.table.getElementsByTagName("td");for(var e=0,k;k=a[e++];)if(k.rowSpan!=1||k.colSpan!=1)return-1;return 0},execCommand:function(a,e){var k=this;a=k.selection.getRange();var f=a.createBookmark(true),d=b(k);
k=d.cell;d=c(d.table);k=d.getCellInfo(k);d.sortTable(k.cellIndex,e);a.moveToBookmark(f);try{a.select()}catch(m){}}};UE.commands.enablesort=UE.commands.disablesort={queryCommandState:function(a){var e=b(this).table;if(e&&a=="enablesort")for(var k=l.getElementsByTagName(e,"th td"),f=0;f<k.length;f++)if(k[f].getAttribute("colspan")>1||k[f].getAttribute("rowspan")>1)return-1;return!e?-1:a=="enablesort"^e.getAttribute("data-sort")!="sortEnabled"?-1:0},execCommand:function(a){var e=b(this).table;e.setAttribute("data-sort",
a=="enablesort"?"sortEnabled":"sortDisabled");a=="enablesort"?l.addClass(e,"sortEnabled"):l.removeClasses(e,"sortEnabled")}}};UE.plugins.contextmenu=function(){var j=this;j.setOpt("enableContextMenu",true);if(j.getOpt("enableContextMenu")!==false){var g=j.getLang("contextMenu"),c,b=j.options.contextMenu||[{label:g.selectall,cmdName:"selectall"},{label:g.cleardoc,cmdName:"cleardoc",exec:function(){confirm(g.confirmclear)&&this.execCommand("cleardoc")}},"-",{label:g.unlink,cmdName:"unlink"},"-",{group:g.paragraph,
icon:"justifyjustify",subMenu:[{label:g.justifyleft,cmdName:"justify",value:"left"},{label:g.justifyright,cmdName:"justify",value:"right"},{label:g.justifycenter,cmdName:"justify",value:"center"},{label:g.justifyjustify,cmdName:"justify",value:"justify"}]},"-",{group:g.table,icon:"table",subMenu:[{label:g.inserttable,cmdName:"inserttable"},{label:g.deletetable,cmdName:"deletetable"},"-",{label:g.deleterow,cmdName:"deleterow"},{label:g.deletecol,cmdName:"deletecol"},{label:g.insertcol,cmdName:"insertcol"},
{label:g.insertcolnext,cmdName:"insertcolnext"},{label:g.insertrow,cmdName:"insertrow"},{label:g.insertrownext,cmdName:"insertrownext"},"-",{label:g.insertcaption,cmdName:"insertcaption"},{label:g.deletecaption,cmdName:"deletecaption"},{label:g.inserttitle,cmdName:"inserttitle"},{label:g.deletetitle,cmdName:"deletetitle"},{label:g.inserttitlecol,cmdName:"inserttitlecol"},{label:g.deletetitlecol,cmdName:"deletetitlecol"},"-",{label:g.mergecells,cmdName:"mergecells"},{label:g.mergeright,cmdName:"mergeright"},
{label:g.mergedown,cmdName:"mergedown"},"-",{label:g.splittorows,cmdName:"splittorows"},{label:g.splittocols,cmdName:"splittocols"},{label:g.splittocells,cmdName:"splittocells"},"-",{label:g.averageDiseRow,cmdName:"averagedistributerow"},{label:g.averageDisCol,cmdName:"averagedistributecol"},"-",{label:g.edittd,cmdName:"edittd",exec:function(){UE.ui.edittd&&new UE.ui.edittd(this);this.getDialog("edittd").open()}},{label:g.edittable,cmdName:"edittable",exec:function(){UE.ui.edittable&&new UE.ui.edittable(this);
this.getDialog("edittable").open()}},{label:g.setbordervisible,cmdName:"setbordervisible"}]},{group:g.tablesort,icon:"tablesort",subMenu:[{label:g.enablesort,cmdName:"enablesort"},{label:g.disablesort,cmdName:"disablesort"},"-",{label:g.reversecurrent,cmdName:"sorttable",value:"reversecurrent"},{label:g.orderbyasc,cmdName:"sorttable",value:"orderbyasc"},{label:g.reversebyasc,cmdName:"sorttable",value:"reversebyasc"},{label:g.orderbynum,cmdName:"sorttable",value:"orderbynum"},{label:g.reversebynum,
cmdName:"sorttable",value:"reversebynum"}]},{group:g.borderbk,icon:"borderBack",subMenu:[{label:g.setcolor,cmdName:"interlacetable",exec:function(){this.execCommand("interlacetable")}},{label:g.unsetcolor,cmdName:"uninterlacetable",exec:function(){this.execCommand("uninterlacetable")}},{label:g.setbackground,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#bbb","#ccc"]})}},{label:g.unsetbackground,cmdName:"cleartablebackground",exec:function(){this.execCommand("cleartablebackground")}},
{label:g.redandblue,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["red","blue"]})}},{label:g.threecolorgradient,cmdName:"settablebackground",exec:function(){this.execCommand("settablebackground",{repeat:true,colorList:["#aaa","#bbb","#ccc"]})}}]},{group:g.aligntd,icon:"aligntd",subMenu:[{cmdName:"cellalignment",value:{align:"left",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"top"}},{cmdName:"cellalignment",value:{align:"right",
vAlign:"top"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"middle"}},{cmdName:"cellalignment",value:{align:"left",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"center",vAlign:"bottom"}},{cmdName:"cellalignment",value:{align:"right",vAlign:"bottom"}}]},{group:g.aligntable,icon:"aligntable",subMenu:[{cmdName:"tablealignment",className:"left",label:g.tableleft,
value:"left"},{cmdName:"tablealignment",className:"center",label:g.tablecenter,value:"center"},{cmdName:"tablealignment",className:"right",label:g.tableright,value:"right"}]},"-",{label:g.insertparagraphbefore,cmdName:"insertparagraph",value:true},{label:g.insertparagraphafter,cmdName:"insertparagraph"},{label:g.copy,cmdName:"copy"},{label:g.paste,cmdName:"paste"}];if(b.length){var a=UE.ui.uiUtils;j.addListener("contextmenu",function(e,k){e=a.getViewportOffsetByEvent(k);j.fireEvent("beforeselectionchange");
c&&c.destroy();for(var f=0,d,m=[];d=b[f];f++){var h;(function(o){if(o=="-"){if((h=m[m.length-1])&&h!=="-")m.push("-")}else if(o.hasOwnProperty("group")){for(var p=0,r,s=[];r=o.subMenu[p];p++)(function(u){if(u=="-")(h=s[s.length-1])&&h!=="-"?s.push("-"):s.splice(s.length-1);else if((j.commands[u.cmdName]||UE.commands[u.cmdName]||u.query)&&(u.query?u.query():j.queryCommandState(u.cmdName))>-1)s.push({label:u.label||j.getLang("contextMenu."+u.cmdName+(u.value||""))||"",className:"edui-for-"+u.cmdName+
(u.className?" edui-for-"+u.cmdName+"-"+u.className:""),onclick:u.exec?function(){u.exec.call(j)}:function(){j.execCommand(u.cmdName,u.value)}})})(r);if(s.length){function t(){switch(o.icon){case "table":return j.getLang("contextMenu.table");case "justifyjustify":return j.getLang("contextMenu.paragraph");case "aligntd":return j.getLang("contextMenu.aligntd");case "aligntable":return j.getLang("contextMenu.aligntable");case "tablesort":return g.tablesort;case "borderBack":return g.borderbk;default:return""}}
m.push({label:t(),className:"edui-for-"+o.icon,subMenu:{items:s,editor:j}})}}else if((j.commands[o.cmdName]||UE.commands[o.cmdName]||o.query)&&(o.query?o.query.call(j):j.queryCommandState(o.cmdName))>-1)m.push({label:o.label||j.getLang("contextMenu."+o.cmdName),className:"edui-for-"+(o.icon?o.icon:o.cmdName+(o.value||"")),onclick:o.exec?function(){o.exec.call(j)}:function(){j.execCommand(o.cmdName,o.value)}})})(d)}m[m.length-1]=="-"&&m.pop();c=new UE.ui.Menu({items:m,className:"edui-contextmenu",
editor:j});c.render();c.showAt(e);j.fireEvent("aftershowcontextmenu",c);l.preventDefault(k);if(y.ie){var n;try{n=j.selection.getNative().createRange()}catch(q){return}n.item&&(new ea.Range(j.document)).selectNode(n.item(0)).select(true,true)}});j.addListener("aftershowcontextmenu",function(e,k){if(j.zeroclipboard){e=k.items;for(var f in e)e[f].className=="edui-for-copy"&&j.zeroclipboard.clip(e[f].getDom())}})}}};UE.plugins.shortcutmenu=function(){var j=this,g,c=j.options.shortcutMenu||[];if(c.length){j.addListener("contextmenu mouseup",
function(b,a){var e=this,k={type:b,target:a.target||a.srcElement,screenX:a.screenX,screenY:a.screenY,clientX:a.clientX,clientY:a.clientY};setTimeout(function(){if(e.selection.getRange().collapsed===false||b=="contextmenu"){if(!g){g=new B.editor.ui.ShortCutMenu({editor:e,items:c,theme:e.options.theme,className:"edui-shortcutmenu"});g.render();e.fireEvent("afterrendershortcutmenu",g)}g.show(k,!!UE.plugins.contextmenu)}});if(b=="contextmenu"){l.preventDefault(a);if(y.ie9below){var f;try{f=e.selection.getNative().createRange()}catch(d){return}f.item&&
(new ea.Range(e.document)).selectNode(f.item(0)).select(true,true)}}});j.addListener("keydown",function(b){b=="keydown"&&g&&!g.isHidden&&g.hide()})}};UE.plugins.basestyle=function(){var j={bold:["strong","b"],italic:["em","i"],subscript:["sub"],superscript:["sup"]},g=function(a,e){return l.filterNodeList(a.selection.getStartElementPath(),e)},c=this;c.addshortcutkey({Bold:"ctrl+66",Italic:"ctrl+73",Underline:"ctrl+85"});c.addInputRule(function(a){v.each(a.getNodesByTagName("b i"),function(e){switch(e.tagName){case "b":e.tagName=
"strong";break;case "i":e.tagName="em"}})});for(var b in j)(function(a,e){c.commands[a]={execCommand:function(k){var f=c.selection.getRange(),d=g(this,e);if(f.collapsed){if(d){k=c.document.createTextNode("");f.insertNode(k).removeInlineStyle(e);f.setStartBefore(k);l.remove(k)}else{d=f.document.createElement(e[0]);if(k=="superscript"||k=="subscript"){k=c.document.createTextNode("");f.insertNode(k).removeInlineStyle(["sub","sup"]).setStartBefore(k).collapse(true)}f.insertNode(d).setStart(d,0)}f.collapse(true)}else{if(k==
"superscript"||k=="subscript")if(!d||d.tagName.toLowerCase()!=k)f.removeInlineStyle(["sub","sup"]);d?f.removeInlineStyle(e):f.applyInlineStyle(e[0])}f.select()},queryCommandState:function(){return g(this,e)?1:0}}})(b,j[b])};UE.plugins.elementpath=function(){var j,g,c=this;c.setOpt("elementPathEnabled",true);if(c.options.elementPathEnabled)c.commands.elementpath={execCommand:function(b,a){b=g[a];var e=c.selection.getRange();j=a*1;e.selectNode(b).select()},queryCommandValue:function(){var b=[].concat(this.selection.getStartElementPath()).reverse(),
a=[];g=b;for(var e=0,k;k=b[e];e++)if(k.nodeType!=3){var f=k.tagName.toLowerCase();if(f=="img"&&k.getAttribute("anchorname"))f="anchor";a[e]=f;if(j==e){j=-1;break}}return a}}};UE.plugins.formatmatch=function(){function j(e,k){function f(h){m&&h.selectNode(m);return h.applyInlineStyle(c[c.length-1].tagName,null,c)}if(y.webkit)var d=k.target.tagName=="IMG"?k.target:null;g.undoManger&&g.undoManger.save();e=g.selection.getRange();d=d||e.getClosedNode();if(b&&d&&d.tagName=="IMG"){d.style.cssText+=";float:"+
(b.style.cssFloat||b.style.styleFloat||"none")+";display:"+(b.style.display||"inline");b=null}else if(!b){if(e.collapsed){var m=g.document.createTextNode("match");e.insertNode(m).select()}g.__hasEnterExecCommand=true;d=g.options.removeFormatAttributes;g.options.removeFormatAttributes="";g.execCommand("removeformat");g.options.removeFormatAttributes=d;g.__hasEnterExecCommand=false;e=g.selection.getRange();c.length&&f(e);m&&e.setStartBefore(m).collapse(true);e.select();m&&l.remove(m)}g.undoManger&&
g.undoManger.save();g.removeListener("mouseup",j);a=0}var g=this,c=[],b,a=0;g.addListener("reset",function(){c=[];a=0});g.commands.formatmatch={execCommand:function(){if(a){a=0;c=[];g.removeListener("mouseup",j)}else{var e=g.selection.getRange();b=e.getClosedNode();if(!b||b.tagName!="IMG"){e.collapse(true).shrinkBoundary();c=l.findParents(e.startContainer,true,function(f){return!l.isBlockElm(f)&&f.nodeType==1});e=0;for(var k;k=c[e];e++)if(k.tagName=="A"){c.splice(e,1);break}}g.addListener("mouseup",
j);a=1}},queryCommandState:function(){return a},notNeedUndo:1}};UE.plugin.register("searchreplace",function(){function j(f,d,m){var h=d.searchStr;if(d.dir==-1){f=f.split("").reverse().join("");h=h.split("").reverse().join("");m=f.length-m}h=new RegExp(h,"g"+(d.casesensitive?"":"i"));for(var n;n=h.exec(f);)if(n.index>=m)return d.dir==-1?f.length-n.index-d.searchStr.length:n.index;return-1}function g(f,d,m){var h,n=m.all||m.dir==1?"getNextDomNode":"getPreDomNode";if(l.isBody(f))f=f.firstChild;for(;f;){h=
f.nodeType==3?f.nodeValue:f[y.ie?"innerText":"textContent"];h=j(h,m,d);if(h!=-1)return{node:f,index:h};for(f=l[n](f);f&&k[f.nodeName.toLowerCase()];)f=l[n](f,true);if(f)d=m.dir==-1?(f.nodeType==3?f.nodeValue:f[y.ie?"innerText":"textContent"]).length:0}}function c(f,d,m){var h=0;f=f.firstChild;for(var n=0;f;){if(f.nodeType==3){n=f.nodeValue.replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,"").length;h+=n;if(h>=d)return{node:f,index:n-(h-d)}}else if(!K.$empty[f.tagName]){n=f[y.ie?"innerText":"textContent"].replace(/(^[\t\r\n]+)|([\t\r\n]+$)/,
"").length;h+=n;if(h>=d)if(n=c(f,n-(h-d),m))return n}f=l.getNextDomNode(f)}}function b(f,d){var m=f.selection.getRange(),h=d.searchStr,n=f.document.createElement("span");n.innerHTML="$$ueditor_searchreplace_key$$";m.shrinkBoundary(true);if(!m.collapsed){m.select();f=f.selection.getText();if((new RegExp("^"+d.searchStr+"$",d.casesensitive?"":"i")).test(f))if(d.replaceStr!=undefined){a(m,d.replaceStr);m.select();return true}else m.collapse(d.dir==-1)}m.insertNode(n);m.enlargeToBlockElm(true);f=m.startContainer;
var q=f[y.ie?"innerText":"textContent"].indexOf("$$ueditor_searchreplace_key$$");m.setStartBefore(n);l.remove(n);if(f=g(f,q,d)){n=c(f.node,f.index,h);h=c(f.node,f.index+h.length,h);m.setStart(n.node,n.index).setEnd(h.node,h.index);d.replaceStr!==undefined&&a(m,d.replaceStr);m.select();return true}else m.setCursor()}function a(f,d){d=e.document.createTextNode(d);f.deleteContents().insertNode(d)}var e=this,k={table:1,tbody:1,tr:1,ol:1,ul:1};return{commands:{searchreplace:{execCommand:function(f,d){v.extend(d,
{all:false,casesensitive:false,dir:1},true);f=0;if(d.all){var m=e.selection.getRange(),h=e.body.firstChild;if(h&&h.nodeType==1){m.setStart(h,0);m.shrinkBoundary(true)}else h.nodeType==3&&m.setStartBefore(h);m.collapse(true).select(true);for(d.replaceStr!==undefined&&e.fireEvent("saveScene");b(this,d);)f++}else{d.replaceStr!==undefined&&e.fireEvent("saveScene");b(this,d)&&f++}f&&e.fireEvent("saveScene");return f},notNeedUndo:1}}}});UE.plugins.customstyle=function(){var j=this;j.setOpt({customstyle:[{tag:"h1",
name:"tc",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:center;margin:0 0 20px 0;"},{tag:"h1",name:"tl",style:"font-size:32px;font-weight:bold;border-bottom:#ccc 2px solid;padding:0 4px 0 0;text-align:left;margin:0 0 10px 0;"},{tag:"span",name:"im",style:"font-size:16px;font-style:italic;font-weight:bold;line-height:18px;"},{tag:"span",name:"hi",style:"font-size:16px;font-style:italic;font-weight:bold;color:rgb(51, 153, 204);line-height:18px;"}]});
j.commands.customstyle={execCommand:function(g,c){g=this;var b=c.tag,a=l.findParent(g.selection.getStart(),function(q){return q.getAttribute("label")},true),e,k,f={};for(e in c)if(c[e]!==undefined)f[e]=c[e];delete f.tag;if(a&&a.getAttribute("label")==c.label){e=this.selection.getRange();k=e.createBookmark();if(e.collapsed)if(K.$block[a.tagName]){var d=g.document.createElement("p");l.moveChild(a,d);a.parentNode.insertBefore(d,a);l.remove(a)}else l.remove(a,true);else{a=l.getCommonAncestor(k.start,
k.end);f=l.getElementsByTagName(a,b);(new RegExp(b,"i")).test(a.tagName)&&f.push(a);for(var m=0,h;h=f[m++];)if(h.getAttribute("label")==c.label){d=l.getPosition(h,k.start);var n=l.getPosition(h,k.end);if((d&l.POSITION_FOLLOWING||d&l.POSITION_CONTAINS)&&(n&l.POSITION_PRECEDING||n&l.POSITION_CONTAINS))if(K.$block[b]){d=g.document.createElement("p");l.moveChild(h,d);h.parentNode.insertBefore(d,h)}l.remove(h,true)}(a=l.findParent(a,function(q){return q.getAttribute("label")==c.label},true))&&l.remove(a,
true)}e.moveToBookmark(k).select()}else if(K.$block[b]){this.execCommand("paragraph",b,f,"customstyle");e=g.selection.getRange();if(!e.collapsed){e.collapse();a=l.findParent(g.selection.getStart(),function(q){return q.getAttribute("label")==c.label},true);b=g.document.createElement("p");l.insertAfter(a,b);l.fillNode(g.document,b);e.setStart(b,0).setCursor()}}else{e=g.selection.getRange();if(e.collapsed){a=g.document.createElement(b);l.setAttributes(a,f);e.insertNode(a).setStart(a,0).setCursor()}else{k=
e.createBookmark();e.applyInlineStyle(b,f).moveToBookmark(k).select()}}},queryCommandValue:function(){var g=l.filterNodeList(this.selection.getStartElementPath(),function(c){return c.getAttribute("label")});return g?g.getAttribute("label"):""}};j.addListener("keyup",function(g,c){g=c.keyCode||c.which;if(g==32||g==13){g=j.selection.getRange();if(g.collapsed)if((c=l.findParent(j.selection.getStart(),function(a){return a.getAttribute("label")},true))&&K.$block[c.tagName]&&l.isEmptyNode(c)){var b=j.document.createElement("p");
l.insertAfter(c,b);l.fillNode(j.document,b);l.remove(c);g.setStart(b,0).setCursor()}}})};UE.plugins.catchremoteimage=function(){var j=this,g=UE.ajax;if(j.options.catchRemoteImageEnable!==false){j.setOpt({catchRemoteImageEnable:false});j.addListener("afterpaste",function(){j.fireEvent("catchRemoteImage")});j.addListener("catchRemoteImage",function(){function c(q,o){var p=v.serializeParam(j.queryCommandValue("serverparam"))||"";p=v.formatUrl(a+(a.indexOf("?")==-1?"?":"&")+p);o={method:"POST",dataType:v.isCrossDomainUrl(p)?
"jsonp":"",timeout:6E4,onsuccess:o.success,onerror:o.error};o[k]=q;g.request(p,o)}for(var b=j.getOpt("catcherLocalDomain"),a=j.getActionUrl(j.getOpt("catcherActionName")),e=j.getOpt("catcherUrlPrefix"),k=j.getOpt("catcherFieldName"),f=[],d=l.getElementsByTagName(j.document,"img"),m=function(q,o){if(q.indexOf(location.host)!=-1||/(^\.)|(^\/)/.test(q))return true;if(o)for(var p=0,r;r=o[p++];)if(q.indexOf(r)!==-1)return true;return false},h=0,n;n=d[h++];)if(!n.getAttribute("word_img")){n=n.getAttribute("_src")||
n.src||"";/^(https?|ftp):/i.test(n)&&!m(n,b)&&f.push(n)}f.length&&c(f,{success:function(q){try{var o=q.state!==undefined?q:eval("("+q.responseText+")")}catch(p){return}var r,s,t,u=o.list;for(q=0;o=d[q++];){t=o.getAttribute("_src")||o.src||"";for(r=0;s=u[r++];)if(t==s.source&&s.state=="SUCCESS"){r=e+s.url;l.setAttributes(o,{src:r,_src:r});break}}j.fireEvent("catchremotesuccess")},error:function(){j.fireEvent("catchremoteerror")}})})}};UE.plugin.register("snapscreen",function(){function j(b){var a=
document.createElement("a"),e=v.serializeParam(g.queryCommandValue("serverparam"))||"";a.href=b;if(y.ie)a.href=a.href;b=a.search;if(e){b=b+(b.indexOf("?")==-1?"?":"&")+e;b=b.replace(/[&]+/ig,"&")}return{port:a.port,hostname:a.hostname,path:a.pathname+b||+a.hash}}var g=this,c;return{commands:{snapscreen:{execCommand:function(){function b(m){try{m=eval("("+m+")");if(m.state=="SUCCESS"){var h=g.options;g.execCommand("insertimage",{src:h.snapscreenUrlPrefix+m.url,_src:h.snapscreenUrlPrefix+m.url,alt:m.title||
"",floatStyle:h.snapscreenImgAlign})}else alert(m.state)}catch(n){alert(f.callBackErrorMsg)}}var a,e,k,f=g.getLang("snapScreen_plugin");if(!c){a=g.container;c=(g.container.ownerDocument||g.container.document).createElement("object");try{c.type="application/x-pluginbaidusnap"}catch(d){return}c.style.cssText="position:absolute;left:-9999px;width:0;height:0;";c.setAttribute("width","0");c.setAttribute("height","0");a.appendChild(c)}a=g.getActionUrl(g.getOpt("snapscreenActionName"));e=j(a);setTimeout(function(){try{k=
c.saveSnapshot(e.hostname,e.path,e.port)}catch(m){g.ui._dialogs.snapscreenDialog.open();return}b(k)},50)},queryCommandState:function(){return navigator.userAgent.indexOf("Windows",0)!=-1?0:-1}}}}});UE.commands.insertparagraph={execCommand:function(j,g){j=this;for(var c=j.selection.getRange(),b=c.startContainer,a;b;){if(l.isBody(b))break;a=b;b=b.parentNode}if(a){b=j.document.createElement("p");g?a.parentNode.insertBefore(b,a):a.parentNode.insertBefore(b,a.nextSibling);l.fillNode(j.document,b);c.setStart(b,
0).setCursor(false,true)}}};UE.plugin.register("webapp",function(){function j(c,b){return!b?'<img title="'+c.title+'" width="'+c.width+'" height="'+c.height+'" src="'+g.options.UEDITOR_HOME_URL+'themes/default/images/spacer.gif" _logo_url="'+c.logo+'" style="background:url('+c.logo+') no-repeat center center; border:1px solid gray;" class="edui-faked-webapp" _url="'+c.url+'" '+(c.align&&!c.cssfloat?'align="'+c.align+'"':"")+(c.cssfloat?'style="float:'+c.cssfloat+'"':"")+"/>":'<iframe class="edui-faked-webapp" title="'+
c.title+'" '+(c.align&&!c.cssfloat?'align="'+c.align+'"':"")+(c.cssfloat?'style="float:'+c.cssfloat+'"':"")+'width="'+c.width+'" height="'+c.height+'"  scrolling="no" frameborder="0" src="'+c.url+'" logo_url = "'+c.logo+'"></iframe>'}var g=this;return{outputRule:function(c){v.each(c.getNodesByTagName("img"),function(b){var a;if(b.getAttr("class")=="edui-faked-webapp"){a=j({title:b.getAttr("title"),width:b.getAttr("width"),height:b.getAttr("height"),align:b.getAttr("align"),cssfloat:b.getStyle("float"),
url:b.getAttr("_url"),logo:b.getAttr("_logo_url")},true);a=UE.uNode.createElement(a);b.parentNode.replaceChild(a,b)}})},inputRule:function(c){v.each(c.getNodesByTagName("iframe"),function(b){if(b.getAttr("class")=="edui-faked-webapp"){var a=UE.uNode.createElement(j({title:b.getAttr("title"),width:b.getAttr("width"),height:b.getAttr("height"),align:b.getAttr("align"),cssfloat:b.getStyle("float"),url:b.getAttr("src"),logo:b.getAttr("logo_url")}));b.parentNode.replaceChild(a,b)}})},commands:{webapp:{execCommand:function(c,
b){c=this;b=j(v.extend(b,{align:"none"}),false);c.execCommand("inserthtml",b)},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();return c&&c.className=="edui-faked-webapp"?1:0}}}}});UE.plugin.register("music",function(){function j(c,b,a,e,k,f){return!f?"<img "+(e&&!k?'align="'+e+'"':"")+(k?'style="float:'+k+'"':"")+' width="'+b+'" height="'+a+'" _url="'+c+'" class="edui-faked-music" src="'+g.options.langPath+g.options.lang+'/images/music.png" />':'<embed type="application/x-shockwave-flash" class="edui-faked-music" pluginspage="http://www.macromedia.com/go/getflashplayer" src="'+
c+'" width="'+b+'" height="'+a+'" '+(e&&!k?'align="'+e+'"':"")+(k?'style="float:'+k+'"':"")+' wmode="transparent" play="true" loop="false" menu="false" allowscriptaccess="never" allowfullscreen="true" >'}var g=this;return{outputRule:function(c){v.each(c.getNodesByTagName("img"),function(b){var a;if(b.getAttr("class")=="edui-faked-music"){a=b.getStyle("float");var e=b.getAttr("align");a=j(b.getAttr("_url"),b.getAttr("width"),b.getAttr("height"),e,a,true);a=UE.uNode.createElement(a);b.parentNode.replaceChild(a,
b)}})},inputRule:function(c){v.each(c.getNodesByTagName("embed"),function(b){if(b.getAttr("class")=="edui-faked-music"){var a=b.getStyle("float"),e=b.getAttr("align");html=j(b.getAttr("src"),b.getAttr("width"),b.getAttr("height"),e,a,false);a=UE.uNode.createElement(html);b.parentNode.replaceChild(a,b)}})},commands:{music:{execCommand:function(c,b){c=this;b=j(b.url,b.width||400,b.height||95,"none",false);c.execCommand("inserthtml",b)},queryCommandState:function(){var c=this.selection.getRange().getClosedNode();
return c&&c.className=="edui-faked-music"?1:0}}}}});UE.plugin.register("autoupload",function(){function j(b,a){var e,k,f,d,m,h,n,q,o=/image\/\w+/i.test(b.type)?"image":"file",p="loading_"+(+new Date).toString(36);e=a.getOpt(o+"FieldName");k=a.getOpt(o+"UrlPrefix");f=a.getOpt(o+"MaxSize");d=a.getOpt(o+"AllowFiles");m=a.getActionUrl(a.getOpt(o+"ActionName"));n=function(r){var s=a.document.getElementById(p);s&&l.remove(s);a.fireEvent("showmessage",{id:p,content:r,type:"error",timeout:4E3})};if(o=="image"){h=
'<img class="loadingclass" id="'+p+'" src="'+a.options.themePath+a.options.theme+'/images/spacer.gif" title="'+(a.getLang("autoupload.loading")||"")+'" >';q=function(r){var s=k+r.url,t=a.document.getElementById(p);if(t){t.setAttribute("src",s);t.setAttribute("_src",s);t.setAttribute("title",r.title||"");t.setAttribute("alt",r.original||"");t.removeAttribute("id");l.removeClasses(t,"loadingclass")}}}else{h='<p><img class="loadingclass" id="'+p+'" src="'+a.options.themePath+a.options.theme+'/images/spacer.gif" title="'+
(a.getLang("autoupload.loading")||"")+'" ></p>';q=function(r){r=k+r.url;var s=a.document.getElementById(p),t=a.selection.getRange(),u=t.createBookmark();t.selectNode(s).select();a.execCommand("insertfile",{url:r});t.moveToBookmark(u).select()}}a.execCommand("inserthtml",h);if(a.getOpt(o+"ActionName"))if(b.size>f)n(a.getLang("autoupload.exceedSizeError"));else if((f=b.name?b.name.substr(b.name.lastIndexOf(".")):"")&&o!="image"||d&&(d.join("")+".").indexOf(f.toLowerCase()+".")==-1)n(a.getLang("autoupload.exceedTypeError"));
else{d=new XMLHttpRequest;o=new FormData;f=v.serializeParam(a.queryCommandValue("serverparam"))||"";m=v.formatUrl(m+(m.indexOf("?")==-1?"?":"&")+f);o.append(e,b,b.name||"blob."+b.type.substr(6));o.append("type","ajax");d.open("post",m,true);d.setRequestHeader("X-Requested-With","XMLHttpRequest");d.addEventListener("load",function(r){try{var s=(new Function("return "+v.trim(r.target.response)))();s.state=="SUCCESS"&&s.url?q(s):n(s.state)}catch(t){n(a.getLang("autoupload.loadError"))}});d.send(o)}else n(a.getLang("autoupload.errorLoadConfig"))}
function g(b){return b.clipboardData&&b.clipboardData.items&&b.clipboardData.items.length==1&&/^image\//.test(b.clipboardData.items[0].type)?b.clipboardData.items:null}function c(b){return b.dataTransfer&&b.dataTransfer.files?b.dataTransfer.files:null}return{outputRule:function(b){v.each(b.getNodesByTagName("img"),function(a){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(a.getAttr("class"))&&a.parentNode.removeChild(a)});v.each(b.getNodesByTagName("p"),function(a){/\bloadpara\b/.test(a.getAttr("class"))&&
a.parentNode.removeChild(a)})},bindEvents:{ready:function(){var b=this;if(window.FormData&&window.FileReader){l.on(b.body,"paste drop",function(a){var e=false,k;if(k=a.type=="paste"?g(a):c(a)){for(var f=k.length,d;f--;){d=k[f];if(d.getAsFile)d=d.getAsFile();if(d&&d.size>0){j(d,b);e=true}}e&&a.preventDefault()}});l.on(b.body,"dragover",function(a){a.dataTransfer.types[0]=="Files"&&a.preventDefault()});v.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+
this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-left:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)}}}}});UE.plugin.register("autosave",function(){function j(e){var k;if(!(new Date-c<b))if(e.hasContents()){c=
new Date;e._saveFlag=null;k=g.body.innerHTML;if(e.fireEvent("beforeautosave",{content:k})!==false){g.setPreferences(a,k);e.fireEvent("afterautosave",{content:k})}}else a&&g.removePreferences(a)}var g=this,c=new Date,b=20,a=null;return{defaultOptions:{saveInterval:500},bindEvents:{ready:function(){var e=null;e=g.key?g.key+"-drafts-data":(g.container.parentNode.id||"ue-common")+"-drafts-data";a=(location.protocol+location.host+location.pathname).replace(/[.:\/]/g,"_")+e},contentchange:function(){if(a){g._saveFlag&&
window.clearTimeout(g._saveFlag);if(g.options.saveInterval>0)g._saveFlag=window.setTimeout(function(){j(g)},g.options.saveInterval);else j(g)}}},commands:{clearlocaldata:{execCommand:function(){a&&g.getPreferences(a)&&g.removePreferences(a)},notNeedUndo:true,ignoreContentChange:true},getlocaldata:{execCommand:function(){return a?g.getPreferences(a)||"":""},notNeedUndo:true,ignoreContentChange:true},drafts:{execCommand:function(){if(a){g.body.innerHTML=g.getPreferences(a)||"<p>"+l.fillHtml+"</p>";
g.focus(true)}},queryCommandState:function(){return a?g.getPreferences(a)===null?-1:0:-1},notNeedUndo:true,ignoreContentChange:true}}}});UE.plugin.register("charts",function(){function j(c){var b=null,a=0;if(c.rows.length<2)return false;if(c.rows[0].cells.length<2)return false;b=c.rows[0].cells;a=b.length;for(var e=0,k;k=b[e];e++)if(k.tagName.toLowerCase()!=="th")return false;for(e=1;b=c.rows[e];e++){if(b.cells.length!=a)return false;if(b.cells[0].tagName.toLowerCase()!=="th")return false;for(var f=
1;k=b.cells[f];f++){k=v.trim(k.innerText||k.textContent||"");k=k.replace(new RegExp(UE.dom.domUtils.fillChar,"g"),"").replace(/^\s+|\s+$/g,"");if(!/^\d*\.?\d+$/.test(k))return false}}return true}var g=this;return{bindEvents:{chartserror:function(){}},commands:{charts:{execCommand:function(c,b){c=l.findParentByTagName(this.selection.getRange().startContainer,"table",true);var a=[],e={};if(!c)return false;if(!j(c)){g.fireEvent("chartserror");return false}e.title=b.title||"";e.subTitle=b.subTitle||"";
e.xTitle=b.xTitle||"";e.yTitle=b.yTitle||"";e.suffix=b.suffix||"";e.tip=b.tip||"";e.dataFormat=b.tableDataFormat||"";e.chartType=b.chartType||0;for(var k in e)e.hasOwnProperty(k)&&a.push(k+":"+e[k]);c.setAttribute("data-chart",a.join(";"));l.addClass(c,"edui-charts-table")},queryCommandState:function(){var c=l.findParentByTagName(this.selection.getRange().startContainer,"table",true);return c&&j(c)?0:-1}}},inputRule:function(c){v.each(c.getNodesByTagName("table"),function(b){b.getAttr("data-chart")!==
undefined&&b.setAttr("style")})},outputRule:function(c){v.each(c.getNodesByTagName("table"),function(b){b.getAttr("data-chart")!==undefined&&b.setAttr("style","display: none;")})}}});UE.plugin.register("section",function(){function j(){this.tag="";this.level=-1;this.parentSection=this.previousSection=this.nextSection=this.dom=null;this.startAddress=[];this.endAddress=[];this.children=[]}function g(a){var e=new j;return v.extend(e,a)}function c(a,e){e=e;for(var k=0;k<a.length;k++){if(!e.childNodes)return null;
e=e.childNodes[a[k]]}return e}var b=this;return{bindMultiEvents:{type:"aftersetcontent afterscencerestore",handler:function(){b.fireEvent("updateSections")}},bindEvents:{ready:function(){b.fireEvent("updateSections");l.on(b.body,"drop paste",function(){b.fireEvent("updateSections")})},afterexeccommand:function(a,e){e=="paragraph"&&b.fireEvent("updateSections")},keyup:function(a,e){a=this;if(a.selection.getRange().collapsed!=true)a.fireEvent("updateSections");else{e=e.keyCode||e.which;if(e==13||e==
8||e==46)a.fireEvent("updateSections")}}},commands:{getsections:{execCommand:function(a,e){function k(n){for(var q=0;q<d.length;q++)if(d[q](n))return q;return-1}function f(n,q){for(var o=null,p,r=n.childNodes,s=0,t=r.length;s<t;s++){p=r[s];n=k(p);if(n>=0){o=m.selection.getRange().selectNode(p).createAddress(true).startAddress;p=g({tag:p.tagName,title:p.innerText||p.textContent||"",level:n,dom:p,startAddress:v.clone(o,[]),endAddress:v.clone(o,[]),children:[]});h.nextSection=p;for(o=p.previousSection=
h;n<=o.level;)o=o.parentSection;p.parentSection=o;o.children.push(p);o=h=p}else{p.nodeType===1&&f(p,q);o&&o.endAddress[o.endAddress.length-1]++}}}var d=e||["h1","h2","h3","h4","h5","h6"];for(a=0;a<d.length;a++)if(typeof d[a]=="string")d[a]=function(n){return function(q){return q.tagName==n.toUpperCase()}}(d[a]);else if(typeof d[a]!="function")d[a]=function(){return null};var m=this;var h=a=g({level:-1,title:"root"});f(m.body,a);return a},notNeedUndo:true},movesection:{execCommand:function(a,e,k,f){function d(n,
q,o){for(var p=false,r=false,s=0;s<n.length;s++){if(s>=o.length)break;if(o[s]>n[s]){p=true;break}else if(o[s]<n[s])break}for(s=0;s<q.length;s++){if(s>=o.length)break;if(o[s]<n[s]){r=true;break}else if(o[s]>n[s])break}return p&&r}a=this;var m;if(!(!e||!k||k.level==-1)){m=f?k.endAddress:k.startAddress;k=c(m,a.body);if(!(!m||!k||d(e.startAddress,e.endAddress,m))){m=c(e.startAddress,a.body);e=c(e.endAddress,a.body);var h;if(f)for(f=e;f&&!(l.getPosition(m,f)&l.POSITION_FOLLOWING);){h=f.previousSibling;
l.insertAfter(k,f);if(f==m)break;f=h}else for(f=m;f&&!(l.getPosition(f,e)&l.POSITION_FOLLOWING);){h=f.nextSibling;k.parentNode.insertBefore(f,k);if(f==e)break;f=h}a.fireEvent("updateSections")}}}},deletesection:{execCommand:function(a,e,k){function f(m){for(var h=d.body,n=0;n<m.length;n++){if(!h.childNodes)return null;h=h.childNodes[m[n]]}return h}var d=this;if(e){a=f(e.startAddress);e=f(e.endAddress);a=a;if(k)l.remove(a);else for(;a&&l.inDoc(e,d.document)&&!(l.getPosition(a,e)&l.POSITION_FOLLOWING);){k=
a.nextSibling;l.remove(a);a=k}d.fireEvent("updateSections")}}},selectsection:{execCommand:function(a,e){if(!e&&!e.dom)return false;a=this.selection.getRange();e={startAddress:v.clone(e.startAddress,[]),endAddress:v.clone(e.endAddress,[])};e.endAddress[e.endAddress.length-1]++;a.moveToAddress(e).select().scrollToView();return true},notNeedUndo:true},scrolltosection:{execCommand:function(a,e){if(!e&&!e.dom)return false;a=this.selection.getRange();e={startAddress:e.startAddress,endAddress:e.endAddress};
e.endAddress[e.endAddress.length-1]++;a.moveToAddress(e).scrollToView();return true},notNeedUndo:true}}}});UE.plugin.register("simpleupload",function(){function j(){var a=b.offsetWidth||20,e=b.offsetHeight||20,k=document.createElement("iframe"),f="display:block;width:"+a+"px;height:"+e+"px;overflow:hidden;border:0;margin:0;padding:0;position:absolute;top:0;left:0;filter:alpha(opacity=0);-moz-opacity:0;-khtml-opacity: 0;opacity: 0;cursor:pointer;";l.on(k,"load",function(){var d=(+new Date).toString(36),
m,h,n;h=k.contentDocument||k.contentWindow.document;n=h.body;m=h.createElement("div");m.innerHTML='<form id="edui_form_'+d+'" target="edui_iframe_'+d+'" method="POST" enctype="multipart/form-data" action="'+g.getOpt("serverUrl")+'" style="'+f+'"><input id="edui_input_'+d+'" type="file" accept="image/*" name="'+g.options.imageFieldName+'" style="'+f+'"></form><iframe id="edui_iframe_'+d+'" name="edui_iframe_'+d+'" style="display:none;width:0;height:0;border:0;margin:0;padding:0;position:absolute;"></iframe>';
m.className="edui-"+g.options.theme;m.id=g.ui.id+"_iframeupload";n.style.cssText=f;n.style.width=a+"px";n.style.height=e+"px";n.appendChild(m);if(n.parentNode){n.parentNode.style.width=a+"px";n.parentNode.style.height=a+"px"}var q=h.getElementById("edui_form_"+d),o=h.getElementById("edui_input_"+d),p=h.getElementById("edui_iframe_"+d);l.on(o,"change",function(){function s(){try{var I,S,L,X=(p.contentDocument||p.contentWindow.document).body;S=(new Function("return "+(X.innerText||X.textContent||"")))();
I=g.options.imageUrlPrefix+S.url;if(S.state=="SUCCESS"&&S.url){L=g.document.getElementById(u);L.setAttribute("src",I);L.setAttribute("_src",I);L.setAttribute("title",S.title||"");L.setAttribute("alt",S.original||"");L.removeAttribute("id");l.removeClasses(L,"loadingclass")}else t&&t(S.state)}catch(T){t&&t(g.getLang("simpleupload.loadError"))}q.reset();l.un(p,"load",s)}function t(I){if(u){var S=g.document.getElementById(u);S&&l.remove(S);g.fireEvent("showmessage",{id:u,content:I,type:"error",timeout:4E3})}}
if(o.value){var u="loading_"+(+new Date).toString(36),w=v.serializeParam(g.queryCommandValue("serverparam"))||"",D=g.getActionUrl(g.getOpt("imageActionName")),z=g.getOpt("imageAllowFiles");g.focus();g.execCommand("inserthtml",'<img class="loadingclass" id="'+u+'" src="'+g.options.themePath+g.options.theme+'/images/spacer.gif" title="'+(g.getLang("simpleupload.loading")||"")+'" >');if(g.getOpt("imageActionName")){var F=o.value;F=F?F.substr(F.lastIndexOf(".")):"";if(!F||z&&(z.join("")+".").indexOf(F.toLowerCase()+
".")==-1)t(g.getLang("simpleupload.exceedTypeError"));else{l.on(p,"load",s);q.action=v.formatUrl(D+(D.indexOf("?")==-1?"?":"&")+w);q.submit()}}else errorHandler(g.getLang("autoupload.errorLoadConfig"))}});var r;g.addListener("selectionchange",function(){clearTimeout(r);r=setTimeout(function(){var s=g.queryCommandState("simpleupload");o.disabled=s==-1?"disabled":false},400)});c=true});k.style.cssText=f;b.appendChild(k)}var g=this,c=false,b;return{bindEvents:{ready:function(){v.cssRule("loading",".loadingclass{display:inline-block;cursor:default;background: url('"+
this.options.themePath+this.options.theme+"/images/loading.gif') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}\n.loaderrorclass{display:inline-block;cursor:default;background: url('"+this.options.themePath+this.options.theme+"/images/loaderror.png') no-repeat center center transparent;border:1px solid #cccccc;margin-right:1px;height: 22px;width: 22px;}",this.document)},simpleuploadbtnready:function(a,e){b=e;g.afterConfigReady(j)}},outputRule:function(a){v.each(a.getNodesByTagName("img"),
function(e){/\b(loaderrorclass)|(bloaderrorclass)\b/.test(e.getAttr("class"))&&e.parentNode.removeChild(e)})},commands:{simpleupload:{queryCommandState:function(){return c?0:-1}}}}});UE.plugin.register("serverparam",function(){var j={};return{commands:{serverparam:{execCommand:function(g,c,b){if(c===undefined||c===null)j={};else if(v.isString(c))if(b===undefined||b===null)delete j[c];else j[c]=b;else if(v.isObject(c))v.extend(j,c,true);else v.isFunction(c)&&v.extend(j,c(),true)},queryCommandValue:function(){return j||
{}}}}}});UE.plugin.register("insertfile",function(){function j(c){c=c.substr(c.lastIndexOf(".")+1).toLowerCase();var b={rar:"icon_rar.gif",zip:"icon_rar.gif",tar:"icon_rar.gif",gz:"icon_rar.gif",bz2:"icon_rar.gif",doc:"icon_doc.gif",docx:"icon_doc.gif",pdf:"icon_pdf.gif",mp3:"icon_mp3.gif",xls:"icon_xls.gif",chm:"icon_chm.gif",ppt:"icon_ppt.gif",pptx:"icon_ppt.gif",avi:"icon_mv.gif",rmvb:"icon_mv.gif",wmv:"icon_mv.gif",flv:"icon_mv.gif",swf:"icon_mv.gif",rm:"icon_mv.gif",exe:"icon_exe.gif",psd:"icon_psd.gif",
txt:"icon_txt.gif",jpg:"icon_jpg.gif",png:"icon_jpg.gif",jpeg:"icon_jpg.gif",gif:"icon_jpg.gif",ico:"icon_jpg.gif",bmp:"icon_jpg.gif"};return b[c]?b[c]:b.txt}var g=this;return{commands:{insertfile:{execCommand:function(c,b){b=v.isArray(b)?b:[b];var a,e,k,f;c="";a=g.getOpt("UEDITOR_HOME_URL");var d=a+(a.substr(a.length-1)=="/"?"":"/")+"dialogs/attachment/fileTypeImages/";for(a=0;a<b.length;a++){e=b[a];k=d+j(e.url);f=e.title||e.url.substr(e.url.lastIndexOf("/")+1);c+='<p style="line-height: 16px;"><img style="vertical-align: middle; margin-right: 2px;" src="'+
k+'" _src="'+k+'" /><a style="font-size:12px; color:#0066cc;" href="'+e.url+'" title="'+f+'">'+f+"</a></p>"}g.execCommand("insertHtml",c)}}}}});B=B||{};B.editor=B.editor||{};UE.ui=B.editor.ui={};(function(){function j(){var f=document.getElementById("edui_fixedlayer");k.setViewportOffset(f,{left:0,top:0})}function g(){b.on(window,"scroll",j);b.on(window,"resize",B.editor.utils.defer(j,0,true))}var c=B.editor.browser,b=B.editor.dom.domUtils,a=window.$EDITORUI={},e=0,k=B.editor.ui.uiUtils={uid:function(f){return f?
f.ID$EDITORUI||(f.ID$EDITORUI=++e):++e},hook:function(f,d){var m;if(f&&f._callbacks)m=f;else{m=function(){var h;if(f)h=f.apply(this,arguments);for(var n=m._callbacks,q=n.length;q--;){var o=n[q].apply(this,arguments);if(h===undefined)h=o}return h};m._callbacks=[]}m._callbacks.push(d);return m},createElementByHtml:function(f){var d=document.createElement("div");d.innerHTML=f;d=d.firstChild;d.parentNode.removeChild(d);return d},getViewportElement:function(){return c.ie&&c.quirks?document.body:document.documentElement},
getClientRect:function(f){var d;try{d=f.getBoundingClientRect()}catch(m){d={left:0,top:0,height:0,width:0}}for(var h={left:Math.round(d.left),top:Math.round(d.top),height:Math.round(d.bottom-d.top),width:Math.round(d.right-d.left)},n;(n=f.ownerDocument)!==document&&(f=b.getWindow(n).frameElement);){d=f.getBoundingClientRect();h.left+=d.left;h.top+=d.top}h.bottom=h.top+h.height;h.right=h.left+h.width;return h},getViewportRect:function(){var f=k.getViewportElement(),d=(window.innerWidth||f.clientWidth)|
0;f=(window.innerHeight||f.clientHeight)|0;return{left:0,top:0,height:f,width:d,bottom:f,right:d}},setViewportOffset:function(f,d){var m=k.getFixedLayer();if(f.parentNode===m){f.style.left=d.left+"px";f.style.top=d.top+"px"}else b.setViewportOffset(f,d)},getEventOffset:function(f){var d=k.getClientRect(f.target||f.srcElement);f=k.getViewportOffsetByEvent(f);return{left:f.left-d.left,top:f.top-d.top}},getViewportOffsetByEvent:function(f){var d=f.target||f.srcElement,m=b.getWindow(d).frameElement;f=
{left:f.clientX,top:f.clientY};if(m&&d.ownerDocument!==document){d=k.getClientRect(m);f.left+=d.left;f.top+=d.top}return f},setGlobal:function(f,d){a[f]=d;return'$EDITORUI["'+f+'"]'},unsetGlobal:function(f){delete a[f]},copyAttributes:function(f,d){for(var m=d.attributes,h=m.length;h--;){var n=m[h];if(n.nodeName!="style"&&n.nodeName!="class"&&(!c.ie||n.specified))f.setAttribute(n.nodeName,n.nodeValue)}d.className&&b.addClass(f,d.className);if(d.style.cssText)f.style.cssText+=";"+d.style.cssText},
removeStyle:function(f,d){if(f.style.removeProperty)f.style.removeProperty(d);else if(f.style.removeAttribute)f.style.removeAttribute(d);else throw"";},contains:function(f,d){return f&&d&&(f===d?false:f.contains?f.contains(d):f.compareDocumentPosition(d)&16)},startDrag:function(f,d,m){function h(s){d.ondragmove(s.clientX-n,s.clientY-q,s);if(s.stopPropagation)s.stopPropagation();else s.cancelBubble=true}m=m||document;var n=f.clientX,q=f.clientY;if(m.addEventListener){function o(){m.removeEventListener("mousemove",
h,true);m.removeEventListener("mouseup",o,true);window.removeEventListener("mouseup",o,true);d.ondragstop()}m.addEventListener("mousemove",h,true);m.addEventListener("mouseup",o,true);window.addEventListener("mouseup",o,true);f.preventDefault()}else{var p=f.srcElement;p.setCapture();function r(){p.releaseCapture();p.detachEvent("onmousemove",h);p.detachEvent("onmouseup",r);p.detachEvent("onlosecaptrue",r);d.ondragstop()}p.attachEvent("onmousemove",h);p.attachEvent("onmouseup",r);p.attachEvent("onlosecaptrue",
r);f.returnValue=false}d.ondragstart()},getFixedLayer:function(){var f=document.getElementById("edui_fixedlayer");if(f==null){f=document.createElement("div");f.id="edui_fixedlayer";document.body.appendChild(f);if(c.ie&&c.version<=8){f.style.position="absolute";g();setTimeout(j)}else f.style.position="fixed";f.style.left="0";f.style.top="0";f.style.width="0";f.style.height="0"}return f},makeUnselectable:function(f){if(c.opera||c.ie&&c.version<9){f.unselectable="on";if(f.hasChildNodes())for(var d=0;d<
f.childNodes.length;d++)f.childNodes[d].nodeType==1&&k.makeUnselectable(f.childNodes[d])}else if(f.style.MozUserSelect!==undefined)f.style.MozUserSelect="none";else if(f.style.WebkitUserSelect!==undefined)f.style.WebkitUserSelect="none";else if(f.style.KhtmlUserSelect!==undefined)f.style.KhtmlUserSelect="none"}}})();(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.EventBase,b=B.editor.ui.UIBase=function(){};b.prototype={className:"",uiName:"",initOptions:function(a){var e=this;for(var k in a)e[k]=
a[k];this.id=this.id||"edui"+g.uid()},initUIBase:function(){this._globalKey=j.unhtml(g.setGlobal(this.id,this))},render:function(a){var e=this.renderHtml();e=g.createElementByHtml(e);for(var k=l.getElementsByTagName(e,"*"),f="edui-"+(this.theme||this.editor.options.theme),d=document.getElementById("edui_fixedlayer"),m=0,h;h=k[m++];)l.addClass(h,f);l.addClass(e,f);if(d){d.className="";l.addClass(d,f)}k=this.getDom();if(k!=null){k.parentNode.replaceChild(e,k);g.copyAttributes(e,k)}else{if(typeof a==
"string")a=document.getElementById(a);a=a||g.getFixedLayer();l.addClass(a,f);a.appendChild(e)}this.postRender()},getDom:function(a){return a?document.getElementById(this.id+"_"+a):document.getElementById(this.id)},postRender:function(){this.fireEvent("postrender")},getHtmlTpl:function(){return""},formatHtml:function(a){var e="edui-"+this.uiName;return a.replace(/##/g,this.id).replace(/%%-/g,this.uiName?e+"-":"").replace(/%%/g,(this.uiName?e:"")+" "+this.className).replace(/\$\$/g,this._globalKey)},
renderHtml:function(){return this.formatHtml(this.getHtmlTpl())},dispose:function(){var a=this.getDom();a&&B.editor.dom.domUtils.remove(a);g.unsetGlobal(this.id)}};j.inherits(b,c)})();(function(){var j=B.editor.utils,g=B.editor.ui.UIBase,c=B.editor.ui.Separator=function(b){this.initOptions(b);this.initSeparator()};c.prototype={uiName:"separator",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"></div>'}};j.inherits(c,g)})();(function(){var j=
B.editor.utils,g=B.editor.dom.domUtils,c=B.editor.ui.UIBase,b=B.editor.ui.uiUtils,a=B.editor.ui.Mask=function(e){this.initOptions(e);this.initUIBase()};a.prototype={getHtmlTpl:function(){return'<div id="##" class="edui-mask %%" onclick="return $$._onClick(event, this);" onmousedown="return $$._onMouseDown(event, this);"></div>'},postRender:function(){var e=this;g.on(window,"resize",function(){setTimeout(function(){e.isHidden()||e._fill()})})},show:function(e){this._fill();this.getDom().style.display=
"";this.getDom().style.zIndex=e},hide:function(){this.getDom().style.display="none";this.getDom().style.zIndex=""},isHidden:function(){return this.getDom().style.display=="none"},_onMouseDown:function(){return false},_onClick:function(e,k){this.fireEvent("click",e,k)},_fill:function(){var e=this.getDom(),k=b.getViewportRect();e.style.width=k.width+"px";e.style.height=k.height+"px"}};j.inherits(a,c)})();(function(){function j(d,m){for(var h=0;h<k.length;h++){var n=k[h];if(!n.isHidden())if(n.queryAutoHide(m)!==
false){if(d&&/scroll/ig.test(d.type)&&n.className=="edui-wordpastepop")return;n.hide()}}k.length&&n.editor.fireEvent("afterhidepop")}var g=B.editor.utils,c=B.editor.ui.uiUtils,b=B.editor.dom.domUtils,a=B.editor.ui.UIBase,e=B.editor.ui.Popup=function(d){this.initOptions(d);this.initPopup()},k=[];e.postHide=j;var f=["edui-anchor-topleft","edui-anchor-topright","edui-anchor-bottomleft","edui-anchor-bottomright"];e.prototype={SHADOW_RADIUS:5,content:null,_hidden:false,autoRender:true,canSideLeft:true,
canSideUp:true,initPopup:function(){this.initUIBase();k.push(this)},getHtmlTpl:function(){return'<div id="##" class="edui-popup %%" onmousedown="return false;"> <div id="##_body" class="edui-popup-body"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-popup-content">'+this.getContentHtmlTpl()+"  </div> </div></div>"},getContentHtmlTpl:function(){if(this.content){if(typeof this.content==
"string")return this.content;return this.content.renderHtml()}else return""},_UIBase_postRender:a.prototype.postRender,postRender:function(){this.content instanceof a&&this.content.postRender();if(this.captureWheel&&!this.captured){this.captured=true;var d=(document.documentElement.clientHeight||document.body.clientHeight)-80,m=this.getDom().offsetHeight,h=c.getClientRect(this.combox.getDom()).top,n=this.getDom("content"),q=this.getDom("body").getElementsByTagName("iframe"),o=this;for(q.length&&(q=
q[0]);h+m>d;)m-=30;n.style.height=m+"px";q&&(q.style.height=m+"px");window.XMLHttpRequest?b.on(n,"onmousewheel"in document.body?"mousewheel":"DOMMouseScroll",function(p){if(p.preventDefault)p.preventDefault();else p.returnValue=false;n.scrollTop-=p.wheelDelta?p.wheelDelta/120*60:p.detail/-3*60}):b.on(this.getDom(),"mousewheel",function(p){p.returnValue=false;o.getDom("content").scrollTop-=p.wheelDelta/120*60})}this.fireEvent("postRenderAfter");this.hide(true);this._UIBase_postRender()},_doAutoRender:function(){!this.getDom()&&
this.autoRender&&this.render()},mesureSize:function(){var d=this.getDom("content");return c.getClientRect(d)},fitSize:function(){if(this.captureWheel&&this.sized)return this.__size;this.sized=true;var d=this.getDom("body");d.style.width="";d.style.height="";var m=this.mesureSize();if(this.captureWheel){d.style.width=-(-20-m.width)+"px";var h=parseInt(this.getDom("content").style.height,10);!window.isNaN(h)&&(m.height=h)}else d.style.width=m.width+"px";d.style.height=m.height+"px";this.__size=m;this.captureWheel&&
(this.getDom("content").style.overflow="auto");return m},showAnchor:function(d,m){this.showAnchorRect(c.getClientRect(d),m)},showAnchorRect:function(d,m){this._doAutoRender();var h=c.getViewportRect();this.getDom().style.visibility="hidden";this._show();var n=this.fitSize(),q;if(m){m=this.canSideLeft&&d.right+n.width>h.right&&d.left>n.width;h=this.canSideUp&&d.top+n.height>h.bottom&&d.bottom>n.height;q=m?d.left-n.width:d.right;d=h?d.bottom-n.height:d.top}else{m=this.canSideLeft&&d.right+n.width>h.right&&
d.left>n.width;h=this.canSideUp&&d.top+n.height>h.bottom&&d.bottom>n.height;q=m?d.right-n.width:d.left;d=h?d.top-n.height:d.bottom}n=this.getDom();c.setViewportOffset(n,{left:q,top:d});b.removeClasses(n,f);n.className+=" "+f[(h?1:0)*2+(m?1:0)];if(this.editor){n.style.zIndex=this.editor.container.style.zIndex*1+10;B.editor.ui.uiUtils.getFixedLayer().style.zIndex=n.style.zIndex-1}this.getDom().style.visibility="visible"},showAt:function(d){var m=d.left;d=d.top;this.showAnchorRect({left:m,top:d,right:m,
bottom:d,height:0,width:0},false,true)},_show:function(){if(this._hidden){this.getDom().style.display="";this._hidden=false;this.fireEvent("show")}},isHidden:function(){return this._hidden},show:function(){this._doAutoRender();this._show()},hide:function(d){if(!this._hidden&&this.getDom()){this.getDom().style.display="none";this._hidden=true;d||this.fireEvent("hide")}},queryAutoHide:function(d){return!d||!c.contains(this.getDom(),d)}};g.inherits(e,a);b.on(document,"mousedown",function(d){j(d,d.target||
d.srcElement)});b.on(window,"scroll",function(d,m){j(d,m)})})();(function(){function j(e,k){e='<div id="##" class="edui-colorpicker %%"><div class="edui-colorpicker-topbar edui-clearfix"><div unselectable="on" id="##_preview" class="edui-colorpicker-preview"></div><div unselectable="on" class="edui-colorpicker-nocolor" onclick="$$._onPickNoColor(event, this);">'+e+'</div></div><table  class="edui-box" style="border-collapse: collapse;" onmouseover="$$._onTableOver(event, this);" onmouseout="$$._onTableOut(event, this);" onclick="return $$._onTableClick(event, this);" cellspacing="0" cellpadding="0"><tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;padding-top: 2px"><td colspan="10">'+
k.getLang("themeColor")+'</td> </tr><tr class="edui-colorpicker-tablefirstrow" >';for(var f=0;f<a.length;f++){if(f&&f%10===0)e+="</tr>"+(f==60?'<tr style="border-bottom: 1px solid #ddd;font-size: 13px;line-height: 25px;color:#39C;"><td colspan="10">'+k.getLang("standardColor")+"</td></tr>":"")+"<tr"+(f==60?' class="edui-colorpicker-tablefirstrow"':"")+">";e+=f<70?'<td style="padding: 0 2px;"><a hidefocus title="'+a[f]+'" onclick="return false;" href="javascript:" unselectable="on" class="edui-box edui-colorpicker-colorcell" data-color="#'+
a[f]+'" style="background-color:#'+a[f]+";border:solid #ccc;"+(f<10||f>=60?"border-width:1px;":f>=10&&f<20?"border-width:1px 1px 0 1px;":"border-width:0 1px 0 1px;")+'"></a></td>':""}e+="</tr></table></div>";return e}var g=B.editor.utils,c=B.editor.ui.UIBase,b=B.editor.ui.ColorPicker=function(e){this.initOptions(e);this.noColorText=this.noColorText||this.editor.getLang("clearColor");this.initUIBase()};b.prototype={getHtmlTpl:function(){return j(this.noColorText,this.editor)},_onTableClick:function(e){(e=
(e.target||e.srcElement).getAttribute("data-color"))&&this.fireEvent("pickcolor",e)},_onTableOver:function(e){if(e=(e.target||e.srcElement).getAttribute("data-color"))this.getDom("preview").style.backgroundColor=e},_onTableOut:function(){this.getDom("preview").style.backgroundColor=""},_onPickNoColor:function(){this.fireEvent("picknocolor")}};g.inherits(b,c);var a="ffffff,000000,eeece1,1f497d,4f81bd,c0504d,9bbb59,8064a2,4bacc6,f79646,f2f2f2,7f7f7f,ddd9c3,c6d9f0,dbe5f1,f2dcdb,ebf1dd,e5e0ec,dbeef3,fdeada,d8d8d8,595959,c4bd97,8db3e2,b8cce4,e5b9b7,d7e3bc,ccc1d9,b7dde8,fbd5b5,bfbfbf,3f3f3f,938953,548dd4,95b3d7,d99694,c3d69b,b2a2c7,92cddc,fac08f,a5a5a5,262626,494429,17365d,366092,953734,76923c,5f497a,31859b,e36c09,7f7f7f,0c0c0c,1d1b10,0f243e,244061,632423,4f6128,3f3151,205867,974806,c00000,ff0000,ffc000,ffff00,92d050,00b050,00b0f0,0070c0,002060,7030a0,".split(",")})();
(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,b=B.editor.ui.TablePicker=function(a){this.initOptions(a);this.initTablePicker()};b.prototype={defaultNumRows:10,defaultNumCols:10,maxNumRows:20,maxNumCols:20,numRows:10,numCols:10,lengthOfCellSide:22,initTablePicker:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-tablepicker %%"><div class="edui-tablepicker-body"><div class="edui-infoarea"><span id="##_label" class="edui-label"></span></div><div class="edui-pickarea" onmousemove="$$._onMouseMove(event, this);" onmouseover="$$._onMouseOver(event, this);" onmouseout="$$._onMouseOut(event, this);" onclick="$$._onClick(event, this);"><div id="##_overlay" class="edui-overlay"></div></div></div></div>'},
_UIBase_render:c.prototype.render,render:function(a){this._UIBase_render(a);this.getDom("label").innerHTML="0"+this.editor.getLang("t_row")+" x 0"+this.editor.getLang("t_col")},_track:function(a,e){var k=this.getDom("overlay").style,f=this.lengthOfCellSide;k.width=a*f+"px";k.height=e*f+"px";this.getDom("label").innerHTML=a+this.editor.getLang("t_col")+" x "+e+this.editor.getLang("t_row");this.numCols=a;this.numRows=e},_onMouseOver:function(a,e){a=a.relatedTarget||a.fromElement;if(!g.contains(e,a)&&
e!==a){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility=""}},_onMouseOut:function(a,e){a=a.relatedTarget||a.toElement;if(!g.contains(e,a)&&e!==a){this.getDom("label").innerHTML="0"+this.editor.getLang("t_col")+" x 0"+this.editor.getLang("t_row");this.getDom("overlay").style.visibility="hidden"}},_onMouseMove:function(a){this.getDom("overlay");var e=g.getEventOffset(a),k=this.lengthOfCellSide;a=Math.ceil(e.left/
k);e=Math.ceil(e.top/k);this._track(a,e)},_onClick:function(){this.fireEvent("picktable",this.numCols,this.numRows)}};j.inherits(b,c)})();(function(){var j=B.editor.dom.domUtils,g=B.editor.ui.uiUtils,c='onmousedown="$$.Stateful_onMouseDown(event, this);" onmouseup="$$.Stateful_onMouseUp(event, this);"'+(B.editor.browser.ie?' onmouseenter="$$.Stateful_onMouseEnter(event, this);" onmouseleave="$$.Stateful_onMouseLeave(event, this);"':' onmouseover="$$.Stateful_onMouseOver(event, this);" onmouseout="$$.Stateful_onMouseOut(event, this);"');
B.editor.ui.Stateful={alwalysHoverable:false,target:null,Stateful_init:function(){this._Stateful_dGetHtmlTpl=this.getHtmlTpl;this.getHtmlTpl=this.Stateful_getHtmlTpl},Stateful_getHtmlTpl:function(){return this._Stateful_dGetHtmlTpl().replace(/stateful/g,function(){return c})},Stateful_onMouseEnter:function(b,a){this.target=a;if(!this.isDisabled()||this.alwalysHoverable){this.addState("hover");this.fireEvent("over")}},Stateful_onMouseLeave:function(){if(!this.isDisabled()||this.alwalysHoverable){this.removeState("hover");
this.removeState("active");this.fireEvent("out")}},Stateful_onMouseOver:function(b,a){var e=b.relatedTarget;!g.contains(a,e)&&a!==e&&this.Stateful_onMouseEnter(b,a)},Stateful_onMouseOut:function(b,a){var e=b.relatedTarget;!g.contains(a,e)&&a!==e&&this.Stateful_onMouseLeave(b,a)},Stateful_onMouseDown:function(){this.isDisabled()||this.addState("active")},Stateful_onMouseUp:function(){this.isDisabled()||this.removeState("active")},Stateful_postRender:function(){this.disabled&&!this.hasState("disabled")&&
this.addState("disabled")},hasState:function(b){return j.hasClass(this.getStateDom(),"edui-state-"+b)},addState:function(b){this.hasState(b)||(this.getStateDom().className+=" edui-state-"+b)},removeState:function(b){this.hasState(b)&&j.removeClasses(this.getStateDom(),["edui-state-"+b])},getStateDom:function(){return this.getDom("state")},isChecked:function(){return this.hasState("checked")},setChecked:function(b){!this.isDisabled()&&b?this.addState("checked"):this.removeState("checked")},isDisabled:function(){return this.hasState("disabled")},
setDisabled:function(b){if(b){this.removeState("hover");this.removeState("checked");this.removeState("active");this.addState("disabled")}else this.removeState("disabled")}}})();(function(){var j=B.editor.utils,g=B.editor.ui.UIBase,c=B.editor.ui.Stateful,b=B.editor.ui.Button=function(a){if(a.name){var e=a.name,k=a.cssRules;if(!a.className)a.className="edui-for-"+e;a.cssRules=".edui-default  .edui-for-"+e+" .edui-icon {"+k+"}"}this.initOptions(a);this.initButton()};b.prototype={uiName:"button",label:"",
title:"",showIcon:true,showText:true,cssRules:"",initButton:function(){this.initUIBase();this.Stateful_init();this.cssRules&&j.cssRule("edui-customize-"+this.name+"-style",this.cssRules)},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div id="##_state" stateful><div class="%%-wrap"><div id="##_body" unselectable="on" '+(this.title?'title="'+this.title+'"':"")+' class="%%-body" onmousedown="return $$._onMouseDown(event, this);" onclick="return $$._onClick(event, this);">'+(this.showIcon?
'<div class="edui-box edui-icon"></div>':"")+(this.showText?'<div class="edui-box edui-label">'+this.label+"</div>":"")+"</div></div></div></div>"},postRender:function(){this.Stateful_postRender();this.setDisabled(this.disabled)},_onMouseDown:function(a){a=(a=a.target||a.srcElement)&&a.tagName&&a.tagName.toLowerCase();if(a=="input"||a=="object"||a=="object")return false},_onClick:function(){this.isDisabled()||this.fireEvent("click")},setTitle:function(a){this.getDom("label").innerHTML=a}};j.inherits(b,
g);j.extend(b.prototype,c)})();(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,b=B.editor.ui.Stateful,a=B.editor.ui.SplitButton=function(e){this.initOptions(e);this.initSplitButton()};a.prototype={popup:null,uiName:"splitbutton",title:"",initSplitButton:function(){this.initUIBase();this.Stateful_init();if(this.popup!=null){var e=this.popup;this.popup=null;this.setPopup(e)}},_UIBase_postRender:c.prototype.postRender,postRender:function(){this.Stateful_postRender();this._UIBase_postRender()},
setPopup:function(e){if(this.popup!==e){this.popup!=null&&this.popup.dispose();e.addListener("show",j.bind(this._onPopupShow,this));e.addListener("hide",j.bind(this._onPopupHide,this));e.addListener("postrender",j.bind(function(){e.getDom("body").appendChild(g.createElementByHtml('<div id="'+this.popup.id+'_bordereraser" class="edui-bordereraser edui-background" style="width:'+(g.getClientRect(this.getDom()).width+20)+'px"></div>'));e.getDom().className+=" "+this.className},this));this.popup=e}},
_onPopupShow:function(){this.addState("opened")},_onPopupHide:function(){this.removeState("opened")},getHtmlTpl:function(){return'<div id="##" class="edui-box %%"><div '+(this.title?'title="'+this.title+'"':"")+' id="##_state" stateful><div class="%%-body"><div id="##_button_body" class="edui-box edui-button-body" onclick="$$._onButtonClick(event, this);"><div class="edui-box edui-icon"></div></div><div class="edui-box edui-splitborder"></div><div class="edui-box edui-arrow" onclick="$$._onArrowClick();"></div></div></div></div>'},
showPopup:function(){var e=g.getClientRect(this.getDom());e.top-=this.popup.SHADOW_RADIUS;e.height+=this.popup.SHADOW_RADIUS;this.popup.showAnchorRect(e)},_onArrowClick:function(){this.isDisabled()||this.showPopup()},_onButtonClick:function(){this.isDisabled()||this.fireEvent("buttonclick")}};j.inherits(a,c);j.extend(a.prototype,b,true)})();(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.ui.ColorPicker,b=B.editor.ui.Popup,a=B.editor.ui.SplitButton,e=B.editor.ui.ColorButton=function(k){this.initOptions(k);
this.initColorButton()};e.prototype={initColorButton:function(){var k=this;this.popup=new b({content:new c({noColorText:k.editor.getLang("clearColor"),editor:k.editor,onpickcolor:function(f,d){k._onPickColor(d)},onpicknocolor:function(f,d){k._onPickNoColor(d)}}),editor:k.editor});this.initSplitButton()},_SplitButton_postRender:a.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.getDom("button_body").appendChild(g.createElementByHtml('<div id="'+this.id+'_colorlump" class="edui-colorlump"></div>'));
this.getDom().className+=" edui-colorbutton"},setColor:function(k){this.color=this.getDom("colorlump").style.backgroundColor=k},_onPickColor:function(k){if(this.fireEvent("pickcolor",k)!==false){this.setColor(k);this.popup.hide()}},_onPickNoColor:function(){this.fireEvent("picknocolor")!==false&&this.popup.hide()}};j.inherits(e,a)})();(function(){var j=B.editor.utils,g=B.editor.ui.Popup,c=B.editor.ui.TablePicker,b=B.editor.ui.SplitButton,a=B.editor.ui.TableButton=function(e){this.initOptions(e);this.initTableButton()};
a.prototype={initTableButton:function(){var e=this;this.popup=new g({content:new c({editor:e.editor,onpicktable:function(k,f,d){e._onPickTable(f,d)}}),editor:e.editor});this.initSplitButton()},_onPickTable:function(e,k){this.fireEvent("picktable",e,k)!==false&&this.popup.hide()}};j.inherits(a,b)})();(function(){var j=B.editor.utils,g=B.editor.ui.UIBase,c=B.editor.ui.AutoTypeSetPicker=function(b){this.initOptions(b);this.initAutoTypeSetPicker()};c.prototype={initAutoTypeSetPicker:function(){this.initUIBase()},
getHtmlTpl:function(){var b=this.editor,a=b.options.autotypeset,e=b.getLang("autoTypeSet"),k="textAlignValue"+b.uid,f="imageBlockLineValue"+b.uid,d="symbolConverValue"+b.uid;return'<div id="##" class="edui-autotypesetpicker %%"><div class="edui-autotypesetpicker-body"><table ><tr><td nowrap><input type="checkbox" name="mergeEmptyline" '+(a.mergeEmptyline?"checked":"")+">"+e.mergeLine+'</td><td colspan="2"><input type="checkbox" name="removeEmptyline" '+(a.removeEmptyline?"checked":"")+">"+e.delLine+
'</td></tr><tr><td nowrap><input type="checkbox" name="removeClass" '+(a.removeClass?"checked":"")+">"+e.removeFormat+'</td><td colspan="2"><input type="checkbox" name="indent" '+(a.indent?"checked":"")+">"+e.indent+'</td></tr><tr><td nowrap><input type="checkbox" name="textAlign" '+(a.textAlign?"checked":"")+">"+e.alignment+'</td><td colspan="2" id="'+k+'"><input type="radio" name="'+k+'" value="left" '+(a.textAlign&&a.textAlign=="left"?"checked":"")+">"+b.getLang("justifyleft")+'<input type="radio" name="'+
k+'" value="center" '+(a.textAlign&&a.textAlign=="center"?"checked":"")+">"+b.getLang("justifycenter")+'<input type="radio" name="'+k+'" value="right" '+(a.textAlign&&a.textAlign=="right"?"checked":"")+">"+b.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="imageBlockLine" '+(a.imageBlockLine?"checked":"")+">"+e.imageFloat+'</td><td nowrap id="'+f+'"><input type="radio" name="'+f+'" value="none" '+(a.imageBlockLine&&a.imageBlockLine=="none"?"checked":"")+">"+b.getLang("default")+
'<input type="radio" name="'+f+'" value="left" '+(a.imageBlockLine&&a.imageBlockLine=="left"?"checked":"")+">"+b.getLang("justifyleft")+'<input type="radio" name="'+f+'" value="center" '+(a.imageBlockLine&&a.imageBlockLine=="center"?"checked":"")+">"+b.getLang("justifycenter")+'<input type="radio" name="'+f+'" value="right" '+(a.imageBlockLine&&a.imageBlockLine=="right"?"checked":"")+">"+b.getLang("justifyright")+'</td></tr><tr><td nowrap><input type="checkbox" name="clearFontSize" '+(a.clearFontSize?
"checked":"")+">"+e.removeFontsize+'</td><td colspan="2"><input type="checkbox" name="clearFontFamily" '+(a.clearFontFamily?"checked":"")+">"+e.removeFontFamily+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="removeEmptyNode" '+(a.removeEmptyNode?"checked":"")+">"+e.removeHtml+'</td></tr><tr><td nowrap colspan="3"><input type="checkbox" name="pasteFilter" '+(a.pasteFilter?"checked":"")+">"+e.pasteFilter+'</td></tr><tr><td nowrap><input type="checkbox" name="symbolConver" '+(a.bdc2sb||
a.tobdc?"checked":"")+">"+e.symbol+'</td><td id="'+d+'"><input type="radio" name="bdc" value="bdc2sb" '+(a.bdc2sb?"checked":"")+">"+e.bdc2sb+'<input type="radio" name="bdc" value="tobdc" '+(a.tobdc?"checked":"")+">"+e.tobdc+'</td><td nowrap align="right"><button >'+e.run+"</button></td></tr></table></div></div>"},_UIBase_render:g.prototype.render};j.inherits(c,g)})();(function(){function j(k){var f={},d=k.getDom(),m=k.editor.uid,h=null;h=null;for(var n=l.getElementsByTagName(d,"input"),q=n.length-
1,o;o=n[q--];){h=o.getAttribute("type");if(h=="checkbox"){h=o.getAttribute("name");f[h]&&delete f[h];if(o.checked)if(o=document.getElementById(h+"Value"+m))if(/input/ig.test(o.tagName))f[h]=o.value;else{o=o.getElementsByTagName("input");for(var p=o.length-1,r;r=o[p--];)if(r.checked){f[h]=r.value;break}}else f[h]=true;else f[h]=false}else f[o.getAttribute("value")]=o.checked}d=l.getElementsByTagName(d,"select");for(q=0;m=d[q++];){n=m.getAttribute("name");f[n]=f[n]?m.value:""}g.extend(k.editor.options.autotypeset,
f);k.editor.setPreferences("autotypeset",f)}var g=B.editor.utils,c=B.editor.ui.Popup,b=B.editor.ui.AutoTypeSetPicker,a=B.editor.ui.SplitButton,e=B.editor.ui.AutoTypeSetButton=function(k){this.initOptions(k);this.initAutoTypeSetButton()};e.prototype={initAutoTypeSetButton:function(){var k=this;this.popup=new c({content:new b({editor:k.editor}),editor:k.editor,hide:function(){if(!this._hidden&&this.getDom()){j(this);this.getDom().style.display="none";this._hidden=true;this.fireEvent("hide")}}});var f=
0;this.popup.addListener("postRenderAfter",function(){var d=this;if(!f){var m=this.getDom();m.getElementsByTagName("button")[0].onclick=function(){j(d);k.editor.execCommand("autotypeset");d.hide()};l.on(m,"click",function(h){h=h.target||h.srcElement;var n=k.editor.uid;if(h&&h.tagName=="INPUT"){if(h.name=="imageBlockLine"||h.name=="textAlign"||h.name=="symbolConver")for(var q=h.checked,o=document.getElementById(h.name+"Value"+n).getElementsByTagName("input"),p={imageBlockLine:"none",textAlign:"left",
symbolConver:"tobdc"},r=0;r<o.length;r++)if(q){if(o[r].value==p[h.name])o[r].checked="checked"}else o[r].checked=false;if(h.name=="imageBlockLineValue"+n||h.name=="textAlignValue"+n||h.name=="bdc")(h=h.parentNode.previousSibling.getElementsByTagName("input"))&&(h[0].checked=true);j(d)}});f=1}});this.initSplitButton()}};g.inherits(e,a)})();(function(){var j=B.editor.utils,g=B.editor.ui.Popup,c=B.editor.ui.Stateful,b=B.editor.ui.UIBase,a=B.editor.ui.CellAlignPicker=function(e){this.initOptions(e);this.initSelected();
this.initCellAlignPicker()};a.prototype={initSelected:function(){var e={valign:{top:0,middle:1,bottom:2},align:{left:0,center:1,right:2},count:3};if(this.selected)this.selectedIndex=e.valign[this.selected.valign]*e.count+e.align[this.selected.align]},initCellAlignPicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){for(var e=["left","center","right"],k=null,f=-1,d=[],m=0;m<9;m++){k=this.selectedIndex===m?' class="edui-cellalign-selected" ':"";f=m%3;f===0&&d.push("<tr>");
d.push('<td index="'+m+'" '+k+' stateful><div class="edui-icon edui-'+e[f]+'"></div></td>');f===2&&d.push("</tr>")}return'<div id="##" class="edui-cellalignpicker %%"><div class="edui-cellalignpicker-body"><table onclick="$$._onClick(event);">'+d.join("")+"</table></div></div>"},getStateDom:function(){return this.target},_onClick:function(e){var k=e.target||e.srcElement;if(/icon/.test(k.className)){this.items[k.parentNode.getAttribute("index")].onclick();g.postHide(e)}},_UIBase_render:b.prototype.render};
j.inherits(a,b);j.extend(a.prototype,c,true)})();(function(){var j=B.editor.utils,g=B.editor.ui.Stateful,c=B.editor.ui.uiUtils,b=B.editor.ui.UIBase,a=B.editor.ui.PastePicker=function(e){this.initOptions(e);this.initPastePicker()};a.prototype={initPastePicker:function(){this.initUIBase();this.Stateful_init()},getHtmlTpl:function(){return'<div class="edui-pasteicon" onclick="$$._onClick(this)"></div><div class="edui-pastecontainer"><div class="edui-title">'+this.editor.getLang("pasteOpt")+'</div><div class="edui-button"><div title="'+
this.editor.getLang("pasteSourceFormat")+'" onclick="$$.format(false)" stateful><div class="edui-richtxticon"></div></div><div title="'+this.editor.getLang("tagFormat")+'" onclick="$$.format(2)" stateful><div class="edui-tagicon"></div></div><div title="'+this.editor.getLang("pasteTextFormat")+'" onclick="$$.format(true)" stateful><div class="edui-plaintxticon"></div></div></div></div></div>'},getStateDom:function(){return this.target},format:function(e){this.editor.ui._isTransfer=true;this.editor.fireEvent("pasteTransfer",
e)},_onClick:function(e){var k=l.getNextDomNode(e),f=c.getViewportRect().height,d=c.getClientRect(k);k.style.top=d.top+d.height>f?-d.height-e.offsetHeight+"px":"";if(/hidden/ig.test(l.getComputedStyle(k,"visibility"))){k.style.visibility="visible";l.addClass(e,"edui-state-opened")}else{k.style.visibility="hidden";l.removeClasses(e,"edui-state-opened")}},_UIBase_render:b.prototype.render};j.inherits(a,b);j.extend(a.prototype,g,true)})();(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.ui.UIBase,
b=B.editor.ui.Toolbar=function(a){this.initOptions(a);this.initToolbar()};b.prototype={items:null,initToolbar:function(){this.items=this.items||[];this.initUIBase()},add:function(a,e){e===undefined?this.items.push(a):this.items.splice(e,0,a)},getHtmlTpl:function(){for(var a=[],e=0;e<this.items.length;e++)a[e]=this.items[e].renderHtml();return'<div id="##" class="edui-toolbar %%" onselectstart="return false;" onmousedown="return $$._onMouseDown(event, this);">'+a.join("")+"</div>"},postRender:function(){for(var a=
this.getDom(),e=0;e<this.items.length;e++)this.items[e].postRender();g.makeUnselectable(a)},_onMouseDown:function(a){a=(a=a.target||a.srcElement)&&a.tagName&&a.tagName.toLowerCase();if(a=="input"||a=="object"||a=="object")return false}};j.inherits(b,c)})();(function(){var j=B.editor.utils,g=B.editor.dom.domUtils,c=B.editor.ui.uiUtils,b=B.editor.ui.UIBase,a=B.editor.ui.Popup,e=B.editor.ui.Stateful,k=B.editor.ui.CellAlignPicker,f=B.editor.ui.Menu=function(h){this.initOptions(h);this.initMenu()},d={renderHtml:function(){return'<div class="edui-menuitem edui-menuseparator"><div class="edui-menuseparator-inner"></div></div>'},
postRender:function(){},queryAutoHide:function(){return true}};f.prototype={items:null,uiName:"menu",initMenu:function(){this.items=this.items||[];this.initPopup();this.initItems()},initItems:function(){for(var h=0;h<this.items.length;h++){var n=this.items[h];if(n=="-")this.items[h]=this.getSeparator();else if(!(n instanceof m)){n.editor=this.editor;n.theme=this.editor.options.theme;this.items[h]=this.createItem(n)}}},getSeparator:function(){return d},createItem:function(h){h.menu=this;return new m(h)},
_Popup_getContentHtmlTpl:a.prototype.getContentHtmlTpl,getContentHtmlTpl:function(){if(this.items.length==0)return this._Popup_getContentHtmlTpl();for(var h=[],n=0;n<this.items.length;n++)h[n]=this.items[n].renderHtml();return'<div class="%%-body">'+h.join("")+"</div>"},_Popup_postRender:a.prototype.postRender,postRender:function(){for(var h=this,n=0;n<this.items.length;n++){var q=this.items[n];q.ownerMenu=this;q.postRender()}g.on(this.getDom(),"mouseover",function(o){o=o||event;o=o.relatedTarget||
o.fromElement;var p=h.getDom();!c.contains(p,o)&&p!==o&&h.fireEvent("over")});this._Popup_postRender()},queryAutoHide:function(h){if(h){if(c.contains(this.getDom(),h))return false;for(var n=0;n<this.items.length;n++)if(this.items[n].queryAutoHide(h)===false)return false}},clearItems:function(){for(var h=0;h<this.items.length;h++){var n=this.items[h];clearTimeout(n._showingTimer);clearTimeout(n._closingTimer);n.subMenu&&n.subMenu.destroy()}this.items=[]},destroy:function(){this.getDom()&&g.remove(this.getDom());
this.clearItems()},dispose:function(){this.destroy()}};j.inherits(f,a);var m=B.editor.ui.MenuItem=function(h){this.initOptions(h);this.initUIBase();this.Stateful_init();if(this.subMenu&&!(this.subMenu instanceof f))if(h.className&&h.className.indexOf("aligntd")!=-1){var n=this;this.subMenu.selected=this.editor.queryCommandValue("cellalignment");this.subMenu=new a({content:new k(this.subMenu),parentMenu:n,editor:n.editor,destroy:function(){this.getDom()&&g.remove(this.getDom())}});this.subMenu.addListener("postRenderAfter",
function(){g.on(this.getDom(),"mouseover",function(){n.addState("opened")})})}else this.subMenu=new f(this.subMenu)};m.prototype={label:"",subMenu:null,ownerMenu:null,uiName:"menuitem",alwalysHoverable:true,getHtmlTpl:function(){return'<div id="##" class="%%" stateful onclick="$$._onClick(event, this);"><div class="%%-body">'+this.renderLabelHtml()+"</div></div>"},postRender:function(){var h=this;this.addListener("over",function(){h.ownerMenu.fireEvent("submenuover",h);h.subMenu&&h.delayShowSubMenu()});
if(this.subMenu){this.getDom().className+=" edui-hassubmenu";this.subMenu.render();this.addListener("out",function(){h.delayHideSubMenu()});this.subMenu.addListener("over",function(){clearTimeout(h._closingTimer);h._closingTimer=null;h.addState("opened")});this.ownerMenu.addListener("hide",function(){h.hideSubMenu()});this.ownerMenu.addListener("submenuover",function(n,q){q!==h&&h.delayHideSubMenu()});this.subMenu._bakQueryAutoHide=this.subMenu.queryAutoHide;this.subMenu.queryAutoHide=function(n){if(n&&
c.contains(h.getDom(),n))return false;return this._bakQueryAutoHide(n)}}this.getDom().style.tabIndex="-1";c.makeUnselectable(this.getDom());this.Stateful_postRender()},delayShowSubMenu:function(){var h=this;if(!h.isDisabled()){h.addState("opened");clearTimeout(h._showingTimer);clearTimeout(h._closingTimer);h._closingTimer=null;h._showingTimer=setTimeout(function(){h.showSubMenu()},250)}},delayHideSubMenu:function(){var h=this;if(!h.isDisabled()){h.removeState("opened");clearTimeout(h._showingTimer);
if(!h._closingTimer)h._closingTimer=setTimeout(function(){h.hasState("opened")||h.hideSubMenu();h._closingTimer=null},400)}},renderLabelHtml:function(){return'<div class="edui-arrow"></div><div class="edui-box edui-icon"></div><div class="edui-box edui-label %%-label">'+(this.label||"")+"</div>"},getStateDom:function(){return this.getDom()},queryAutoHide:function(h){if(this.subMenu&&this.hasState("opened"))return this.subMenu.queryAutoHide(h)},_onClick:function(h,n){if(!this.hasState("disabled"))if(this.fireEvent("click",
h,n)!==false)this.subMenu?this.showSubMenu():a.postHide(h)},showSubMenu:function(){var h=c.getClientRect(this.getDom());h.right-=5;h.left+=2;h.width-=7;h.top-=4;h.bottom+=4;h.height+=8;this.subMenu.showAnchorRect(h,true,true)},hideSubMenu:function(){this.subMenu.hide()}};j.inherits(m,b);j.extend(m.prototype,e,true)})();(function(){var j=B.editor.utils,g=B.editor.ui.uiUtils,c=B.editor.ui.Menu,b=B.editor.ui.SplitButton,a=B.editor.ui.Combox=function(e){this.initOptions(e);this.initCombox()};a.prototype=
{uiName:"combox",onbuttonclick:function(){this.showPopup()},initCombox:function(){var e=this;this.items=this.items||[];for(var k=0;k<this.items.length;k++){var f=this.items[k];f.uiName="listitem";f.index=k;f.onclick=function(){e.selectByIndex(this.index)}}this.popup=new c({items:this.items,uiName:"list",editor:this.editor,captureWheel:true,combox:this});this.initSplitButton()},_SplitButton_postRender:b.prototype.postRender,postRender:function(){this._SplitButton_postRender();this.setLabel(this.label||
"");this.setValue(this.initValue||"")},showPopup:function(){var e=g.getClientRect(this.getDom());e.top+=1;e.bottom-=1;e.height-=2;this.popup.showAnchorRect(e)},getValue:function(){return this.value},setValue:function(e){var k=this.indexByValue(e);if(k!=-1){this.selectedIndex=k;this.setLabel(this.items[k].label);this.value=this.items[k].value}else{this.selectedIndex=-1;this.setLabel(this.getLabelForUnknowValue(e));this.value=e}},setLabel:function(e){this.label=this.getDom("button_body").innerHTML=
e},getLabelForUnknowValue:function(e){return e},indexByValue:function(e){for(var k=0;k<this.items.length;k++)if(e==this.items[k].value)return k;return-1},getItem:function(e){return this.items[e]},selectByIndex:function(e){if(e<this.items.length&&this.fireEvent("select",e)!==false){this.selectedIndex=e;this.value=this.items[e].value;this.setLabel(this.items[e].label)}}};j.inherits(a,b)})();(function(){var j=B.editor.utils,g=B.editor.dom.domUtils,c=B.editor.ui.uiUtils,b=B.editor.ui.Mask,a=B.editor.ui.UIBase,
e=B.editor.ui.Button,k=B.editor.ui.Dialog=function(h){if(h.name){var n=h.name,q=h.cssRules;if(!h.className)h.className="edui-for-"+n;if(q)h.cssRules=".edui-default .edui-for-"+n+" .edui-dialog-content  {"+q+"}"}this.initOptions(j.extend({autoReset:true,draggable:true,onok:function(){},oncancel:function(){},onclose:function(o,p){return p?this.onok():this.oncancel()},holdScroll:false},h));this.initDialog()},f,d,m;k.prototype={draggable:false,uiName:"dialog",initDialog:function(){var h=this,n=this.editor.options.theme;
this.cssRules&&j.cssRule("edui-customize-"+this.name+"-style",this.cssRules);this.initUIBase();this.modalMask=f||(f=new b({className:"edui-dialog-modalmask",theme:n,onclick:function(){m&&m.close(false)}}));this.dragMask=d||(d=new b({className:"edui-dialog-dragmask",theme:n}));this.closeButton=new e({className:"edui-dialog-closebutton",title:h.closeDialog,theme:n,onclick:function(){h.close(false)}});this.fullscreen&&this.initResizeEvent();if(this.buttons)for(n=0;n<this.buttons.length;n++)this.buttons[n]instanceof
e||(this.buttons[n]=new e(j.extend(this.buttons[n],{editor:this.editor},true)))},initResizeEvent:function(){var h=this;g.on(window,"resize",function(){if(!(h._hidden||h._hidden===undefined)){h.__resizeTimer&&window.clearTimeout(h.__resizeTimer);h.__resizeTimer=window.setTimeout(function(){h.__resizeTimer=null;var n=h.getDom(),q=h.getDom("content"),o=UE.ui.uiUtils.getClientRect(n),p=UE.ui.uiUtils.getClientRect(q),r=c.getViewportRect();q.style.width=r.width-o.width+p.width+"px";q.style.height=r.height-
o.height+p.height+"px";n.style.width=r.width+"px";n.style.height=r.height+"px";h.fireEvent("resize")},100)}})},fitSize:function(){var h=this.getDom("body"),n=this.mesureSize();h.style.width=n.width+"px";h.style.height=n.height+"px";return n},safeSetOffset:function(h){var n=this.getDom(),q=c.getViewportRect(),o=c.getClientRect(n),p=h.left;if(p+o.width>q.right)p=q.right-o.width;h=h.top;if(h+o.height>q.bottom)h=q.bottom-o.height;n.style.left=Math.max(p,0)+"px";n.style.top=Math.max(h,0)+"px"},showAtCenter:function(){var h=
c.getViewportRect();if(this.fullscreen){var n=this.getDom(),q=this.getDom("content");n.style.display="block";var o=UE.ui.uiUtils.getClientRect(n),p=UE.ui.uiUtils.getClientRect(q);n.style.left="-100000px";q.style.width=h.width-o.width+p.width+"px";q.style.height=h.height-o.height+p.height+"px";n.style.width=h.width+"px";n.style.height=h.height+"px";n.style.left=0;this._originalContext={html:{overflowX:document.documentElement.style.overflowX,overflowY:document.documentElement.style.overflowY},body:{overflowX:document.body.style.overflowX,
overflowY:document.body.style.overflowY}};document.documentElement.style.overflowX="hidden";document.documentElement.style.overflowY="hidden";document.body.style.overflowX="hidden";document.body.style.overflowY="hidden"}else{this.getDom().style.display="";q=this.fitSize();o=this.getDom("titlebar").offsetHeight|0;n=h.width/2-q.width/2;h=h.height/2-(q.height-o)/2-o;q=this.getDom();this.safeSetOffset({left:Math.max(n|0,0),top:Math.max(h|0,0)});g.hasClass(q,"edui-state-centered")||(q.className+=" edui-state-centered")}this._show()},
getContentHtml:function(){var h="";if(typeof this.content=="string")h=this.content;else if(this.iframeUrl)h='<span id="'+this.id+'_contmask" class="dialogcontmask"></span><iframe id="'+this.id+'_iframe" class="%%-iframe" height="100%" width="100%" frameborder="0" src="'+this.iframeUrl+'"></iframe>';return h},getHtmlTpl:function(){var h="";if(this.buttons){h=[];for(var n=0;n<this.buttons.length;n++)h[n]=this.buttons[n].renderHtml();h='<div class="%%-foot"><div id="##_buttons" class="%%-buttons">'+
h.join("")+"</div></div>"}return'<div id="##" class="%%"><div '+(!this.fullscreen?'class="%%"':'class="%%-wrap edui-dialog-fullscreen-flag"')+'><div id="##_body" class="%%-body"><div class="%%-shadow"></div><div id="##_titlebar" class="%%-titlebar"><div class="%%-draghandle" onmousedown="$$._onTitlebarMouseDown(event, this);"><span class="%%-caption">'+(this.title||"")+"</span></div>"+this.closeButton.renderHtml()+'</div><div id="##_content" class="%%-content">'+(this.autoReset?"":this.getContentHtml())+
"</div>"+h+"</div></div></div>"},postRender:function(){if(!this.modalMask.getDom()){this.modalMask.render();this.modalMask.hide()}if(!this.dragMask.getDom()){this.dragMask.render();this.dragMask.hide()}var h=this;this.addListener("show",function(){h.modalMask.show(this.getDom().style.zIndex-2)});this.addListener("hide",function(){h.modalMask.hide()});if(this.buttons)for(var n=0;n<this.buttons.length;n++)this.buttons[n].postRender();g.on(window,"resize",function(){setTimeout(function(){h.isHidden()||
h.safeSetOffset(c.getClientRect(h.getDom()))})});this._hide()},mesureSize:function(){var h=this.getDom("body"),n=c.getClientRect(this.getDom("content")).width;h.style.width=n;return c.getClientRect(h)},_onTitlebarMouseDown:function(h){if(this.draggable){var n;c.getViewportRect();var q=this;c.startDrag(h,{ondragstart:function(){n=c.getClientRect(q.getDom());q.getDom("contmask").style.visibility="visible";q.dragMask.show(q.getDom().style.zIndex-1)},ondragmove:function(o,p){q.safeSetOffset({left:n.left+
o,top:n.top+p})},ondragstop:function(){q.getDom("contmask").style.visibility="hidden";g.removeClasses(q.getDom(),["edui-state-centered"]);q.dragMask.hide()}})}},reset:function(){this.getDom("content").innerHTML=this.getContentHtml();this.fireEvent("dialogafterreset")},_show:function(){if(this._hidden){this.getDom().style.display="";this.editor.container.style.zIndex&&(this.getDom().style.zIndex=this.editor.container.style.zIndex*1+10);this._hidden=false;this.fireEvent("show");B.editor.ui.uiUtils.getFixedLayer().style.zIndex=
this.getDom().style.zIndex-4}},isHidden:function(){return this._hidden},_hide:function(){if(!this._hidden){var h=this.getDom();h.style.display="none";h.style.zIndex="";h.style.width="";h.style.height="";this._hidden=true;this.fireEvent("hide")}},open:function(){if(this.autoReset)try{this.reset()}catch(h){this.render();this.open()}this.showAtCenter();if(this.iframeUrl)try{this.getDom("iframe").focus()}catch(n){}m=this},_onCloseButtonClick:function(){this.close(false)},close:function(h){if(this.fireEvent("close",
h)!==false){if(this.fullscreen){document.documentElement.style.overflowX=this._originalContext.html.overflowX;document.documentElement.style.overflowY=this._originalContext.html.overflowY;document.body.style.overflowX=this._originalContext.body.overflowX;document.body.style.overflowY=this._originalContext.body.overflowY;delete this._originalContext}this._hide();h=this.getDom("content");var n=this.getDom("iframe");if(h&&n){(n=n.contentDocument||n.contentWindow.document)&&(n.body.innerHTML="");g.remove(h)}}}};
j.inherits(k,a)})();(function(){var j=B.editor.utils,g=B.editor.ui.Menu,c=B.editor.ui.SplitButton,b=B.editor.ui.MenuButton=function(a){this.initOptions(a);this.initMenuButton()};b.prototype={initMenuButton:function(){var a=this;this.uiName="menubutton";this.popup=new g({items:a.items,className:a.className,editor:a.editor});this.popup.addListener("show",function(){for(var e=this,k=0;k<e.items.length;k++){e.items[k].removeState("checked");if(e.items[k].value==a._value){e.items[k].addState("checked");
this.value=a._value}}});this.initSplitButton()},setValue:function(a){this._value=a}};j.inherits(b,c)})();(function(){var j=B.editor.utils,g=B.editor.ui.Popup,c=B.editor.ui.SplitButton,b=B.editor.ui.MultiMenuPop=function(a){this.initOptions(a);this.initMultiMenu()};b.prototype={initMultiMenu:function(){var a=this;this.popup=new g({content:"",editor:a.editor,iframe_rendered:false,onshow:function(){if(!this.iframe_rendered){this.iframe_rendered=true;this.getDom("content").innerHTML='<iframe id="'+a.id+
'_iframe" src="'+a.iframeUrl+'" frameborder="0"></iframe>';a.editor.container.style.zIndex&&(this.getDom().style.zIndex=a.editor.container.style.zIndex*1+1)}}});this.onbuttonclick=function(){this.showPopup()};this.initSplitButton()}};j.inherits(b,c)})();(function(){function j(h){if(!e.findParent(h.target||h.srcElement,function(q){return e.hasClass(q,"edui-shortcutmenu")||e.hasClass(q,"edui-popup")},true)){h=0;for(var n;n=k[h++];)n.hide()}}var g=B.editor.ui,c=g.UIBase,b=g.uiUtils,a=B.editor.utils,
e=B.editor.dom.domUtils,k=[],f,d=false,m=g.ShortCutMenu=function(h){this.initOptions(h);this.initShortCutMenu()};m.postHide=j;m.prototype={isHidden:true,SPACE:5,initShortCutMenu:function(){this.items=this.items||[];this.initUIBase();this.initItems();this.initEvent();k.push(this)},initEvent:function(){var h=this,n=h.editor.document;e.on(n,"mousemove",function(q){if(h.isHidden===false)if(!(h.getSubMenuMark()||h.eventType=="contextmenu")){var o=true,p=h.getDom(),r=p.offsetWidth/2+h.SPACE,s=p.offsetHeight/
2,t=Math.abs(q.screenX-h.left),u=Math.abs(q.screenY-h.top);clearTimeout(f);f=setTimeout(function(){if(u>0&&u<s)h.setOpacity(p,"1");else if(u>s&&u<s+70){h.setOpacity(p,"0.5");o=false}else u>s+70&&u<s+140&&h.hide();if(o&&t>0&&t<r)h.setOpacity(p,"1");else if(t>r&&t<r+70)h.setOpacity(p,"0.5");else t>r+70&&t<r+140&&h.hide()})}});y.chrome&&e.on(n,"mouseout",function(q){q=q.relatedTarget||q.toElement;if(q==null||q.tagName=="HTML")h.hide()});h.editor.addListener("afterhidepop",function(){h.isHidden||(d=true)})},
initItems:function(){if(a.isArray(this.items))for(var h=0,n=this.items.length;h<n;h++){var q=this.items[h].toLowerCase();if(g[q]){this.items[h]=new g[q](this.editor);this.items[h].className+=" edui-shortcutsubmenu "}}},setOpacity:function(h,n){if(y.ie&&y.version<9)h.style.filter="alpha(opacity = "+parseFloat(n)*100+");";else h.style.opacity=n},getSubMenuMark:function(){d=false;var h=b.getFixedLayer();h=e.getElementsByTagName(h,"div",function(o){return e.hasClass(o,"edui-shortcutsubmenu edui-popup")});
for(var n=0,q;q=h[n++];)if(q.style.display!="none")d=true;return d},show:function(h,n){function q(u){if(u.left<0)u.left=0;if(u.top<0)u.top=0;s.style.cssText="position:absolute;left:"+u.left+"px;top:"+u.top+"px;"}function o(u){u.tagName||(u=u.getDom());r.left=parseInt(u.style.left);r.top=parseInt(u.style.top);r.top-=s.offsetHeight+15;q(r)}var p=this,r={},s=this.getDom(),t=b.getFixedLayer();p.eventType=h.type;s.style.cssText="display:block;left:-9999px";if(h.type=="contextmenu"&&n)(n=e.getElementsByTagName(t,
"div","edui-contextmenu")[0])?o(n):p.editor.addListener("aftershowcontextmenu",function(u,w){o(w)});else{r=b.getViewportOffsetByEvent(h);r.top-=s.offsetHeight+p.SPACE;r.left+=p.SPACE+20;q(r);p.setOpacity(s,0.2)}p.isHidden=false;p.left=h.screenX+s.offsetWidth/2-p.SPACE;p.top=h.screenY-s.offsetHeight/2-p.SPACE;if(p.editor){s.style.zIndex=p.editor.container.style.zIndex*1+10;t.style.zIndex=s.style.zIndex-1}},hide:function(){if(this.getDom())this.getDom().style.display="none";this.isHidden=true},postRender:function(){if(a.isArray(this.items))for(var h=
0,n;n=this.items[h++];)n.postRender()},getHtmlTpl:function(){var h;if(a.isArray(this.items)){h=[];for(var n=0;n<this.items.length;n++)h[n]=this.items[n].renderHtml();h=h.join("")}else h=this.items;return'<div id="##" class="%% edui-toolbar" data-src="shortcutmenu" onmousedown="return false;" onselectstart="return false;" >'+h+"</div>"}};a.inherits(m,c);e.on(document,"mousedown",function(h){j(h)});e.on(window,"scroll",function(h){j(h)})})();(function(){var j=B.editor.utils,g=B.editor.ui.UIBase,c=B.editor.ui.Breakline=
function(b){this.initOptions(b);this.initSeparator()};c.prototype={uiName:"Breakline",initSeparator:function(){this.initUIBase()},getHtmlTpl:function(){return"<br/>"}};j.inherits(c,g)})();(function(){var j=B.editor.utils,g=B.editor.dom.domUtils,c=B.editor.ui.UIBase,b=B.editor.ui.Message=function(a){this.initOptions(a);this.initMessage()};b.prototype={initMessage:function(){this.initUIBase()},getHtmlTpl:function(){return'<div id="##" class="edui-message %%"> <div id="##_closer" class="edui-message-closer">\u00d7</div> <div id="##_body" class="edui-message-body edui-message-type-info"> <iframe style="position:absolute;z-index:-1;left:0;top:0;background-color: transparent;" frameborder="0" width="100%" height="100%" src="about:blank"></iframe> <div class="edui-shadow"></div> <div id="##_content" class="edui-message-content">  </div> </div></div>'},
reset:function(a){var e=this;if(!a.keepshow){clearTimeout(this.timer);e.timer=setTimeout(function(){e.hide()},a.timeout||4E3)}a.content!==undefined&&e.setContent(a.content);a.type!==undefined&&e.setType(a.type);e.show()},postRender:function(){var a=this,e=this.getDom("closer");e&&g.on(e,"click",function(){a.hide()})},setContent:function(a){this.getDom("content").innerHTML=a},setType:function(a){a=a||"info";var e=this.getDom("body");e.className=e.className.replace(/edui-message-type-[\w-]+/,"edui-message-type-"+
a)},getContent:function(){return this.getDom("content").innerHTML},getType:function(){var a=this.getDom("body").match(/edui-message-type-([\w-]+)/);return a?a[1]:""},show:function(){this.getDom().style.display="block"},hide:function(){var a=this.getDom();if(a){a.style.display="none";a.parentNode&&a.parentNode.removeChild(a)}}};j.inherits(b,c)})();(function(){var j=B.editor.utils,g=B.editor.ui,c=g.Dialog;g.buttons={};g.Dialog=function(d){var m=new c(d);m.addListener("hide",function(){if(m.editor){var h=
m.editor;try{if(y.gecko){var n=h.window.scrollY,q=h.window.scrollX;h.body.focus();h.window.scrollTo(q,n)}else h.focus()}catch(o){}}});return m};for(var b={anchor:"~/dialogs/anchor/anchor.html",insertimage:"~/dialogs/image/image.html",link:"~/dialogs/link/link.html",spechars:"~/dialogs/spechars/spechars.html",searchreplace:"~/dialogs/searchreplace/searchreplace.html",map:"~/dialogs/map/map.html",gmap:"~/dialogs/gmap/gmap.html",insertvideo:"~/dialogs/video/video.html",help:"~/dialogs/help/help.html",
preview:"~/dialogs/preview/preview.html",emotion:"~/dialogs/emotion/emotion.html",wordimage:"~/dialogs/wordimage/wordimage.html",attachment:"~/dialogs/attachment/attachment.html",insertframe:"~/dialogs/insertframe/insertframe.html",edittip:"~/dialogs/table/edittip.html",edittable:"~/dialogs/table/edittable.html",edittd:"~/dialogs/table/edittd.html",webapp:"~/dialogs/webapp/webapp.html",snapscreen:"~/dialogs/snapscreen/snapscreen.html",scrawl:"~/dialogs/scrawl/scrawl.html",music:"~/dialogs/music/music.html",
template:"~/dialogs/template/template.html",background:"~/dialogs/background/background.html",charts:"~/dialogs/charts/charts.html"},a=["undo","redo","formatmatch","bold","italic","underline","fontborder","touppercase","tolowercase","strikethrough","subscript","superscript","source","indent","outdent","blockquote","pasteplain","pagebreak","selectall","print","horizontal","removeformat","time","date","unlink","insertparagraphbeforetable","insertrow","insertcol","mergeright","mergedown","deleterow",
"deletecol","splittorows","splittocols","splittocells","mergecells","deletetable","drafts"],e=0,k;k=a[e++];){k=k.toLowerCase();g[k]=function(d){return function(m){var h=new g.Button({className:"edui-for-"+d,title:m.options.labelMap[d]||m.getLang("labelMap."+d)||"",onclick:function(){m.execCommand(d)},theme:m.options.theme,showText:false});g.buttons[d]=h;m.addListener("selectionchange",function(n,q,o){n=m.queryCommandState(d);if(n==-1){h.setDisabled(true);h.setChecked(false)}else if(!o){h.setDisabled(false);
h.setChecked(n)}});return h}}(k)}g.cleardoc=function(d){var m=new g.Button({className:"edui-for-cleardoc",title:d.options.labelMap.cleardoc||d.getLang("labelMap.cleardoc")||"",theme:d.options.theme,onclick:function(){confirm(d.getLang("confirmClear"))&&d.execCommand("cleardoc")}});g.buttons.cleardoc=m;d.addListener("selectionchange",function(){m.setDisabled(d.queryCommandState("cleardoc")==-1)});return m};a={justify:["left","right","center","justify"],imagefloat:["none","left","center","right"],directionality:["ltr",
"rtl"]};for(var f in a)(function(d,m){for(var h=0,n;n=m[h++];)(function(q){g[d.replace("float","")+q]=function(o){var p=new g.Button({className:"edui-for-"+d.replace("float","")+q,title:o.options.labelMap[d.replace("float","")+q]||o.getLang("labelMap."+d.replace("float","")+q)||"",theme:o.options.theme,onclick:function(){o.execCommand(d,q)}});g.buttons[d]=p;o.addListener("selectionchange",function(r,s,t){p.setDisabled(o.queryCommandState(d)==-1);p.setChecked(o.queryCommandValue(d)==q&&!t)});return p}})(n)})(f,
a[f]);for(e=0;k=["backcolor","forecolor"][e++];)g[k]=function(d){return function(m){var h=new g.ColorButton({className:"edui-for-"+d,color:"default",title:m.options.labelMap[d]||m.getLang("labelMap."+d)||"",editor:m,onpickcolor:function(n,q){m.execCommand(d,q)},onpicknocolor:function(){m.execCommand(d,"default");this.setColor("transparent");this.color="default"},onbuttonclick:function(){m.execCommand(d,this.color)}});g.buttons[d]=h;m.addListener("selectionchange",function(){h.setDisabled(m.queryCommandState(d)==
-1)});return h}}(k);a={noOk:["searchreplace","help","spechars","webapp","preview"],ok:["attachment","anchor","link","insertimage","map","gmap","insertframe","wordimage","insertvideo","insertframe","edittip","edittable","edittd","scrawl","template","music","background","charts"]};for(f in a)(function(d,m){for(var h=0,n;n=m[h++];)y.opera&&n==="searchreplace"||function(q){g[q]=function(o,p,r){p=p||(o.options.iframeUrlMap||{})[q]||b[q];r=o.options.labelMap[q]||o.getLang("labelMap."+q)||"";var s;if(p){s=
new g.Dialog(j.extend({iframeUrl:o.ui.mapUrl(p),editor:o,className:"edui-for-"+q,title:r,holdScroll:q==="insertimage",fullscreen:/charts|preview/.test(q),closeDialog:o.getLang("closeDialog")},d=="ok"?{buttons:[{className:"edui-okbutton",label:o.getLang("ok"),editor:o,onclick:function(){s.close(true)}},{className:"edui-cancelbutton",label:o.getLang("cancel"),editor:o,onclick:function(){s.close(false)}}]}:{}));o.ui._dialogs[q+"Dialog"]=s}var t=new g.Button({className:"edui-for-"+q,title:r,onclick:function(){if(s)switch(q){case "wordimage":var u=
o.execCommand("wordimage");if(u&&u.length){s.render();s.open()}break;case "scrawl":if(o.queryCommandState("scrawl")!=-1){s.render();s.open()}break;default:s.render();s.open()}},theme:o.options.theme,disabled:q=="scrawl"&&o.queryCommandState("scrawl")==-1||q=="charts"});g.buttons[q]=t;o.addListener("selectionchange",function(){if(!(q in{edittable:1})){var u=o.queryCommandState(q);if(t.getDom()){t.setDisabled(u==-1);t.setChecked(u)}}});return t}}(n.toLowerCase())})(f,a[f]);g.snapscreen=function(d,m,
h){h=d.options.labelMap.snapscreen||d.getLang("labelMap.snapscreen")||"";var n=new g.Button({className:"edui-for-snapscreen",title:h,onclick:function(){d.execCommand("snapscreen")},theme:d.options.theme});g.buttons.snapscreen=n;if(m=m||(d.options.iframeUrlMap||{}).snapscreen||b.snapscreen){var q=new g.Dialog({iframeUrl:d.ui.mapUrl(m),editor:d,className:"edui-for-snapscreen",title:h,buttons:[{className:"edui-okbutton",label:d.getLang("ok"),editor:d,onclick:function(){q.close(true)}},{className:"edui-cancelbutton",
label:d.getLang("cancel"),editor:d,onclick:function(){q.close(false)}}]});q.render();d.ui._dialogs.snapscreenDialog=q}d.addListener("selectionchange",function(){n.setDisabled(d.queryCommandState("snapscreen")==-1)});return n};g.insertcode=function(d,m,h){m=d.options.insertcode||[];h=d.options.labelMap.insertcode||d.getLang("labelMap.insertcode")||"";var n=[];j.each(m,function(o,p){n.push({label:o,value:p,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" >'+(this.label||
"")+"</div>"}})});var q=new g.Combox({editor:d,items:n,onselect:function(o,p){d.execCommand("insertcode",this.items[p].value)},onbuttonclick:function(){this.showPopup()},title:h,initValue:h,className:"edui-for-insertcode",indexByValue:function(o){if(o)for(var p=0,r;r=this.items[p];p++)if(r.value.indexOf(o)!=-1)return p;return-1}});g.buttons.insertcode=q;d.addListener("selectionchange",function(o,p,r){if(!r)if(d.queryCommandState("insertcode")==-1)q.setDisabled(true);else{q.setDisabled(false);if(o=
d.queryCommandValue("insertcode")){o&&(o=o.replace(/['"]/g,"").split(",")[0]);q.setValue(o)}else q.setValue(h)}});return q};g.fontfamily=function(d,m,h){m=d.options.fontfamily||[];h=d.options.labelMap.fontfamily||d.getLang("labelMap.fontfamily")||"";if(m.length){for(var n=0,q,o=[];q=m[n];n++){var p=d.getLang("fontfamily")[q.name]||"";(function(s,t){o.push({label:s,value:t,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="font-family:'+j.unhtml(this.value)+
'">'+(this.label||"")+"</div>"}})})(q.label||p,q.val)}var r=new g.Combox({editor:d,items:o,onselect:function(s,t){d.execCommand("FontFamily",this.items[t].value)},onbuttonclick:function(){this.showPopup()},title:h,initValue:h,className:"edui-for-fontfamily",indexByValue:function(s){if(s)for(var t=0,u;u=this.items[t];t++)if(u.value.indexOf(s)!=-1)return t;return-1}});g.buttons.fontfamily=r;d.addListener("selectionchange",function(s,t,u){if(!u)if(d.queryCommandState("FontFamily")==-1)r.setDisabled(true);
else{r.setDisabled(false);(s=d.queryCommandValue("FontFamily"))&&(s=s.replace(/['"]/g,"").split(",")[0]);r.setValue(s)}});return r}};g.fontsize=function(d,m,h){h=d.options.labelMap.fontsize||d.getLang("labelMap.fontsize")||"";m=m||d.options.fontsize||[];if(m.length){for(var n=[],q=0;q<m.length;q++){var o=m[q]+"px";n.push({label:o,value:o,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label" style="line-height:1;font-size:'+this.value+'">'+(this.label||"")+"</div>"}})}var p=
new g.Combox({editor:d,items:n,title:h,initValue:h,onselect:function(r,s){d.execCommand("FontSize",this.items[s].value)},onbuttonclick:function(){this.showPopup()},className:"edui-for-fontsize"});g.buttons.fontsize=p;d.addListener("selectionchange",function(r,s,t){if(!t)if(d.queryCommandState("FontSize")==-1)p.setDisabled(true);else{p.setDisabled(false);p.setValue(d.queryCommandValue("FontSize"))}});return p}};g.paragraph=function(d,m,h){h=d.options.labelMap.paragraph||d.getLang("labelMap.paragraph")||
"";m=d.options.paragraph||[];if(!j.isEmptyObject(m)){var n=[];for(var q in m)n.push({value:q,label:m[q]||d.getLang("paragraph")[q],theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><span class="edui-for-'+this.value+'">'+(this.label||"")+"</span></div>"}});var o=new g.Combox({editor:d,items:n,title:h,initValue:h,className:"edui-for-paragraph",onselect:function(p,r){d.execCommand("Paragraph",this.items[r].value)},onbuttonclick:function(){this.showPopup()}});g.buttons.paragraph=
o;d.addListener("selectionchange",function(p,r,s){if(!s)if(d.queryCommandState("Paragraph")==-1)o.setDisabled(true);else{o.setDisabled(false);p=d.queryCommandValue("Paragraph");o.indexByValue(p)!=-1?o.setValue(p):o.setValue(o.initValue)}});return o}};g.customstyle=function(d){var m=d.options.customstyle||[],h=d.options.labelMap.customstyle||d.getLang("labelMap.customstyle")||"";if(m.length){for(var n=d.getLang("customstyle"),q=0,o=[],p;p=m[q++];)(function(s){var t={};t.label=s.label?s.label:n[s.name];
t.style=s.style;t.className=s.className;t.tag=s.tag;o.push({label:t.label,value:t,theme:d.options.theme,renderLabelHtml:function(){return'<div class="edui-label %%-label"><'+t.tag+" "+(t.className?' class="'+t.className+'"':"")+(t.style?' style="'+t.style+'"':"")+">"+t.label+"</"+t.tag+"></div>"}})})(p);var r=new g.Combox({editor:d,items:o,title:h,initValue:h,className:"edui-for-customstyle",onselect:function(s,t){d.execCommand("customstyle",this.items[t].value)},onbuttonclick:function(){this.showPopup()},
indexByValue:function(s){for(var t=0,u;u=this.items[t++];)if(u.label==s)return t-1;return-1}});g.buttons.customstyle=r;d.addListener("selectionchange",function(s,t,u){if(!u)if(d.queryCommandState("customstyle")==-1)r.setDisabled(true);else{r.setDisabled(false);s=d.queryCommandValue("customstyle");r.indexByValue(s)!=-1?r.setValue(s):r.setValue(r.initValue)}});return r}};g.inserttable=function(d,m,h){h=d.options.labelMap.inserttable||d.getLang("labelMap.inserttable")||"";var n=new g.TableButton({editor:d,
title:h,className:"edui-for-inserttable",onpicktable:function(q,o,p){d.execCommand("InsertTable",{numRows:p,numCols:o,border:1})},onbuttonclick:function(){this.showPopup()}});g.buttons.inserttable=n;d.addListener("selectionchange",function(){n.setDisabled(d.queryCommandState("inserttable")==-1)});return n};g.lineheight=function(d){var m=d.options.lineheight||[];if(m.length){for(var h=0,n,q=[];n=m[h++];)q.push({label:n,value:n,theme:d.options.theme,onclick:function(){d.execCommand("lineheight",this.value)}});
var o=new g.MenuButton({editor:d,className:"edui-for-lineheight",title:d.options.labelMap.lineheight||d.getLang("labelMap.lineheight")||"",items:q,onbuttonclick:function(){var p=d.queryCommandValue("LineHeight")||this.value;d.execCommand("LineHeight",p)}});g.buttons.lineheight=o;d.addListener("selectionchange",function(){var p=d.queryCommandState("LineHeight");if(p==-1)o.setDisabled(true);else{o.setDisabled(false);var r=d.queryCommandValue("LineHeight");r&&o.setValue((r+"").replace(/cm/,""));o.setChecked(p)}});
return o}};f=["top","bottom"];for(a=0;e=f[a++];)(function(d){g["rowspacing"+d]=function(m){var h=m.options["rowspacing"+d]||[];if(!h.length)return null;for(var n=0,q,o=[];q=h[n++];)o.push({label:q,value:q,theme:m.options.theme,onclick:function(){m.execCommand("rowspacing",this.value,d)}});var p=new g.MenuButton({editor:m,className:"edui-for-rowspacing"+d,title:m.options.labelMap["rowspacing"+d]||m.getLang("labelMap.rowspacing"+d)||"",items:o,onbuttonclick:function(){var r=m.queryCommandValue("rowspacing",
d)||this.value;m.execCommand("rowspacing",r,d)}});g.buttons[d]=p;m.addListener("selectionchange",function(){var r=m.queryCommandState("rowspacing",d);if(r==-1)p.setDisabled(true);else{p.setDisabled(false);var s=m.queryCommandValue("rowspacing",d);s&&p.setValue((s+"").replace(/%/,""));p.setChecked(r)}});return p}})(e);f=["insertorderedlist","insertunorderedlist"];for(a=0;e=f[a++];)(function(d){g[d]=function(m){var h=m.options[d],n=function(){m.execCommand(d,this.value)},q=[];for(var o in h)q.push({label:h[o]||
m.getLang()[d][o]||"",value:o,theme:m.options.theme,onclick:n});var p=new g.MenuButton({editor:m,className:"edui-for-"+d,title:m.getLang("labelMap."+d)||"",items:q,onbuttonclick:function(){var r=m.queryCommandValue(d)||this.value;m.execCommand(d,r)}});g.buttons[d]=p;m.addListener("selectionchange",function(){var r=m.queryCommandState(d);if(r==-1)p.setDisabled(true);else{p.setDisabled(false);var s=m.queryCommandValue(d);p.setValue(s);p.setChecked(r)}});return p}})(e);g.fullscreen=function(d,m){m=d.options.labelMap.fullscreen||
d.getLang("labelMap.fullscreen")||"";var h=new g.Button({className:"edui-for-fullscreen",title:m,theme:d.options.theme,onclick:function(){d.ui&&d.ui.setFullScreen(!d.ui.isFullScreen());this.setChecked(d.ui.isFullScreen())}});g.buttons.fullscreen=h;d.addListener("selectionchange",function(){var n=d.queryCommandState("fullscreen");h.setDisabled(n==-1);h.setChecked(d.ui.isFullScreen())});return h};g.emotion=function(d,m){var h=new g.MultiMenuPop({title:d.options.labelMap.emotion||d.getLang("labelMap.emotion")||
"",editor:d,className:"edui-for-emotion",iframeUrl:d.ui.mapUrl(m||(d.options.iframeUrlMap||{}).emotion||b.emotion)});g.buttons.emotion=h;d.addListener("selectionchange",function(){h.setDisabled(d.queryCommandState("emotion")==-1)});return h};g.autotypeset=function(d){var m=new g.AutoTypeSetButton({editor:d,title:d.options.labelMap.autotypeset||d.getLang("labelMap.autotypeset")||"",className:"edui-for-autotypeset",onbuttonclick:function(){d.execCommand("autotypeset")}});g.buttons.autotypeset=m;d.addListener("selectionchange",
function(){m.setDisabled(d.queryCommandState("autotypeset")==-1)});return m};g.simpleupload=function(d){var m=new g.Button({className:"edui-for-simpleupload",title:d.options.labelMap.simpleupload||d.getLang("labelMap.simpleupload")||"",onclick:function(){},theme:d.options.theme,showText:false});g.buttons.simpleupload=m;d.addListener("ready",function(){var h=m.getDom("body").children[0];d.fireEvent("simpleuploadbtnready",h)});d.addListener("selectionchange",function(h,n,q){h=d.queryCommandState("simpleupload");
if(h==-1){m.setDisabled(true);m.setChecked(false)}else if(!q){m.setDisabled(false);m.setChecked(h)}});return m}})();(function(){function j(f){this.initOptions(f);this.initEditorUI()}var g=B.editor.utils,c=B.editor.ui.uiUtils,b=B.editor.ui.UIBase,a=B.editor.dom.domUtils,e=[];j.prototype={uiName:"editor",initEditorUI:function(){function f(p,r){p.setOpt({wordCount:true,maximumWords:1E4,wordCountMsg:p.options.wordCountMsg||p.getLang("wordCountMsg"),wordOverFlowMsg:p.options.wordOverFlowMsg||p.getLang("wordOverFlowMsg")});
var s=p.options,t=s.maximumWords,u=s.wordCountMsg,w=s.wordOverFlowMsg;r=r.getDom("wordcount");if(s.wordCount){s=p.getContentLength(true);if(s>t){r.innerHTML=w;p.fireEvent("wordcountoverflow")}else r.innerHTML=u.replace("{#leave}",t-s).replace("{#count}",s)}}this.editor.ui=this;this._dialogs={};this.initUIBase();this._initToolbars();var d=this.editor,m=this;d.addListener("ready",function(){d.getDialog=function(r){return d.ui._dialogs[r+"Dialog"]};a.on(d.window,"scroll",function(r){B.editor.ui.Popup.postHide(r)});
d.ui._actualFrameWidth=d.options.initialFrameWidth;UE.browser.ie&&UE.browser.version===6&&d.container.ownerDocument.execCommand("BackgroundImageCache",false,true);if(d.options.elementPathEnabled)d.ui.getDom("elementpath").innerHTML='<div class="edui-editor-breadcrumb">'+d.getLang("elementPathTip")+":</div>";if(d.options.wordCount){function p(){f(d,m);a.un(d.document,"click",arguments.callee)}a.on(d.document,"click",p);d.ui.getDom("wordcount").innerHTML=d.getLang("wordCountTip")}d.ui._scale();if(d.options.scaleEnabled){d.autoHeightEnabled&&
d.disableAutoHeight();m.enableScale()}else m.disableScale();if(!d.options.elementPathEnabled&&!d.options.wordCount&&!d.options.scaleEnabled){d.ui.getDom("elementpath").style.display="none";d.ui.getDom("wordcount").style.display="none";d.ui.getDom("scale").style.display="none"}d.selection.isFocus()&&d.fireEvent("selectionchange",false,true)});d.addListener("mousedown",function(p,r){B.editor.ui.Popup.postHide(r,r.target||r.srcElement);B.editor.ui.ShortCutMenu.postHide(r)});d.addListener("delcells",
function(){UE.ui.edittip&&new UE.ui.edittip(d);d.getDialog("edittip").open()});var h,n=false,q;d.addListener("afterpaste",function(){if(!d.queryCommandState("pasteplain")){if(B.editor.ui.PastePicker){h=new B.editor.ui.Popup({content:new B.editor.ui.PastePicker({editor:d}),editor:d,className:"edui-wordpastepop"});h.render()}n=true}});d.addListener("afterinserthtml",function(){clearTimeout(q);q=setTimeout(function(){if(h&&(n||d.ui._isTransfer)){if(h.isHidden()){var p=a.createElement(d.document,"span",
{style:"line-height:0px;",innerHTML:"\ufeff"});d.selection.getRange().insertNode(p);var r=ta(p,"firstChild","previousSibling");r&&h.showAnchor(r.nodeType==3?r.parentNode:r);a.remove(p)}else h.show();delete d.ui._isTransfer;n=false}},200)});d.addListener("contextmenu",function(p,r){B.editor.ui.Popup.postHide(r)});d.addListener("keydown",function(p,r){h&&h.dispose(r);p=r.keyCode||r.which;r.altKey&&p==90&&UE.ui.buttons.fullscreen.onclick()});d.addListener("wordcount",function(){f(this,m)});d.addListener("selectionchange",
function(){if(d.options.elementPathEnabled)m[(d.queryCommandState("elementpath")==-1?"dis":"en")+"ableElementPath"]();if(d.options.scaleEnabled)m[(d.queryCommandState("scale")==-1?"dis":"en")+"ableScale"]()});var o=new B.editor.ui.Popup({editor:d,content:"",className:"edui-bubble",_onEditButtonClick:function(){this.hide();d.ui._dialogs.linkDialog.open()},_onImgEditButtonClick:function(p){this.hide();d.ui._dialogs[p]&&d.ui._dialogs[p].open()},_onImgSetFloat:function(p){this.hide();d.execCommand("imagefloat",
p)},_setIframeAlign:function(p){var r=o.anchorEl,s=r.cloneNode(true);switch(p){case -2:s.setAttribute("align","");break;case -1:s.setAttribute("align","left");break;case 1:s.setAttribute("align","right");break}r.parentNode.insertBefore(s,r);a.remove(r);o.anchorEl=s;o.showAnchor(o.anchorEl)},_updateIframe:function(){var p=d._iframe=o.anchorEl;if(a.hasClass(p,"ueditor_baidumap")){d.selection.getRange().selectNode(p).select();d.ui._dialogs.mapDialog.open()}else d.ui._dialogs.insertframeDialog.open();
o.hide()},_onRemoveButtonClick:function(p){d.execCommand(p);this.hide()},queryAutoHide:function(p){if(p&&p.ownerDocument==d.document)if(p.tagName.toLowerCase()=="img"||a.findParentByTagName(p,"a",true))return p!==o.anchorEl;return B.editor.ui.Popup.prototype.queryAutoHide.call(this,p)}});o.render();if(d.options.imagePopup){d.addListener("mouseover",function(p,r){r=r||window.event;p=r.target||r.srcElement;if(d.ui._dialogs.insertframeDialog&&/iframe/ig.test(p.tagName))if(r=o.formatHtml("<nobr>"+d.getLang("property")+
': <span onclick=$$._setIframeAlign(-2) class="edui-clickable">'+d.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(-1) class="edui-clickable">'+d.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._setIframeAlign(1) class="edui-clickable">'+d.getLang("justifyright")+'</span>&nbsp;&nbsp; <span onclick="$$._updateIframe( this);" class="edui-clickable">'+d.getLang("modify")+"</span></nobr>")){o.getDom("content").innerHTML=r;o.anchorEl=p;o.showAnchor(o.anchorEl)}else o.hide()});
d.addListener("selectionchange",function(p,r){if(r){var s=p="";r=d.selection.getRange().getClosedNode();s=d.ui._dialogs;if(r&&r.tagName=="IMG"){var t="insertimageDialog";if(r.className.indexOf("edui-faked-video")!=-1||r.className.indexOf("edui-upload-video")!=-1)t="insertvideoDialog";if(r.className.indexOf("edui-faked-webapp")!=-1)t="webappDialog";if(r.src.indexOf("http://api.map.baidu.com")!=-1)t="mapDialog";if(r.className.indexOf("edui-faked-music")!=-1)t="musicDialog";if(r.src.indexOf("http://maps.google.com/maps/api/staticmap")!=
-1)t="gmapDialog";if(r.getAttribute("anchorname")){t="anchorDialog";p=o.formatHtml("<nobr>"+d.getLang("property")+': <span onclick=$$._onImgEditButtonClick("anchorDialog") class="edui-clickable">'+d.getLang("modify")+"</span>&nbsp;&nbsp;<span onclick=$$._onRemoveButtonClick('anchor') class=\"edui-clickable\">"+d.getLang("delete")+"</span></nobr>")}if(r.getAttribute("word_img")){d.word_img=[r.getAttribute("word_img")];t="wordimageDialog"}if(a.hasClass(r,"loadingclass")||a.hasClass(r,"loaderrorclass"))t=
"";if(!s[t])return;s="<nobr>"+d.getLang("property")+': <span onclick=$$._onImgSetFloat("none") class="edui-clickable">'+d.getLang("default")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("left") class="edui-clickable">'+d.getLang("justifyleft")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("right") class="edui-clickable">'+d.getLang("justifyright")+'</span>&nbsp;&nbsp;<span onclick=$$._onImgSetFloat("center") class="edui-clickable">'+d.getLang("justifycenter")+"</span>&nbsp;&nbsp;<span onclick=\"$$._onImgEditButtonClick('"+
t+'\');" class="edui-clickable">'+d.getLang("modify")+"</span></nobr>";!p&&(p=o.formatHtml(s))}if(d.ui._dialogs.linkDialog){var u=d.queryCommandValue("link"),w;if(u&&(w=u.getAttribute("_href")||u.getAttribute("href",2))){s=w;if(w.length>30)s=w.substring(0,20)+"...";if(p)p+='<div style="height:5px;"></div>';p+=o.formatHtml("<nobr>"+d.getLang("anthorMsg")+': <a target="_blank" href="'+w+'" title="'+w+'" >'+s+'</a> <span class="edui-clickable" onclick="$$._onEditButtonClick();">'+d.getLang("modify")+
'</span> <span class="edui-clickable" onclick="$$._onRemoveButtonClick(\'unlink\');"> '+d.getLang("clear")+"</span></nobr>");o.showAnchor(u)}}if(p){o.getDom("content").innerHTML=p;o.anchorEl=r||u;o.showAnchor(o.anchorEl)}else o.hide()}})}},_initToolbars:function(){for(var f=this.editor,d=this.toolbars||[],m=[],h=0;h<d.length;h++){for(var n=d[h],q=new B.editor.ui.Toolbar({theme:f.options.theme}),o=0;o<n.length;o++){var p=n[o],r=null;if(typeof p=="string"){p=p.toLowerCase();if(p=="|")p="Separator";
if(p=="||")p="Breakline";if(B.editor.ui[p])r=new B.editor.ui[p](f);if(p=="fullscreen"){if(m&&m[0])m[0].items.splice(0,0,r);else r&&q.items.splice(0,0,r);continue}}else r=p;r&&r.id&&q.add(r)}m[h]=q}g.each(UE._customizeUI,function(s,t){if(s.id&&s.id!=f.key)return false;if(t=s.execFn.call(f,f,t)){s=s.index;if(s===undefined)s=q.items.length;q.add(t,s)}});this.toolbars=m},getHtmlTpl:function(){return'<div id="##" class="%%"><div id="##_toolbarbox" class="%%-toolbarbox">'+(this.toolbars.length?'<div id="##_toolbarboxouter" class="%%-toolbarboxouter"><div class="%%-toolbarboxinner">'+
this.renderToolbarBoxHtml()+"</div></div>":"")+'<div id="##_toolbarmsg" class="%%-toolbarmsg" style="display:none;"><div id = "##_upload_dialog" class="%%-toolbarmsg-upload" onclick="$$.showWordImageDialog();">'+this.editor.getLang("clickToUpload")+'</div><div class="%%-toolbarmsg-close" onclick="$$.hideToolbarMsg();">x</div><div id="##_toolbarmsg_label" class="%%-toolbarmsg-label"></div><div style="height:0;overflow:hidden;clear:both;"></div></div><div id="##_message_holder" class="%%-messageholder"></div></div><div id="##_iframeholder" class="%%-iframeholder"></div><div id="##_bottombar" class="%%-bottomContainer"><table><tr><td id="##_elementpath" class="%%-bottombar"></td><td id="##_wordcount" class="%%-wordcount"></td><td id="##_scale" class="%%-scale"><div class="%%-icon"></div></td></tr></table></div><div id="##_scalelayer"></div></div>'},
showWordImageDialog:function(){this._dialogs.wordimageDialog.open()},renderToolbarBoxHtml:function(){for(var f=[],d=0;d<this.toolbars.length;d++)f.push(this.toolbars[d].renderHtml());return f.join("")},setFullScreen:function(f){var d=this.editor,m=d.container.parentNode.parentNode;if(this._fullscreen!=f){this._fullscreen=f;this.editor.fireEvent("beforefullscreenchange",f);if(B.editor.browser.gecko)var h=d.selection.getRange().createBookmark();if(f){for(;m.tagName!="BODY";){var n=B.editor.dom.domUtils.getComputedStyle(m,
"position");e.push(n);m.style.position="static";m=m.parentNode}this._bakHtmlOverflow=document.documentElement.style.overflow;this._bakBodyOverflow=document.body.style.overflow;this._bakAutoHeight=this.editor.autoHeightEnabled;this._bakScrollTop=Math.max(document.documentElement.scrollTop,document.body.scrollTop);this._bakEditorContaninerWidth=d.iframe.parentNode.offsetWidth;if(this._bakAutoHeight){d.autoHeightEnabled=false;this.editor.disableAutoHeight()}document.documentElement.style.overflow="hidden";
window.scrollTo(0,window.scrollY);this._bakCssText=this.getDom().style.cssText;this._bakCssText1=this.getDom("iframeholder").style.cssText;d.iframe.parentNode.style.width="";this._updateFullScreen()}else{for(;m.tagName!="BODY";){m.style.position=e.shift();m=m.parentNode}this.getDom().style.cssText=this._bakCssText;this.getDom("iframeholder").style.cssText=this._bakCssText1;if(this._bakAutoHeight){d.autoHeightEnabled=true;this.editor.enableAutoHeight()}document.documentElement.style.overflow=this._bakHtmlOverflow;
document.body.style.overflow=this._bakBodyOverflow;d.iframe.parentNode.style.width=this._bakEditorContaninerWidth+"px";window.scrollTo(0,this._bakScrollTop)}if(y.gecko&&d.body.contentEditable==="true"){var q=document.createElement("input");document.body.appendChild(q);d.body.contentEditable=false;setTimeout(function(){q.focus();setTimeout(function(){d.body.contentEditable=true;d.fireEvent("fullscreenchanged",f);d.selection.getRange().moveToBookmark(h).select(true);B.editor.dom.domUtils.remove(q);
f&&window.scroll(0,0)},0)},0)}if(d.body.contentEditable==="true"){this.editor.fireEvent("fullscreenchanged",f);this.triggerLayout()}}},_updateFullScreen:function(){if(this._fullscreen){var f=c.getViewportRect();this.getDom().style.cssText="border:0;position:absolute;left:0;top:"+(this.editor.options.topOffset||0)+"px;width:"+f.width+"px;height:"+f.height+"px;z-index:"+(this.getDom().style.zIndex*1+100);c.setViewportOffset(this.getDom(),{left:0,top:this.editor.options.topOffset||0});this.editor.setHeight(f.height-
this.getDom("toolbarbox").offsetHeight-this.getDom("bottombar").offsetHeight-(this.editor.options.topOffset||0),true);if(y.gecko)try{window.onresize()}catch(d){}}},_updateElementPath:function(){var f=this.getDom("elementpath"),d;if(this.elementPathEnabled&&(d=this.editor.queryCommandValue("elementpath"))){for(var m=[],h=0,n;n=d[h];h++)m[h]=this.formatHtml('<span unselectable="on" onclick="$$.editor.execCommand(&quot;elementpath&quot;, &quot;'+h+'&quot;);">'+n+"</span>");f.innerHTML='<div class="edui-editor-breadcrumb" onmousedown="return false;">'+
this.editor.getLang("elementPathTip")+": "+m.join(" &gt; ")+"</div>"}else f.style.display="none"},disableElementPath:function(){var f=this.getDom("elementpath");f.innerHTML="";f.style.display="none";this.elementPathEnabled=false},enableElementPath:function(){this.getDom("elementpath").style.display="";this.elementPathEnabled=true;this._updateElementPath()},_scale:function(){function f(){D=a.getXY(o);z||(z=q.options.minFrameHeight+r.offsetHeight+s.offsetHeight);u.style.cssText="position:absolute;left:0;display:;top:0;background-color:#41ABFF;opacity:0.4;filter: Alpha(opacity=40);width:"+
o.offsetWidth+"px;height:"+o.offsetHeight+"px;z-index:"+(q.options.zIndex+1);a.on(n,"mousemove",d);a.on(p,"mouseup",m);a.on(n,"mouseup",m)}function d(R){h();R=R||window.event;I=R.pageX||n.documentElement.scrollLeft+R.clientX;S=R.pageY||n.documentElement.scrollTop+R.clientY;L=I-D.x;X=S-D.y;if(L>=F){w=true;u.style.width=L+"px"}if(X>=z){w=true;u.style.height=X+"px"}}function m(){if(w){w=false;q.ui._actualFrameWidth=u.offsetWidth-2;o.style.width=q.ui._actualFrameWidth+"px";q.setHeight(u.offsetHeight-
s.offsetHeight-r.offsetHeight-2,true)}if(u)u.style.display="none";h();a.un(n,"mousemove",d);a.un(p,"mouseup",m);a.un(n,"mouseup",m)}function h(){y.ie?n.selection.clear():window.getSelection().removeAllRanges()}var n=document,q=this.editor,o=q.container,p=q.document,r=this.getDom("toolbarbox"),s=this.getDom("bottombar"),t=this.getDom("scale"),u=this.getDom("scalelayer"),w=false,D=null,z=0,F=q.options.minFrameWidth,I=0,S=0,L=0,X=0,T=this;this.editor.addListener("fullscreenchanged",function(R,ga){if(ga)T.disableScale();
else if(T.editor.options.scaleEnabled){T.enableScale();R=T.editor.document.createElement("span");T.editor.body.appendChild(R);T.editor.body.style.height=Math.max(a.getXY(R).y,T.editor.iframe.offsetHeight-20)+"px";a.remove(R)}});this.enableScale=function(){if(q.queryCommandState("source")!=1){t.style.display="";this.scaleEnabled=true;a.on(t,"mousedown",f)}};this.disableScale=function(){t.style.display="none";this.scaleEnabled=false;a.un(t,"mousedown",f)}},isFullScreen:function(){return this._fullscreen},
postRender:function(){b.prototype.postRender.call(this);for(var f=0;f<this.toolbars.length;f++)this.toolbars[f].postRender();var d=this,m,h=B.editor.dom.domUtils,n=function(){clearTimeout(m);m=setTimeout(function(){d._updateFullScreen()})};h.on(window,"resize",n);d.addListener("destroy",function(){h.un(window,"resize",n);clearTimeout(m)})},showToolbarMsg:function(f,d){this.getDom("toolbarmsg_label").innerHTML=f;this.getDom("toolbarmsg").style.display="";if(!d)this.getDom("upload_dialog").style.display=
"none"},hideToolbarMsg:function(){this.getDom("toolbarmsg").style.display="none"},mapUrl:function(f){return f?f.replace("~/",this.editor.options.UEDITOR_HOME_URL||""):""},triggerLayout:function(){var f=this.getDom();f.style.zoom=f.style.zoom=="1"?"100%":"1"}};g.inherits(j,B.editor.ui.UIBase);var k={};UE.ui.Editor=function(f){var d=new UE.Editor(f);d.options.editor=d;g.loadFile(document,{href:d.options.themePath+d.options.theme+"/css/ueditor.css",tag:"link",type:"text/css",rel:"stylesheet"});var m=
d.render;d.render=function(h){if(h.constructor===String){d.key=h;k[h]=d}g.domReady(function(){function n(){d.setOpt({labelMap:d.options.labelMap||d.getLang("labelMap")});new j(d.options);if(h){if(h.constructor===String)h=document.getElementById(h);h&&h.getAttribute("name")&&(d.options.textarea=h.getAttribute("name"));if(h&&/script|textarea/ig.test(h.tagName)){var q=document.createElement("div");h.parentNode.insertBefore(q,h);var o=h.value||h.innerHTML;d.options.initialContent=/^[\t\r\n ]*$/.test(o)?
d.options.initialContent:o.replace(/>[\n\r\t]+([ ]{4})+/g,">").replace(/[\n\r\t]+([ ]{4})+</g,"<").replace(/>[\n\r\t]+</g,"><");h.className&&(q.className=h.className);h.style.cssText&&(q.style.cssText=h.style.cssText);if(/textarea/i.test(h.tagName)){d.textarea=h;d.textarea.style.display="none"}else h.parentNode.removeChild(h);if(h.id){q.id=h.id;a.removeAttributes(h,"id")}h=q;h.innerHTML=""}}a.addClass(h,"edui-"+d.options.theme);d.ui.render(h);q=d.options;d.container=d.ui.getDom();o=a.findParents(h,
true);for(var p=[],r=0,s;s=o[r];r++){p[r]=s.style.display;s.style.display="block"}if(q.initialFrameWidth)q.minFrameWidth=q.initialFrameWidth;else{q.minFrameWidth=q.initialFrameWidth=h.offsetWidth;r=h.style.width;if(/%$/.test(r))q.initialFrameWidth=r}if(q.initialFrameHeight)q.minFrameHeight=q.initialFrameHeight;else q.initialFrameHeight=q.minFrameHeight=h.offsetHeight;for(r=0;s=o[r];r++)s.style.display=p[r];if(h.style.height)h.style.height="";d.container.style.width=q.initialFrameWidth+(/%$/.test(q.initialFrameWidth)?
"":"px");d.container.style.zIndex=q.zIndex;m.call(d,d.ui.getDom("iframeholder"));d.fireEvent("afteruiready")}d.langIsReady?n():d.addListener("langReady",n)})};return d};UE.getEditor=function(f,d){var m=k[f];if(!m){m=k[f]=new UE.ui.Editor(d);m.render(f)}return m};UE.delEditor=function(f){var d;if(d=k[f]){d.key&&d.destroy();delete k[f]}};UE.registerUI=function(f,d,m,h){g.each(f.split(/\s+/),function(n){UE._customizeUI[n]={id:h,execFn:d,index:m}})}})();UE.registerUI("message",function(j){function g(){var k=
e.ui.getDom("toolbarbox");if(k)b.style.top=k.offsetHeight+3+"px";b.style.zIndex=Math.max(e.options.zIndex,e.iframe.style.zIndex)+1}var c=B.editor.ui.Message,b,a=[],e=j;e.addListener("ready",function(){b=document.getElementById(e.ui.id+"_message_holder");g();setTimeout(function(){g()},500)});e.addListener("showmessage",function(k,f){f=v.isString(f)?{content:f}:f;k=new c({timeout:f.timeout,type:f.type,content:f.content,keepshow:f.keepshow,editor:e});var d=f.id||"msg_"+(+new Date).toString(36);k.render(b);
a[d]=k;k.reset(f);g();return d});e.addListener("updatemessage",function(k,f,d){d=v.isString(d)?{content:d}:d;k=a[f];k.render(b);k&&k.reset(d)});e.addListener("hidemessage",function(k,f){(k=a[f])&&k.hide()})});UE.registerUI("autosave",function(j){var g=null,c=null;j.on("afterautosave",function(){clearTimeout(g);g=setTimeout(function(){c&&j.trigger("hidemessage",c);c=j.trigger("showmessage",{content:j.getLang("autosave.success"),timeout:2E3})},2E3)})})})();
